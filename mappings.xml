<?xml version="1.0" encoding="iso-8859-1"?>
<xml>
  <app prefix="gen" version="0.0.1.1" debug="true" companycolor="#094c9b,#05264e" resolution-width="768" resolution-height="1024" screen-orientation="landscape" entry-point="MenuPrincipal">
    <style url="default.css" />
    <style url="defaultIOS.css" conditions="ios" />
  </app>
  <collprops type="general">
    <coll name="AdjuntosAgenda_Basic" title="AdjuntosAgenda_Basic" sql="SELECT t1.ID,t1.PATH     FROM ##PREF##AdjuntosAgenda t1" objname="AdjuntosAgenda" updateobj="AdjuntosAgenda" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDAGENDA" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDUSUARIO" visible="0" type="N" size="8" />
      <prop group="1" name="FECHA" visible="0" type="D" size="8" />
      <prop group="1" name="PATH" visible="0" type="T" size="50" />
      <prop group="1" name="TYPE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="AdjuntosAgenda_Contents" title="AdjuntosAgenda_Contents" sql="SELECT t1.*,t1.PATH    FROM ##PREF##AdjuntosAgenda t1" check-owner="false" dependent="false" objname="AdjuntosAgenda" updateobj="AdjuntosAgenda" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="ID_ERP" type="N" visible="0" />
      <prop group="1" name="IDAGENDA" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDUSUARIO" visible="0" type="N" size="8" />
      <prop group="1" name="FECHA" visible="0" type="D" size="8" />
      <prop group="1" name="PATH" visible="7" type="T" size="50" width="100%" labelwidth="0" fieldsize="20" title="Adjunto" />
      <prop group="1" name="TYPE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <create>
        <action name="setval" field="FECHA" value="##NOW_TIME##" />
        <action name="setval" field="IDUSUARIO" value="##USERID##" />
        <action name="setval" field="IDEMPRESA" value="##ENTID##" />
        <action name="setval" field="TYPE" value="1" />
      </create>
      <selecteditem>
        <action name="runscript">
          <script language="VBScript"> 	
      	if this("ID_ERP")=0 then
      	   
     		ui.OpenFile this("PATH")
        else
            ui.OpenFile "http://212.170.61.117:8080/replicaimages/"+this("PATH")
        end if
	   </script>
        </action>
      </selecteditem>
    </coll>
    <coll name="Agenda_Basic" title="Agenda_Basic" sql="SELECT t1.ID     FROM ##PREF##Agenda t1" objname="Agenda" updateobj="Agenda" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="ID_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDUSUARIOORI" visible="0" type="N" size="8" />
      <prop group="1" name="IDUSUARIODES" visible="0" type="N" size="8" />
      <prop group="1" name="IDUSUARIO" visible="0" type="N" size="8" />
      <prop group="1" name="IDCLIENTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDCOMPETENCIA" visible="0" type="N" size="8" />
      <prop group="1" name="IDTIPOMENSAJEAGENDA" visible="0" type="N" size="8" />
      <prop group="1" name="FECHA_CREACION" visible="0" type="D" size="8" />
      <prop group="1" name="FECHA_VISITA" visible="0" type="D" size="8" />
      <prop group="1" name="TIEMPO_VISITA" visible="0" type="D" size="8" />
      <prop group="1" name="XLATITUD" visible="0" type="T" size="15" />
      <prop group="1" name="XLONGITUD" visible="0" type="T" size="15" />
      <prop group="1" name="OBSERVACIONES" visible="0" type="T" size="400" />
      <prop group="1" name="QL_NOMFIC" visible="0" type="T" size="15" />
      <prop group="1" name="COMPETENCIA_SN" visible="0" type="N" size="8" />
      <prop group="1" name="NOMBRE_VISITA" visible="0" type="D" size="40" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="Agenda_Contents" title="Agenda_Contents" sql="SELECT t1.*,CASE WHEN t2.ID&gt;0 then t2.NOMBRE else t1.NOMBRE_VISITA end  AS MAP_CLIENTE,t3.DESCRIP AS MAP_TIPOMENSAJEAGENDA,      CASE WHEN t1.FECHA_FIN is null then '#88bf1b' else '#f19e14' end AS MAP_COLORVIEW FROM ##PREF##Agenda t1      left outer join ##PREF##Clientes t2 ON t1.IDCLIENTE=t2.ID      left outer join ##PREF##TiposMensajeAgenda t3 ON t1.IDTIPOMENSAJEAGENDA=t3.ID" check-owner="false" dependent="false" objname="Agenda" updateobj="Agenda" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="FECHA_VISITA" visible="7" type="DT" class="prop2" align="center" size="8" width="30%" labelwidth="0" bgcolor="#88bf1b" text-bgcolor="#88bf1b" locked="true" />
      <prop group="1" name="FECHA_FIN" visible="7" type="DT" class="prop2" align="center" newline="false" size="8" width="30%" labelwidth="0" bgcolor="##FLD_MAP_COLORVIEW##'" text-bgcolor="##FLD_MAP_COLORVIEW##" locked="true" />
      <prop group="1" name="MAP_TIPOMENSAJEAGENDA" visible="7" type="T" class="prop2" size="8" width="40%" labelwidth="0" bgcolor="##FLD_MAP_COLORVIEW##'" text-bgcolor="##FLD_MAP_COLORVIEW##" locked="true" newline="false" />
      <prop group="1" name="MAP_CLIENTE" visible="0" type="D" class="prop2" size="8" width="100%" labelwidth="0" />
      <prop group="1" name="OBSERVACIONES" visible="7" type="T" class="prop2" size="8" width="100%" labelwidth="0" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="MAP_COLORVIEW" type="T" visible="0" />
      <prop group="1" name="ID_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDUSUARIOORI" visible="0" type="N" size="8" />
      <prop group="1" name="IDUSUARIODES" visible="0" type="N" size="8" />
      <prop group="1" name="IDUSUARIO" visible="0" type="N" size="8" />
      <prop group="1" name="IDCLIENTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDCOMPETENCIA" visible="0" type="N" size="8" />
      <prop group="1" name="IDTIPOMENSAJEAGENDA" visible="0" type="N" size="8" />
      <prop group="1" name="FECHA_CREACION" visible="0" type="D" size="8" />
      <prop group="1" name="TIEMPO_VISITA" visible="0" type="D" size="8" />
      <prop group="1" name="XLATITUD" visible="0" type="T" size="15" />
      <prop group="1" name="XLONGITUD" visible="0" type="T" size="15" />
      <prop group="1" name="NOMBRE_VISITA" visible="0" type="T" size="400" />
      <prop group="1" name="COMPETENCIA_SN" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <selecteditem>
        <action name="runscript">
          <script language="VBScript">       
	        LB_ShowForm "Agenda_Editar",this("ID")
	   </script>
        </action>
      </selecteditem>
    </coll>
    <coll name="Agenda_Editar" title="Agenda_Editar" sql="SELECT t1.*,t2.NOMBRE AS MAP_CLIENTE,t3.DESCRIP AS MAP_TIPOMENSAJE,t4.NOMBRE AS MAP_COMPETENCIA FROM ##PREF##Agenda t1         left outer join ##PREF##Clientes t2 ON t1.IDCLIENTE=t2.ID       left outer join ##PREF##TiposMensajeAgenda t3 ON t1.IDTIPOMENSAJEAGENDA=t3.ID left outer join ##PREF##Competencia t4 ON t4.ID=t1.IDCOMPETENCIA" objname="Agenda" updateobj="Agenda" progid="ASData.CASBasicDataObj" filter="" sort="">
      <!-- ##### GRUPO 1 DATOS AGENDA ##### -->
      <group name="general" id="1" />
      <!-- ## Frame Cabecera Agenda ## -->
      <frame name="frm_cabecera" width="100%" height="7%" scroll="false" orientation="left" bgcolor="#094c9b,#05264e" />
      <prop group="1" frame="frm_cabecera" name="MAP_ICON1" visible="1" type="B" width="5%" labelwidth="0" icon="icon.png" method="Executenode(menu0)" locked="true" />
      <prop group="1" frame="frm_cabecera" name="MAP_CABECERA" visible="1" type="TL" class="labelcab" title="##FLD_MAP_LABELCABECERA##" />
      <prop group="1" frame="frm_cabecera" name="MAP_LABELCABECERA" type="T" visible="0" />
      <!-- ## Frame datos Agenda ## -->
      <frame name="frm_datos_visita" width="100%" height="40%" scroll="false" />
      <prop group="1" frame="frm_datos_visita" name="FECHA_VISITA" visible="1" type="D" size="8" width="25%" title="Ini. Visita" labelwidth="6" tmargin="4" disableedit="MAP_CERRADO=1" />
      <prop group="1" frame="frm_datos_visita" name="MAP_HORAVISITA" visible="1" type="TT" mask="Hh#:#Mm" newline="false" size="8" width="20%" title="" labelwidth="0" tmargin="4" disableedit="MAP_CERRADO=1" />
      <prop group="1" frame="frm_datos_visita" name="MAP_CLIENTE" visible="1" type="T" newline="false" locked="true" linkedto="IDCLIENTE" linkedfield="NOMBRE" size="40" width="40%" title="Cliente" labelwidth="8" tmargin="4" lmargin="2" disableedit="MAP_CERRADO=1" />
      <prop group="1" frame="frm_datos_visita" name="MAP_BTCLIENTE" visible="1" type="B" newline="false" class="boton2" icon="bt-find-black.png" onchange="refresh" method="Executenode(buscarcliente)" title="" tmargin="3" lmargin="1" disableedit="MAP_CERRADO=1" />
      <prop group="1" frame="frm_datos_visita" name="MAP_VERMAPA" visible="1" type="B" class="boton2" lmargin="1" tmargin="3" title="" img="bt-gps-black.png" labelwidth="0" method="Executenode(mapa)" fieldsize="0" onchange="refresh" newline="false" />
      <prop group="1" frame="frm_datos_visita" name="MAP_MAPA" title=" " newline="false" type="Z" visible="0" class="boton2" viewmode="mapview" contents="MAPA" text-border="false" border="false" tmargin="3" bgcolor="#00000000" mask="2" img="bt-gps-black.png" imgsel="bt-gps-black.png" />
      <contents name="MAPA" src="Datos_Mapa" filter="t1.ID=##FLD_IDCLIENTE##" />
      <prop group="1" frame="frm_datos_visita" name="FECHA_FIN" visible="1" locked="true" type="D" size="8" width="25%" title="Fin Visita" labelwidth="6" tmargin="2" disableedit="MAP_CERRADO=1" />
      <prop group="1" frame="frm_datos_visita" name="MAP_HORAFIN" visible="1" locked="true" type="TT" mask="Hh#:#Mm" newline="false" size="8" width="20%" title="" labelwidth="0" tmargin="2" disableedit="MAP_CERRADO=1" />
      <prop group="1" frame="frm_datos_visita" name="MAP_TIPOMENSAJE" visible="1" type="T" newline="false" linkedto="IDTIPOMENSAJEAGENDA" linkedfield="DESCRIP" size="40" width="45%" title="Tipo" labelwidth="8" tmargin="2" lmargin="2" disableedit="MAP_CERRADO=1" />
      <prop group="1" frame="frm_datos_visita" name="NOMBRE_VISITA" visible="1" type="T" size="8" width="45%" title="Nuevo Cli." labelwidth="6" tmargin="2" disableedit="MAP_CERRADO=1" />
      <prop group="1" frame="frm_datos_visita" name="OBSERVACIONES" visible="1" type="T" size="400" width="45%" title="Observ" labelwidth="6" lines="4" fixed-lines="true" tmargin="2" disableedit="MAP_CERRADO=1" />
      <prop group="1" frame="frm_datos_visita" name="MAP_COMPETENCIA" visible="1" type="T" newline="false" linkedto="IDCOMPETENCIA" linkedfield="NOMBRE" size="40" width="45%" title="Competencia" labelwidth="8" tmargin="7" lmargin="2" disableedit="MAP_CERRADO=1" />
      <!-- ## Frame Lista adjuntos agenda ## -->
      <frame name="frm_adjuntos_cliente" height="37%" width="100%" scroll="true" />
      <prop group="1" frame="frm_adjuntos_cliente" name="MAP_LBADJUNTOS" visible="1" type="TL" class="label2" width="10%" labelwidth="8" title="Adjuntos" />
      <prop group="1" frame="frm_adjuntos_cliente" name="MAP_ADJUNTARFICHERO" visible="1" type="AT" title="Adjuntar Fichero" labelwidth="0" fieldsize="0" onchange="refresh" newline="false" width="15%" height="15%" />
      <prop group="1" frame="frm_adjuntos_cliente" name="MAP_ADJUNTARIMAGEN" visible="1" type="B" class="boton2" lmargin="2" title="Adjuntar Imagen" img="bt-camara-black.png" labelwidth="0" method="Executenode(fotografia)" fieldsize="0" onchange="refresh" newline="false" />
      <prop group="1" frame="frm_adjuntos_cliente" name="AdjuntosAgenda_Contents" labelwidth="0" width="100%" height="90%" type="Z" class="z_contents" visible="1" contents="AdjuntosAgenda_Contents" />
      <contents name="AdjuntosAgenda_Contents" src="AdjuntosAgenda_Contents" filter="t1.IDAGENDA=##FLD_ID##" />
      <!-- ## Frame Barra botones Agenda ## -->
      <frame name="frm_barrabotones" width="100%" height="10%" scroll="false" bgcolor="#fefefe,#bbbcbe" align="center" framebox="true" border-width="3" />
      <prop group="1" frame="frm_barrabotones" name="MAP_BT1" visible="1" type="B" class="botonmenu" icon="bt_back_black.png" onchange="refresh" method="Executenode(exit)" title="" disableedit="0=1" />
      <prop group="1" frame="frm_barrabotones" name="MAP_BT2" visible="1" type="B" class="botonmenu" newline="false" lmargin="2" icon="bt_save_black.png" onchange="refresh" method="Executenode(save)" title="" disablevisible="MAP_CERRADO=1" />
      <prop group="1" frame="frm_barrabotones" name="MAP_BT3" visible="1" type="B" class="botonmenu" newline="false" lmargin="2" icon="bt-okbox-black.png" onchange="refresh" method="Executenode(fin)" title="" disablevisible="MAP_CERRADO=1" />
      <prop group="1" frame="frm_barrabotones" name="MAP_BUTTONSELECT" visible="0" type="N" />
      <!-- ## Frame barra estado ## -->
      <frame name="frm_barraestado" width="100%" height="6%" scroll="false" bgcolor="#05264e" align="right" orientation="bottom" />
      <prop group="1" frame="frm_barraestado" name="MAP_DATOSESTADO" visible="0" type="T" />
      <prop group="1" frame="frm_barraestado" name="MAP_LBESTADO" visible="1" type="TL" class="labelestado" title="##FLD_MAP_DATOSESTADO##" tmargin="2" />
      <!-- ##### GRUPO 2 SELECION CLIENTE ##### -->
      <group name="SeleccionCliente" id="2" />
      <!-- ## Cabecera seleccion Cliente ## -->
      <frame name="frm_cabecera2" width="100%" height="7%" scroll="false" orientation="top" bgcolor="#094c9b,#05264e" />
      <prop group="2" frame="frm_cabecera2" name="MAP_ICON2" visible="1" type="B" width="5%" labelwidth="0" icon="icon.png" method="Executenode(menu0)" locked="true" />
      <prop group="2" frame="frm_cabecera2" name="MAP_CABECERA2" visible="1" type="TL" class="labelcab" title="##FLD_MAP_LABELCABECERA2##" />
      <prop group="2" frame="frm_cabecera2" name="MAP_LABELCABECERA2" type="T" visible="0" />
      <!-- ## Frame Filtro de clientes ## -->
      <frame name="frm_datos_filtro_cliente" width="100%" height="20%" scroll="false" />
      <prop group="2" frame="frm_datos_filtro_cliente" name="MAP_LBCLIENTESFILTRAR" visible="1" type="TL" class="label2" width="25%" title="Datos Filtro" tmargin="2" />
      <prop group="2" frame="frm_datos_filtro_cliente" name="MAP_NOMBRECLIENTE" visible="1" type="T" size="40" width="35%" tooltip="Nombre" labelwidth="0" tmargin="2" lmargin="1" disableedit="MAP_CERRADO=1" />
      <prop group="2" frame="frm_datos_filtro_cliente" name="MAP_CODIGOCLIENTE" visible="1" type="T" newline="false" size="40" width="20%" tooltip="Codigo" labelwidth="0" tmargin="2" lmargin="1" disableedit="MAP_CERRADO=1" />
      <prop group="2" frame="frm_datos_filtro_cliente" name="MAP_POBLACIONCLIENTE" visible="1" type="T" newline="false" size="40" width="33%" tooltip="Poblacion" labelwidth="0" tmargin="2" lmargin="1" disableedit="MAP_CERRADO=1" />
      <prop group="2" frame="frm_datos_filtro_cliente" name="MAP_FILTRARCLIENTES" visible="1" type="B" class="botonmenu" newline="false" lmargin="1" tmargin="1" icon="bt-find-black.png" onchange="refresh" method="Executenode(filtrarclientes)" title="" disableedit="MAP_CERRADO=1" />
      <!-- ## Frame Contents de clientes ## -->
      <frame name="frm_listadoClienes" height="57%" width="100%" />
      <prop group="2" frame="frm_listadoClienes" name="MAP_LBCLIENTESCONTENTS" visible="1" type="TL" class="label2" width="25%" title="Clientes" />
      <prop group="2" frame="frm_listadoClienes" name="Clientes_Contents" labelwidth="0" width="100%" height="90%" type="Z" class="z_contents" visible="1" contents="Clientes_Contents" />
      <contents name="Clientes_Contents" src="Clientes_Contents" filter="" />
      <!-- ## Frame Barra Botones seleccion Cliente ## -->
      <frame name="frm_barrabotones2" width="100%" height="10%" scroll="false" bgcolor="#fefefe,#bbbcbe" align="center" framebox="true" border-width="3" />
      <prop group="2" frame="frm_barrabotones2" name="MAP_BTATRAS" visible="1" type="B" class="botonmenu" icon="bt_back_black.png" onchange="refresh" method="Executenode(vergrupo1)" title="" disableedit="0=1" />
      <!-- ## Frame Barra Estado seleccion Cliente ## -->
      <frame name="frm_barraestado2" width="100%" height="6%" scroll="false" bgcolor="#05264e" align="right" orientation="bottom" />
      <prop group="2" frame="frm_barraestado2" name="MAP_DATOSESTADO2" visible="0" type="T" />
      <prop group="2" frame="frm_barraestado2" name="MAP_LBESTADO2" visible="1" type="TL" class="labelestado" title="##FLD_MAP_DATOSESTADO##" tmargin="2" />
      <prop name="MAP_CERRADO" type="N" visible="0" />
      <prop name="ID" type="N" visible="0" />
      <prop name="ID_ERP" visible="0" type="N" size="8" />
      <prop name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop name="IDUSUARIOORI" visible="0" type="N" size="8" />
      <prop name="IDUSUARIODES" visible="0" type="N" size="8" />
      <prop name="IDUSUARIO" visible="0" type="N" size="8" />
      <prop name="IDCLIENTE" visible="0" type="N" size="8" mapcol="Clientes_Basic" mapfld="ID" />
      <prop name="IDCOMPETENCIA" visible="0" type="N" size="8" mapcol="Competencia_Basic" mapfld="ID" />
      <prop name="IDTIPOMENSAJEAGENDA" visible="0" type="N" size="8" mapcol="TiposMensajeAgenda_Basic" mapfld="ID" />
      <prop name="FECHA_CREACION" visible="0" type="D" size="8" />
      <prop name="XLATITUD" visible="0" type="T" size="15" />
      <prop name="XLONGITUD" visible="0" type="T" size="15" />
      <prop name="COMPETENCIA_SN" visible="0" type="N" size="8" />
      <prop name="ITX_ERP" visible="0" type="N" size="8" />
      <prop name="ITX_XONE" visible="0" type="N" size="8" />
      <prop name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <create>
        <action name="setval" field="FECHA_CREACION" value="##NOW_TIME##" />
        <action name="setval" field="FECHA_VISITA" value="##NOW_TIME##" />
        <action name="setval" field="IDUSUARIO" value="##USERID##" />
        <action name="setval" field="IDEMPRESA" value="##ENTID##" />
        <action name="runscript">
          <script language="VBScript">   
                EditarAgenda 0
          </script>
        </action>
      </create>
      <before-edit>
        <action name="runscript">
          <script language="VBScript">   
				EditarAgenda 1
          </script>
        </action>
      </before-edit>
      <onback show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript" />
        </action>
      </onback>
      <buscarcliente show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		LB_ShowGroup 2
      		</script>
        </action>
      </buscarcliente>
      <vergrupo1 show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">         
          		LB_ShowGroup 1
      		</script>
        </action>
      </vergrupo1>
      <mapa show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		LB_ShowForm "Mapas",this("IDCLIENTE")
      		</script>
        </action>
      </mapa>
      <filtrarclientes show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		FiltrarContents "t1.COD like '%"+cstr(this("MAP_CODIGOCLIENTE"))+"%' and t1.NOMBRE like '%"+cstr(this("MAP_NOMBRECLIENTE"))+"%' and (select count(d.ID) from gen_direcciones d where d.IDRAZONSOCIAL=t1.IDRAZONSOCIAL AND d.POBLACION like '%"+cstr(this("MAP_POBLACIONCLIENTE"))+"%')&gt;0","Clientes_Contents"
      		</script>
        </action>
      </filtrarclientes>
      <exit show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		 	SalirAgenda
      		</script>
        </action>
      </exit>
      <save show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
					SalvarAgenda
      		</script>
        </action>
      </save>
      <fin show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
					FinalizarAgenda
      		</script>
        </action>
      </fin>
      <fotografia show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
					ui.StartCamera "MAP_ADJUNTARFICHERO", "photo"
      		</script>
        </action>
      </fotografia>
      <onchange>
        <field name="MAP_ADJUNTARFICHERO">
          <action name="runscript">
            <script language="VBScript"> 
                 if this("MAP_ADJUNTARFICHERO")&lt;&gt;"" then
                 	NuevoAdjuntoAgenda
                 End if
      		</script>
          </action>
        </field>
      </onchange>
    </coll>
    <coll name="Agenda_Menu_Calendario" title="AgendaMenu" sql="SELECT t1.*,CASE WHEN FECHA_FIN is null then '#88bf1b' else '#f19e14' end as MAP_COLORVIEW,substr(time(t1.FECHA_VISITA),0,6) as MAP_HORAINI, CASE WHEN t1.FECHA_FIN is null THEN CAST(substr(time(t1.FECHA_VISITA),0,3)+1 AS CHAR)||substr(time(t1.FECHA_VISITA),3,3) WHEN substr(time(t1.FECHA_VISITA),0,3)=substr(time(t1.FECHA_FIN),0,3) THEN CAST(substr(time(t1.FECHA_VISITA),0,3)+1 AS CHAR)||substr(time(t1.FECHA_VISITA),3,3) ELSE substr(time(t1.FECHA_FIN),0,6) END AS MAP_HORAFIN      FROM ##PREF##Agenda t1" objname="Agenda" updateobj="Agenda" progid="ASData.CASBasicDataObj" filter="(t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" sort="" show-toolbar="false" viewmode="calendar" check-owner="false" dependent="false">
      <group name="General" id="1" />
      <prop name="FECHA_VISITA" datefrom="true" dateto="true" type="D" visible="7" title="Direccion" fieldsize="14" size="150" labelbox="false" forecolor="#000080" labelwidth="6" text-border="false" text-border-bottom="false" text-border-left="false" text-border-right="false" text-border-top="false" />
      <prop name="MAP_HORAINI" type="T" timefrom="true" visible="7" title="Horario" fieldsize="14" size="30" labelbox="false" forecolor="#000080" labelwidth="6" text-border="false" text-border-bottom="false" text-border-left="false" text-border-right="false" text-border-top="false" />
      <prop name="MAP_HORAFIN" type="T" timeto="true" visible="7" title="Horario" fieldsize="14" size="30" labelbox="false" forecolor="#000080" labelwidth="6" text-border="false" text-border-bottom="false" text-border-left="false" text-border-right="false" text-border-top="false" />
      <prop name="MAP_DURATION" type="N" visible="7" title="Horario" fieldsize="14" size="30" labelbox="false" forecolor="#000080" labelwidth="6" text-border="false" text-border-bottom="false" text-border-left="false" text-border-right="false" text-border-top="false" />
      <prop name="MAP_COLORVIEW" type="T" visible="0" fieldsize="14" size="30" colorview="true" />
      <ondateselected refresh="true" show-wait-dialog="false" refresh-owner="MAP_FECHACALENDAR,MAP_TITLE_NAMES_MES">
        <action name="runscript">
          <param name="DATEVALUE" />
          <param name="TIMEVALUE" />
          <param name="EVENTVALUE" />
          <script language="vbscript">
            if DATEVALUE is null then
              DATEVALUE = thisDataColl.Variables("DATECALENDAR")
            end if          
          	thisDataColl.OwnerObject("MAP_FECHACALENDAR")= DATEVALUE
          	thisDataColl.OwnerObject("MAP_TITLE_NAMES_MES")=ucase(cstr(monthname(DATEVALUE))) 
			thisDataColl.OwnerObject("MAP_TITLE_NAMES_ANO")=ucase(cstr(year(DATEVALUE)))           	
          </script>
        </action>
      </ondateselected>
      <onpageselected refresh="true" show-wait-dialog="false" refresh-owner=",MAP_TITLE_NAMES_MES">
        <action name="runscript">
          <param name="DATEVALUE" />
          <param name="CURRENT" />
          <param name="DATEFROM" />
          <param name="TOTALDAYS" />
          <script language="vbscript">
              if DATEFROM is null then
                DATEFROM = thisDataColl.Variables("DATEFROM")
              end if         
				if appdata.CurrentEnterprise.variables("PLATFORM")="IOS" then
	                thisDataColl.OwnerObject("MAP_FECHACALENDAR")= DATEFROM
	               	thisDataColl.OwnerObject("MAP_TITLE_NAMES_MES")=ucase(cstr(monthname(DATEFROM)))   
	               	thisDataColl.OwnerObject("MAP_TITLE_NAMES_ANO")=ucase(cstr(year(DATEFROM)))        
				else
	                thisDataColl.OwnerObject("MAP_FECHACALENDAR")= DATEVALUE
	               	thisDataColl.OwnerObject("MAP_TITLE_NAMES_MES")=ucase(cstr(monthname(DATEVALUE)))   
	               	thisDataColl.OwnerObject("MAP_TITLE_NAMES_ANO")=ucase(cstr(year(DATEVALUE)))        
				end if				
            </script>
        </action>
      </onpageselected>
    </coll>
    <coll name="Agenda_Menu_Lista" title="Agenda_Basic" sql="SELECT t1.ID,t1.FECHA_VISITA,t1.FECHA_FIN,t2.NOMBRE AS MAP_CLIENTE,t3.DESCRIP AS MAP_TIPOMENSAJEAGENDA,      CASE WHEN t1.FECHA_FIN is null then '#88bf1b' else '#f19e14' end AS MAP_COLORVIEW FROM ##PREF##Agenda t1      left outer join ##PREF##Clientes t2 ON t1.IDCLIENTE=t2.ID      left outer join ##PREF##TiposMensajeAgenda t3 ON t1.IDTIPOMENSAJEAGENDA=t3.ID" check-owner="false" dependent="false" objname="Agenda" updateobj="Agenda" progid="ASData.CASBasicDataObj" filter="(t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" sort="">
      <group name="General" id="1" />
      <prop group="1" name="FECHA_VISITA" visible="7" type="DT" class="prop2" align="center" size="8" width="50%" labelwidth="0" bgcolor="#88bf1b" text-bgcolor="#88bf1b" locked="true" />
      <prop group="1" name="FECHA_FIN" visible="7" type="DT" class="prop2" align="center" newline="false" size="8" width="50%" labelwidth="0" bgcolor="##FLD_MAP_COLORVIEW##'" text-bgcolor="##FLD_MAP_COLORVIEW##" locked="true" />
      <prop group="1" name="MAP_TIPOMENSAJEAGENDA" visible="0" type="T" class="prop2" size="8" width="50%" labelwidth="0" newline="false" />
      <prop group="1" name="MAP_CLIENTE" visible="7" type="T" class="prop2" size="8" width="100%" labelwidth="0" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="MAP_COLORVIEW" type="T" visible="0" />
      <prop group="1" name="ID_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDUSUARIOORI" visible="0" type="N" size="8" />
      <prop group="1" name="IDUSUARIODES" visible="0" type="N" size="8" />
      <prop group="1" name="IDUSUARIO" visible="0" type="N" size="8" />
      <prop group="1" name="IDCLIENTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDCOMPETENCIA" visible="0" type="N" size="8" />
      <prop group="1" name="IDTIPOMENSAJEAGENDA" visible="0" type="N" size="8" />
      <prop group="1" name="FECHA_CREACION" visible="0" type="D" size="8" />
      <prop group="1" name="TIEMPO_VISITA" visible="0" type="D" size="8" />
      <prop group="1" name="XLATITUD" visible="0" type="T" size="15" />
      <prop group="1" name="XLONGITUD" visible="0" type="T" size="15" />
      <prop group="1" name="OBSERVACIONES" visible="0" type="T" size="400" />
      <prop group="1" name="COMPETENCIA_SN" visible="0" type="N" size="8" />
      <prop group="1" name="NOMBRE_VISITA" visible="0" type="D" size="40" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <selecteditem>
        <action name="runscript">
          <script language="VBScript">       
	        LB_ShowForm "Agenda_Editar",this("ID")
	       
	   </script>
        </action>
      </selecteditem>
    </coll>
    <coll name="Alertas_Basic" title="Alertas_Basic" sql="SELECT t1.ID     FROM ##PREF##Alertas t1" objname="Alertas" updateobj="Alertas" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDUSUARIO" visible="0" type="N" size="8" />
      <prop group="1" name="IDCLIENTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDTIPOALERTA" visible="0" type="N" size="8" />
      <prop group="1" name="FECHA_CIERRE" visible="0" type="D" size="8" />
      <prop group="1" name="TYPE" visible="0" type="N" size="8" />
      <prop group="1" name="F_DESDE" visible="7" type="D" size="8" width="50%" labelwidth="6" title="Fecha Desde:" />
      <prop group="1" name="F_HASTA" visible="7" type="D" size="8" width="50%" labelwidth="6" newline="false" title="Fecha Hasta:" />
      <prop group="1" name="CERRADA_SN" visible="7" type="NC" size="8" width="10%" labelwidth="6" title="Cerrada" />
      <prop group="1" name="COMENTARIO" visible="7" type="T" size="400" width="90%" title="Comentacion" labelwidth="0" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="Alertas_Contents" title="Alertas_Basic" sql="SELECT t1.*,t2.NOMBRE AS MAP_CLIENTE,t3.DESCRIP AS MAP_TIPOALERTA     FROM ##PREF##Alertas t1   left outer join ##PREF##Clientes t2 ON t1.IDCLIENTE=t2.ID   left outer join ##PREF##TiposAlerta t3 ON t1.IDTIPOALERTA=t3.ID" objname="Alertas" updateobj="Alertas" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDUSUARIO" visible="0" type="N" size="8" />
      <prop group="1" name="IDCLIENTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="FECHA_CIERRE" visible="0" type="D" size="8" />
      <prop group="1" name="TYPE" visible="0" type="N" size="8" />
      <prop group="1" name="MAP_TIPOALERTA" visible="7" type="D" size="8" width="20%" labelwidth="0" title=":" />
      <prop group="1" name="MAP_CLIENTE" visible="7" type="D" size="8" width="35%" labelwidth="0" newline="false" title="" />
      <prop group="1" name="F_DESDE" visible="7" type="D" size="8" width="20%" labelwidth="0" newline="false" title="Fecha Desde:" />
      <prop group="1" name="F_HASTA" visible="7" type="D" size="8" width="20%" labelwidth="0" newline="false" title="Fecha Hasta:" />
      <prop group="1" name="CERRADA_SN" visible="7" type="NC" size="8" width="5%" labelwidth="0" newline="false" title="Cerrada" />
      <prop group="1" name="COMENTARIO" visible="7" type="T" size="400" width="100%" title="Comentario" labelwidth="8" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <selecteditem show-wait-dialog="false" refresh-owner="MAP_COMENTARIOSEL,MAP_CERRADASEL,MAP_IDALERTASEL">
        <action name="runscript">
          <script language="VBScript">  
		         if not this.ownercollection.ownerobject is nothing then
 
		           this.OwnerCollection.ownerobject("MAP_COMENTARIOSEL")=this("COMENTARIO")
		           this.OwnerCollection.ownerobject("MAP_CERRADASEL")=this("CERRADA_SN")
		           this.OwnerCollection.ownerobject("MAP_IDALERTASEL")=this("ID")
		         end if
		           
		   </script>
        </action>
      </selecteditem>
    </coll>
    <coll name="Articulos_Basic" title="Articulos_Basic" sql="SELECT t1.*     FROM ##PREF##Articulos t1" objname="Articulos" updateobj="Articulos" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="COD" visible="7" type="T" size="5" width="20%" labelwidth="0" />
      <prop group="1" name="DESCRIP" visible="7" type="T" size="30" width="80%" labelwidth="0" newline="false" />
      <prop group="1" name="F_VIGENCIA" visible="0" type="D" size="8" />
      <prop group="1" name="F_BAJA" visible="0" type="D" size="8" />
      <prop group="1" name="GAUNITIP_UNI1" visible="0" type="T" size="4" />
      <prop group="1" name="GAUNITIP_UNI2" visible="0" type="T" size="4" />
      <prop group="1" name="GAUNITIP_PR" visible="0" type="T" size="4" />
      <prop group="1" name="GAUNITIP_EXPED" visible="0" type="T" size="4" />
      <prop group="1" name="FAMILIA" visible="0" type="T" size="40" />
      <prop group="1" name="GAMA" visible="0" type="T" size="40" />
      <prop group="1" name="SUBGAMA" visible="0" type="T" size="40" />
      <prop group="1" name="MARCA" visible="0" type="T" size="40" />
      <prop group="1" name="UM_CAJA" visible="0" type="N2" size="5" />
      <prop group="1" name="UM_PALET" visible="0" type="N2" size="30" />
      <prop group="1" name="CAJAS_BASE" visible="0" type="N2" size="8" />
      <prop group="1" name="CAJAS_PALET" visible="0" type="N2" size="8" />
      <prop group="1" name="IMAGEN_PEQ" visible="0" type="T" size="40" />
      <prop group="1" name="IMAGEN_GRANDE" visible="0" type="T" size="40" />
      <prop group="1" name="DESCRIP_LARGA" visible="0" type="T" size="400" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="Articulos_Contents_Pedido" title="Articulos_Basic" sql="SELECT t1.*     FROM ##PREF##Articulos t1" objname="Articulos" updateobj="Articulos" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="COD" visible="7" type="T" size="5" width="20%" labelwidth="0" />
      <prop group="1" name="DESCRIP" visible="7" type="T" size="30" width="80%" labelwidth="0" newline="false" />
      <prop group="1" name="F_VIGENCIA" visible="0" type="D" size="8" />
      <prop group="1" name="F_BAJA" visible="0" type="D" size="8" />
      <prop group="1" name="GAUNITIP_UNI1" visible="0" type="T" size="4" />
      <prop group="1" name="GAUNITIP_UNI2" visible="0" type="T" size="4" />
      <prop group="1" name="GAUNITIP_PR" visible="0" type="T" size="4" />
      <prop group="1" name="GAUNITIP_EXPED" visible="0" type="T" size="4" />
      <prop group="1" name="FAMILIA" visible="0" type="T" size="40" />
      <prop group="1" name="GAMA" visible="0" type="T" size="40" />
      <prop group="1" name="SUBGAMA" visible="0" type="T" size="40" />
      <prop group="1" name="MARCA" visible="0" type="T" size="40" />
      <prop group="1" name="UM_CAJA" visible="0" type="N2" size="5" />
      <prop group="1" name="UM_PALET" visible="0" type="N2" size="30" />
      <prop group="1" name="CAJAS_BASE" visible="0" type="N2" size="8" />
      <prop group="1" name="CAJAS_PALET" visible="0" type="N2" size="8" />
      <prop group="1" name="IMAGEN_PEQ" visible="0" type="T" size="40" />
      <prop group="1" name="IMAGEN_GRANDE" visible="0" type="T" size="40" />
      <prop group="1" name="DESCRIP_LARGA" visible="0" type="T" size="400" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <selecteditem show-wait-dialog="false" refresh-owner="frm_datos_filtro_articulos,frm_datos_filtro_articulos">
        <action name="runscript">
          <script language="VBScript">
		           if not this.ownercollection.ownerobject is nothing then
		             this.ownercollection.ownerobject("MAP_IDARTICULOSEL2")=this("ID")
		             this.ownercollection.ownerobject("MAP_ARTICULOSEL2")=this("DESCRIP")
		             this.ownercollection.ownerobject("MAP_UNIDADESSEL2")=1
					 ui.RefreshContentSelectedRow "Articulos_Contents_Pedido"
					 
		           end if  
		   </script>
        </action>
      </selecteditem>
    </coll>
    <coll name="Catalogo_Contents_Pedido" title="Articulos_Basic" sql="SELECT t1.ID ,t1.DESCRIP,t1.DESCRIP_LARGA,t1.COD||'  '||t1.DESCRIP AS MAP_ARTICULO,'http://212.170.61.117:8080/replicaimages/'||t1.COD||'P.jpg' AS MAP_FOTOP,'http://212.170.61.117:8080/replicaimages/'||t1.COD||'G.jpg' AS MAP_FOTOG    FROM ##PREF##Articulos t1" objname="Articulos" updateobj="Articulos" progid="ASData.CASBasicDataObj" filter="" sort="" cell-border-width="1" cell-selected-border-width="1">
      <group name="General" id="1" bgcolor="#FFFFFF" align="center" />
      <frame name="catalogo" framebox="false" bgcolor="#FFFFFF" align="top|center" />
      <prop group="1" frame="catalogo" name="ID" type="N" visible="0" />
      <prop group="1" frame="catalogo" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" frame="catalogo" name="COD" visible="0" type="T" size="5" width="10%" />
      <prop group="1" frame="catalogo" name="DESCRIP" visible="0" type="T" size="30" width="30%" />
      <prop group="1" frame="catalogo" name="MAP_ARTICULO" visible="7" type="T" size="30" fieldsize="40" align="top|center" width="100%" fontsize="10" labelwidth="0" bgcolor="#00000000" text-bgcolor="#00000000" />
      <prop group="1" frame="catalogo" name="MAP_FOTOP" cache-timeout="999999" type="IMG" align="center" locked="true" class="fotocatalogo" bgcolor="" visible="7" labelwidth="0" />
      <prop group="1" name="MAP_FOTOG" visible="0" type="D" size="8" />
      <prop group="1" name="F_VIGENCIA" visible="0" type="D" size="8" />
      <prop group="1" name="F_BAJA" visible="0" type="D" size="8" />
      <prop group="1" name="GAUNITIP_UNI1" visible="0" type="T" size="4" />
      <prop group="1" name="GAUNITIP_UNI2" visible="0" type="T" size="4" />
      <prop group="1" name="GAUNITIP_PR" visible="0" type="T" size="4" />
      <prop group="1" name="GAUNITIP_EXPED" visible="0" type="T" size="4" />
      <prop group="1" name="FAMILIA" visible="0" type="T" size="40" />
      <prop group="1" name="GAMA" visible="0" type="T" size="40" />
      <prop group="1" name="SUBGAMA" visible="0" type="T" size="40" />
      <prop group="1" name="MARCA" visible="0" type="T" size="40" />
      <prop group="1" name="UM_CAJA" visible="0" type="N2" size="5" />
      <prop group="1" name="UM_PALET" visible="0" type="N2" size="30" />
      <prop group="1" name="CAJAS_BASE" visible="0" type="N2" size="8" />
      <prop group="1" name="CAJAS_PALET" visible="0" type="N2" size="8" />
      <prop group="1" name="IMAGEN_PEQ" visible="0" type="T" size="40" />
      <prop group="1" name="IMAGEN_GRANDE" visible="0" type="T" size="40" />
      <prop group="1" name="DESCRIP_LARGA" visible="0" type="T" size="400" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <selecteditem show-wait-dialog="false" refresh="false">
        <action name="runscript">
          <script language="VBScript">       
		           if not this.ownercollection.ownerobject is nothing then
		             this.ownercollection.ownerobject("MAP_IDARTICULOSEL")=this("ID")
		             this.ownercollection.ownerobject("MAP_ARTICULOSEL")=this("DESCRIP")
		             this.ownercollection.ownerobject("MAP_ARTICULOSELEDIT")=this("DESCRIP")
		             this.ownercollection.ownerobject("MAP_FOTOG")=this("MAP_FOTOG")
		             this.ownercollection.ownerobject("MAP_DESCRIP_LARGA")=this("DESCRIP_LARGA")
		             this.ownercollection.ownerobject("MAP_UNIDADESSELEDIT")=1
		             this.ownercollection.ownerobject("MAP_TABPED")=4	

					 ui.refresh "frm_datos_edicion_catalogo"
					 ui.refresh "frm_barrabotones"  
					 ui.refresh "frm_Catalogo"
					 ui.refresh "frm_datos_filtro_catalogo"
		           end if
		   </script>
        </action>
      </selecteditem>
    </coll>
    <coll name="ClasificacionCliente_Basic" title="ClasificacionCliente_Basic" sql="SELECT t1.ID     FROM ##PREF##ClasificacionCliente t1" objname="ClasificacionCliente" updateobj="ClasificacionCliente" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDCLIENTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDCLASIFICACION" visible="0" type="N" size="8" />
      <prop group="1" name="IDTIPOCLASIFICACION" visible="0" type="N" size="8" />
      <prop group="1" name="VALOR" visible="0" type="T" size="40" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="Clasificaciones_Basic" title="Clasificaciones_Basic" sql="SELECT t1.ID     FROM ##PREF##Clasificaciones t1" objname="Clasificaciones" updateobj="Clasificaciones" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDTIPOCLASIFICACION" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="COD" visible="0" type="T" size="10" />
      <prop group="1" name="DESCRIP" visible="0" type="T" size="40" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="Clientes_Basic" title="Clientes_Basic" sql="SELECT t1.ID,t1.COD,t1.NOMBRE,t1.F_PAGO,t1.TARIFA     FROM ##PREF##Clientes t1" objname="Clientes" updateobj="Clientes" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDAGENTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDRAZONSOCIAL" visible="0" type="N" size="8" />
      <prop group="1" name="IDDIRECCION" visible="0" type="N" size="8" />
      <prop group="1" name="IDDIRECCIONENVIO" visible="0" type="N" size="8" />
      <prop group="1" name="COD" visible="7" type="T" size="5" width="20%" labelwidth="0" />
      <prop group="1" name="NOMBRE" visible="7" type="T" size="30" width="70%" labelwidth="0" newline="false" />
      <prop group="1" name="F_PAGO" visible="0" type="T" size="20" />
      <prop group="1" name="TARIFA" visible="0" type="T" size="20" />
      <prop group="1" name="WEB" visible="0" type="T" size="40" />
      <prop group="1" name="F_ALTA" visible="0" type="D" size="8" />
      <prop group="1" name="F_BAJA" visible="0" type="D" size="8" />
      <prop group="1" name="F_ULT_OPE" visible="0" type="D" size="8" />
      <prop group="1" name="GVAGENTE_COD" visible="0" type="N" size="8" />
      <prop group="1" name="MONEDAS_COD" visible="0" type="T" size="4" />
      <prop group="1" name="GGESTADO_COD" visible="0" type="T" size="4" />
      <prop group="1" name="IDIOMAS_COD" visible="0" type="T" size="4" />
      <prop group="1" name="XLATITUD" visible="0" type="T" size="15" />
      <prop group="1" name="XLONGITUD" visible="0" type="T" size="15" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="Clientes_Contents" title="Clientes_Basic" sql="SELECT t1.ID,t1.COD,t1.NOMBRE,t1.F_PAGO,t1.TARIFA     FROM ##PREF##Clientes t1" objname="Clientes" updateobj="Clientes" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDRAZONSOCIAL" visible="0" type="N" size="8" />
      <prop group="1" name="IDDIRECCION" visible="0" type="N" size="8" />
      <prop group="1" name="IDDIRECCIONENVIO" visible="0" type="N" size="8" />
      <prop group="1" name="COD" visible="7" type="T" size="5" width="20%" labelwidth="0" />
      <prop group="1" name="NOMBRE" visible="7" type="T" size="30" width="80%" labelwidth="0" newline="false" />
      <prop group="1" name="F_PAGO" visible="0" type="T" size="20" />
      <prop group="1" name="TARIFA" visible="0" type="T" size="20" />
      <prop group="1" name="WEB" visible="0" type="T" size="40" />
      <prop group="1" name="F_ALTA" visible="0" type="D" size="8" />
      <prop group="1" name="F_BAJA" visible="0" type="D" size="8" />
      <prop group="1" name="F_ULT_OPE" visible="0" type="D" size="8" />
      <prop group="1" name="GVAGENTE_COD" visible="0" type="N" size="8" />
      <prop group="1" name="MONEDAS_COD" visible="0" type="T" size="4" />
      <prop group="1" name="GGESTADO_COD" visible="0" type="T" size="4" />
      <prop group="1" name="IDIOMAS_COD" visible="0" type="T" size="4" />
      <prop group="1" name="XLATITUD" visible="0" type="T" size="15" />
      <prop group="1" name="XLONGITUD" visible="0" type="T" size="15" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <selecteditem>
        <action name="runscript">
          <script language="VBScript">
       
		           if not this.ownercollection.ownerobject is nothing then
		             this.ownercollection.ownerobject("IDCLIENTE")=this("ID")
		             this.ownercollection.ownerobject.ExecuteNode "vergrupo1"
		           end if
		   </script>
        </action>
      </selecteditem>
    </coll>
    <coll name="Clientes_Contents2" title="Clientes_Basic" sql="SELECT t1.ID,t1.COD,t1.NOMBRE,t1.F_PAGO,t1.TARIFA     FROM ##PREF##Clientes t1" objname="Clientes" updateobj="Clientes" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDRAZONSOCIAL" visible="0" type="N" size="8" />
      <prop group="1" name="IDDIRECCION" visible="0" type="N" size="8" />
      <prop group="1" name="IDDIRECCIONENVIO" visible="0" type="N" size="8" />
      <prop group="1" name="COD" visible="7" type="T" size="5" width="20%" labelwidth="0" />
      <prop group="1" name="NOMBRE" visible="7" type="T" size="30" width="80%" labelwidth="0" newline="false" />
      <prop group="1" name="F_PAGO" visible="0" type="T" size="20" />
      <prop group="1" name="TARIFA" visible="0" type="T" size="20" />
      <prop group="1" name="WEB" visible="0" type="T" size="40" />
      <prop group="1" name="F_ALTA" visible="0" type="D" size="8" />
      <prop group="1" name="F_BAJA" visible="0" type="D" size="8" />
      <prop group="1" name="F_ULT_OPE" visible="0" type="D" size="8" />
      <prop group="1" name="GVAGENTE_COD" visible="0" type="N" size="8" />
      <prop group="1" name="MONEDAS_COD" visible="0" type="T" size="4" />
      <prop group="1" name="GGESTADO_COD" visible="0" type="T" size="4" />
      <prop group="1" name="IDIOMAS_COD" visible="0" type="T" size="4" />
      <prop group="1" name="XLATITUD" visible="0" type="T" size="15" />
      <prop group="1" name="XLONGITUD" visible="0" type="T" size="15" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <selecteditem show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
       
		           if not this.ownercollection.ownerobject is nothing then
		               LB_ShowForm "Clientes_Menu",this("ID")
		           end if
		   </script>
        </action>
      </selecteditem>
    </coll>
    <coll name="Clientes_Contents_Pedido" title="Clientes_Basic" sql="SELECT t1.ID,t1.COD,t1.NOMBRE,t1.F_PAGO,t1.TARIFA     FROM ##PREF##Clientes t1" objname="Clientes" updateobj="Clientes" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDRAZONSOCIAL" visible="0" type="N" size="8" />
      <prop group="1" name="IDDIRECCION" visible="0" type="N" size="8" />
      <prop group="1" name="IDDIRECCIONENVIO" visible="0" type="N" size="8" />
      <prop group="1" name="COD" visible="7" type="T" size="5" width="20%" labelwidth="0" />
      <prop group="1" name="NOMBRE" visible="7" type="T" size="30" width="80%" labelwidth="0" newline="false" />
      <prop group="1" name="F_PAGO" visible="0" type="T" size="20" />
      <prop group="1" name="TARIFA" visible="0" type="T" size="20" />
      <prop group="1" name="WEB" visible="0" type="T" size="40" />
      <prop group="1" name="F_ALTA" visible="0" type="D" size="8" />
      <prop group="1" name="F_BAJA" visible="0" type="D" size="8" />
      <prop group="1" name="F_ULT_OPE" visible="0" type="D" size="8" />
      <prop group="1" name="GVAGENTE_COD" visible="0" type="N" size="8" />
      <prop group="1" name="MONEDAS_COD" visible="0" type="T" size="4" />
      <prop group="1" name="GGESTADO_COD" visible="0" type="T" size="4" />
      <prop group="1" name="IDIOMAS_COD" visible="0" type="T" size="4" />
      <prop group="1" name="XLATITUD" visible="0" type="T" size="15" />
      <prop group="1" name="XLONGITUD" visible="0" type="T" size="15" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <selecteditem show-wait-dialog="false" refresh-owner="cabecera1,MAP_NOMBRE_CLIENTE">
        <action name="runscript">
          <script language="VBScript">
     
		           if not this.ownercollection.ownerobject is nothing then
		             if this.OwnerCollection.ownerobject("MAP_LINEAS")&gt;0 then
		               if LB_MsgYesNo("El pedido ya esta en curso. Desea modificar el cliente asociado?") then
					             this.ownercollection.ownerobject("IDCLIENTE")=this("ID")
					             this.ownercollection.ownerobject("MAP_NOMBRE_CLIENTE")=this("NOMBRE")
					             this.ownercollection.ownerobject("IDRAZONSOCIAL")=this("IDRAZONSOCIAL")
					             this.ownercollection.ownerobject("MAP_LBCABECERA1")="INGAPAN Mobile CRM -  PEDIDOS ("+this("NOMBRE")+")"
					              ui.RefreshContentSelectedRow "Clientes_Contents_Pedido"
					    end if
					 else
					             this.ownercollection.ownerobject("IDCLIENTE")=this("ID")
					             this.ownercollection.ownerobject("IDRAZONSOCIAL")=this("IDRAZONSOCIAL")
					             this.ownercollection.ownerobject("MAP_NOMBRE_CLIENTE")=this("NOMBRE")
					             this.ownercollection.ownerobject("MAP_LBCABECERA1")="INGAPAN Mobile CRM -  PEDIDOS ("+this("NOMBRE")+")"
 								ui.RefreshContentSelectedRow "Clientes_Contents_Pedido"					             
					 end if
		             
		           end if
		   </script>
        </action>
      </selecteditem>
    </coll>
    <coll name="Clientes_Menu" title="Clientes_Menu" sql="SELECT t1.*,t1.XLATITUD||' / '||t1.XLATITUD AS MAP_GPS,t2.COD AS MAP_CODRAZONSOCIAL,t2.NOMBRE AS MAP_NOMBRERAZONSOCIAL FROM ##PREF##Clientes t1   left outer join ##PREF##RazonSocial t2 ON t2.ID=t1.IDRAZONSOCIAL" objname="Clientes" updateobj="Clientes" progid="ASData.CASBasicDataObj" filter="" sort="">
      <!-- ##### GRUPO GENERAL DE DATOS CLIENTE##### -->
      <group name="general" id="1" />
      <!-- ## Frame Cabecera Datos Cliente## -->
      <frame name="frm_cabecera" width="100%" height="7%" scroll="false" orientation="top" bgcolor="#094c9b,#05264e" />
      <prop group="1" frame="frm_cabecera" name="MAP_ICON1" visible="1" type="B" width="5%" labelwidth="0" icon="icon.png" method="Executenode(menu0)" locked="true" />
      <prop group="1" frame="frm_cabecera" name="MAP_CABECERA" visible="1" type="TL" class="labelcab" title="##FLD_MAP_LABELCABECERA##" />
      <prop group="1" frame="frm_cabecera" name="MAP_LABELCABECERA" type="T" visible="0" />
      <!-- ## Frame Pestas clientes## -->
      <frame name="frm_pestanas_Cliente" width="100%" height="7%" scroll="false" bgcolor="#ffda6b" framebox="true" border-width="3" align="center" />
      <prop group="1" frame="frm_pestanas_Cliente" name="MAP_TABCLI" type="N" visible="0" />
      <prop group="1" frame="frm_pestanas_Cliente" name="MAP_BTGROUPCLI1" visible="1" type="B" class="botongrupo" bgcolor="##FLD_MAP_BTIMGCLI1##" caption="Datos Cliente" onchange="refresh" method="Executenode(menucliente(1))" title="" />
      <prop group="1" frame="frm_pestanas_Cliente" name="MAP_BTGROUPCLI2" visible="1" type="B" class="botongrupo" newline="false" lmargin="1" bgcolor="##FLD_MAP_BTIMGCLI2##" caption="Historico" onchange="refresh" method="Executenode(menucliente(2))" title="" />
      <prop group="1" frame="frm_pestanas_Cliente" name="MAP_BTGROUPCLI3" visible="1" type="B" class="botongrupo" newline="false" lmargin="1" bgcolor="##FLD_MAP_BTIMGCLI3##" caption="Pedidos" onchange="refresh" method="Executenode(menucliente(3))" title="" />
      <prop group="1" frame="frm_pestanas_Cliente" name="MAP_BTGROUPCLI4" visible="1" type="B" class="botongrupo" newline="false" lmargin="1" bgcolor="##FLD_MAP_BTIMGCLI4##" caption="Condiciones" onchange="refresh" method="Executenode(menucliente(4))" title="" />
      <prop group="1" frame="frm_pestanas_Cliente" name="MAP_BTGROUPCLI5" visible="1" type="B" class="botongrupo" newline="false" lmargin="1" bgcolor="##FLD_MAP_BTIMGCLI5##" caption="QLikView" onchange="refresh" method="Executenode(menucliente(5))" title="" />
      <prop group="1" frame="frm_pestanas_Cliente" name="MAP_BTGROUPCLI6" visible="1" type="B" class="botongrupo" newline="false" lmargin="1" bgcolor="##FLD_MAP_BTIMGCLI6##" caption="Alertas" onchange="refresh" method="Executenode(menucliente(6))" title="" />
      <prop group="1" frame="frm_pestanas_Cliente" name="MAP_BTGROUPCLI7" visible="1" type="B" class="botongrupo" newline="false" lmargin="1" bgcolor="##FLD_MAP_BTIMGCLI7##" caption="Maquinaria" onchange="refresh" method="Executenode(menucliente(7))" title="" />
      <prop group="1" frame="frm_pestanas_Cliente" name="MAP_BTIMGCLI1" visible="0" type="T" />
      <prop group="1" frame="frm_pestanas_Cliente" name="MAP_BTIMGCLI2" visible="0" type="T" />
      <prop group="1" frame="frm_pestanas_Cliente" name="MAP_BTIMGCLI3" visible="0" type="T" />
      <prop group="1" frame="frm_pestanas_Cliente" name="MAP_BTIMGCLI4" visible="0" type="T" />
      <prop group="1" frame="frm_pestanas_Cliente" name="MAP_BTIMGCLI5" visible="0" type="T" />
      <prop group="1" frame="frm_pestanas_Cliente" name="MAP_BTIMGCLI6" visible="0" type="T" />
      <prop group="1" frame="frm_pestanas_Cliente" name="MAP_BTIMGCLI7" visible="0" type="T" />
      <prop group="1" frame="frm_pestanas_Cliente" name="MAP_BUTTONSELECT" visible="0" type="N" />
      <!-- ## Frame Datos del cliente 1## -->
      <frame name="frm_datos_Cliente" width="100%" height="40%" scroll="false" disablevisible="MAP_TABCLI&lt;&gt;1" />
      <prop group="1" frame="frm_datos_Cliente" name="COD" visible="1" type="T" size="8" width="45%" title="Codigo" labelwidth="6" tmargin="4" locked="true" />
      <prop group="1" frame="frm_datos_Cliente" name="MONEDAS_COD" visible="1" type="T" size="8" width="45%" title="Moneda" labelwidth="6" tmargin="4" lmargin="2" newline="false" locked="true" />
      <prop group="1" frame="frm_datos_Cliente" name="NOMBRE" visible="1" type="T" size="8" width="45%" title="Nombre" labelwidth="6" tmargin="2" locked="true" />
      <prop group="1" frame="frm_datos_Cliente" name="IDIOMAS_COD" visible="1" type="T" size="8" width="45%" title="Idioma" labelwidth="6" tmargin="2" lmargin="2" newline="false" locked="true" />
      <prop group="1" frame="frm_datos_Cliente" name="MAP_CODRAZONSOCIAL" visible="1" type="T" size="8" width="45%" title="Cod. RS" labelwidth="6" tmargin="2" locked="true" />
      <prop group="1" frame="frm_datos_Cliente" name="GGESTADO_COD" visible="1" type="T" size="8" width="45%" title="Estado" labelwidth="6" tmargin="2" lmargin="2" newline="false" locked="true" />
      <prop group="1" frame="frm_datos_Cliente" name="MAP_NOMBRERAZONSOCIAL" visible="1" type="T" size="8" width="45%" title="Nombre RS" labelwidth="6" tmargin="2" locked="true" />
      <prop group="1" frame="frm_datos_Cliente" name="F_ALTA" visible="1" type="D" size="8" width="22%" title="F Alta" labelwidth="4" tmargin="2" lmargin="2" newline="false" locked="true" />
      <prop group="1" frame="frm_datos_Cliente" name="F_ULT_OPE" visible="1" type="D" size="8" width="22%" title="F Edit" labelwidth="4" tmargin="2" lmargin="1" newline="false" locked="true" />
      <prop group="1" frame="frm_datos_Cliente" name="WEB" visible="1" type="T" size="8" width="45%" title="Web" labelwidth="6" tmargin="4" locked="true" />
      <prop group="1" frame="frm_datos_Cliente" name="MAP_GPS" visible="1" type="T" size="8" width="40%" title="GPS" labelwidth="6" tmargin="4" lmargin="2" newline="false" locked="true" />
      <prop group="1" frame="frm_datos_Cliente" name="MAP_VERMAPA" visible="1" type="B" class="boton2" lmargin="2" tmargin="3" title="" img="bt-gps-black.png" labelwidth="0" method="Executenode(mapa)" fieldsize="0" onchange="refresh" newline="false" />
      <prop group="1" frame="frm_datos_Cliente" name="MAP_MAPA" title=" " newline="false" type="Z" visible="0" class="boton2" viewmode="mapview" contents="MAPA" text-border="false" border="false" tmargin="3" bgcolor="#00000000" mask="2" img="bt-gps-black.png" imgsel="bt-gps-black.png" />
      <contents name="MAPA" src="Datos_Mapa" filter="t1.ID=##FLD_ID##" />
      <!-- ## Frame Lista de clientes 1# -->
      <frame name="frm_contents_cliente" height="30%" width="100%" disablevisible="MAP_TABCLI&lt;&gt;1" />
      <prop group="1" frame="frm_contents_cliente" name="MAP_LBCONTACTOSCONTENTS" visible="1" type="TL" class="label2" width="50%" title="Contactos" />
      <prop group="1" frame="frm_contents_cliente" name="MAP_LBDIRCONTENTS" visible="1" type="TL" class="label2" width="50%" title="Direcciones" newline="false" />
      <prop group="1" frame="frm_contents_cliente" name="Contactos_Contents" labelwidth="0" width="50%" height="90%" type="Z" class="z_contents" visible="1" contents="Contactos_Contents" />
      <contents name="Contactos_Contents" src="Contactos_Basic" filter="t1.IDRAZONSOCIAL=##FLD_IDRAZONSOCIAL## and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <prop group="1" frame="frm_contents_cliente" name="Direcciones_Contents" labelwidth="0" width="50%" height="90%" type="Z" class="z_contents" visible="1" contents="Direcciones_Contents" newline="false" />
      <contents name="Direcciones_Contents" src="Direcciones_Basic" filter="t1.IDRAZONSOCIAL=##FLD_IDRAZONSOCIAL## and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <!-- ## Frame Historico 2# -->
      <frame name="frm_contents_historico" height="70%" width="100%" disablevisible="MAP_TABCLI&lt;&gt;2" />
      <prop group="1" frame="frm_contents_historico" name="MAP_IDTIPOMENSAJEAGENDA" visible="0" type="N" size="8" mapcol="TiposMensajeAgenda_Basic" mapfld="ID" onchange="refresh255" />
      <prop group="1" frame="frm_contents_historico" name="MAP_CATEGORIA" visible="1" type="T" newline="false" linkedto="MAP_IDTIPOMENSAJEAGENDA" linkedfield="DESCRIP" size="40" width="45%" title="Categoria: " labelwidth="8" tmargin="2" />
      <prop group="1" frame="frm_contents_historico" name="MAP_BT_LIMPIAR" visible="1" type="B" newline="false" class="boton2" icon="bt-x-black.png" onchange="refresh" method="Executenode(limpiartipoagenda)" title="" tmargin="2" lmargin="0" />
      <prop group="1" frame="frm_contents_historico" name="MAP_LBHISTORICOCONTENTS" visible="1" type="TL" class="label2" width="50%" title="Historico" tmargin="1" />
      <prop group="1" frame="frm_contents_historico" name="Historico_Contents" labelwidth="0" width="100%" height="81%" type="Z" class="z_contents" visible="1" contents="Historico_Contents" onchange="refresh255" postonchange="refresh" />
      <contents name="Historico_Contents" src="Agenda_Contents" filter="(t1.IDTIPOMENSAJEAGENDA=##FLD_MAP_IDTIPOMENSAJEAGENDA## or ##FLD_MAP_IDTIPOMENSAJEAGENDA##=0) and  t1.IDCLIENTE=##FLD_ID## and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <!-- ## Frame Pedidos 3# -->
      <frame name="frm_contents_pedidos" height="70%" width="100%" disablevisible="MAP_TABCLI&lt;&gt;3" />
      <prop group="1" frame="frm_contents_pedidos" name="MAP_IDFILTROPEDIDO" visible="0" type="N" size="8" mapcol-values="Ultima Semana,Ultimo Mes,Todos" mapfld="ID" onchange="refresh255" />
      <prop group="1" frame="frm_contents_pedidos" name="MAP_FILTROPEDIDO" visible="1" type="T" newline="false" linkedto="MAP_IDFILTROPEDIDO" linkedfield="DATA" size="40" width="45%" title="Filtro: " labelwidth="8" tmargin="2" />
      <prop group="1" frame="frm_contents_pedidos" name="MAP_BTNUEVOPEDIDO" visible="1" type="B" class="botonmenu" icon="bt-mas-black.png" onchange="refresh" postonchange="refresh" method="Executenode(nuevopedido)" title="" newline="false" tmargin="1" />
      <prop group="1" frame="frm_contents_pedidos" name="MAP_LBPEDIDOSCONTENTS" visible="1" type="TL" class="label2" width="50%" title="Pedidos" tmargin="1" />
      <prop group="1" frame="frm_contents_pedidos" name="MAP_LBLINEASCONTENTS" visible="1" type="TL" class="label2" width="50%" title="Lineas" newline="false" tmargin="1" />
      <prop group="1" frame="frm_contents_pedidos" name="PedidosCab_Contents" labelwidth="0" width="50%" height="81%" type="Z" class="z_contents" visible="1" contents="PedidosCab_Contents" />
      <contents name="PedidosCab_Contents" src="PedidosCab_Contents" filter="t1.IDCLIENTE=##FLD_ID## and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <prop group="1" frame="frm_contents_pedidos" name="MAP_IDPEDIDOSEL" visible="0" type="N" size="8" />
      <prop group="1" frame="frm_contents_pedidos" name="PedidosLin_Contents" labelwidth="0" width="50%" height="81%" type="Z" class="z_contents" visible="1" contents="PedidosLin_Contents" newline="false" />
      <contents name="PedidosLin_Contents" src="PedidosLin_Contents" filter="t1.IDPEDIDO=##FLD_MAP_IDPEDIDOSEL## and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <!-- ## Frame Condiciones 4# -->
      <frame name="frm_contents_condiciones" height="70%" width="100%" disablevisible="MAP_TABCLI&lt;&gt;4" />
      <prop group="1" frame="frm_contents_condiciones" name="MAP_LBCONDICIONESCONTENTS" visible="1" type="TL" class="label2" width="50%" title="Condiciones" tmargin="2" />
      <prop group="1" frame="frm_contents_condiciones" name="Condiciones_Contents" labelwidth="0" locked="true" width="100%" height="90%" type="Z" class="z_contents" visible="1" contents="Condiciones_Contents" />
      <contents name="Condiciones_Contents" src="Condiciones_Contents" filter="t1.IDCLIENTE=##FLD_ID## and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <!-- ## Frame QLikView 5## -->
      <frame name="frm_qlikview" height="70%" width="100%" disablevisible="MAP_TABCLI&lt;&gt;5" />
      <prop group="1" frame="frm_qlikview" name="MAP_LIKVIEW" visible="1" class="html" type="WEB" width="100%" height="100%" scroll="false" webview-username="##FLD_MAP_USERWEB##" webview-password="##FLD_MAP_PWDWEB##" />
      <prop group="1" frame="frm_qlikview" name="MAP_USERWEB" visible="0" type="T" />
      <prop group="1" frame="frm_qlikview" name="MAP_PWDWEB" visible="0" type="T" />
      <!-- ## Frame Alertas 6# -->
      <frame name="frm_datos_filtro_Alertas" width="100%" height="27%" scroll="false" disablevisible="MAP_TABCLI&lt;&gt;6" />
      <prop group="1" frame="frm_datos_filtro_Alertas" name="MAP_LBALERTASFILTRAR" visible="1" type="TL" class="label2" width="25%" title="Datos Filtro" tmargin="1" />
      <prop group="1" frame="frm_datos_filtro_Alertas" name="MAP_IDTIPOALERTA" visible="0" type="N" size="8" mapcol="TiposAlerta_Basic" mapfld="ID" onchange="refresh255" />
      <prop group="1" frame="frm_datos_filtro_Alertas" name="MAP_TIPOALERTA" visible="1" type="T" linkedto="MAP_IDTIPOALERTA" linkedfield="DESCRIP" size="40" width="25%" title="Tipo: " labelwidth="3" tmargin="2" />
      <prop group="1" frame="frm_datos_filtro_Alertas" name="MAP_BT_LIMPIAR_ALERTA" visible="1" type="B" newline="false" class="boton2" icon="bt-x-black.png" onchange="refresh" method="Executenode(limpiartipoalerta)" title="" tmargin="2" lmargin="0" />
      <prop group="1" frame="frm_datos_filtro_Alertas" name="MAP_FECHADESDE" visible="1" type="D" newline="false" size="40" width="15%" tooltip="Desde" labelwidth="0" tmargin="2" lmargin="1" />
      <prop group="1" frame="frm_datos_filtro_Alertas" name="MAP_FECHAHASTA" visible="1" type="D" newline="false" size="40" width="15%" tooltip="Hasta" labelwidth="0" tmargin="2" lmargin="0" />
      <prop group="1" frame="frm_datos_filtro_Alertas" name="MAP_COMENTARIO" visible="1" type="T" newline="false" size="40" width="20%" tooltip="Comentario" labelwidth="0" tmargin="2" lmargin="0" />
      <prop group="1" frame="frm_datos_filtro_Alertas" name="MAP_LBCERRADAS" visible="1" type="TL" class="label2" width="8%" title="Cerradas" tmargin="2" newline="false" />
      <prop group="1" frame="frm_datos_filtro_Alertas" name="MAP_CERRADA" visible="1" type="NC" newline="false" size="40" title=" " labelwidth="0" tmargin="1" lmargin="0" />
      <prop group="1" frame="frm_datos_filtro_Alertas" name="MAP_FILTRARALERTAS" visible="1" type="B" class="botonmenu" newline="false" lmargin="1" tmargin="1" icon="bt-find-black.png" onchange="refresh" method="Executenode(filtraralertas)" title="" />
      <prop group="1" frame="frm_datos_filtro_Alertas" name="MAP_LBALERTASEL" visible="1" type="TL" class="label2" width="25%" title="Alerta Seleccionada" tmargin="1" />
      <prop group="1" frame="frm_datos_filtro_Alertas" name="MAP_COMENTARIOSEL" visible="1" type="T" size="40" width="80%" tooltip="Comentario Alerta Seleccionada" labelwidth="0" tmargin="2" lmargin="1" />
      <prop group="1" frame="frm_datos_filtro_Alertas" name="MAP_BT_CERRARSEL" visible="1" type="B" newline="false" class="boton2" icon="bt-okbox-black.png" onchange="refresh" method="Executenode(cerraralerta)" title="" tmargin="1" lmargin="1" />
      <prop group="1" frame="frm_datos_filtro_Alertas" name="MAP_CERRADASEL" visible="0" type="N" />
      <prop group="1" frame="frm_datos_filtro_Alertas" name="MAP_IDALERTASEL" visible="0" type="N" />
      <frame name="frm_contents_alertas" height="43%" width="100%" disablevisible="MAP_TABCLI&lt;&gt;6" />
      <prop group="1" frame="frm_contents_alertas" name="MAP_LBALERTASCONTENTS1" visible="1" type="TL" class="label2" width="20%" title=" Tipo Alerta" tmargin="2" />
      <prop group="1" frame="frm_contents_alertas" name="MAP_LBALERTASCONTENTS2" visible="1" type="TL" newline="false" class="label2" width="35%" title="  Cliente" tmargin="2" />
      <prop group="1" frame="frm_contents_alertas" name="MAP_LBALERTASCONTENTS3" visible="1" type="TL" newline="false" class="label2" width="20%" title="  F. Desde" tmargin="2" />
      <prop group="1" frame="frm_contents_alertas" name="MAP_LBALERTASCONTENTS4" visible="1" type="TL" newline="false" class="label2" width="20%" title="  F. Hasta" tmargin="2" />
      <prop group="1" frame="frm_contents_alertas" name="MAP_LBALERTASCONTENTS5" visible="1" type="TL" newline="false" class="label2" width="5%" title="    C" tmargin="2" />
      <prop group="1" frame="frm_contents_alertas" name="Alertas_Contents" labelwidth="0" width="100%" height="90%" type="Z" class="z_contents" visible="1" contents="Alertas_Contents" />
      <contents name="Alertas_Contents" src="Alertas_Contents" filter="t1.CERRADA_SN=0 and t1.IDCLIENTE=##FLD_ID## and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <!-- ## Frame Maquinaria 7# -->
      <frame name="frm_contents_maquinaria" height="70%" width="100%" disablevisible="MAP_TABCLI&lt;&gt;7" />
      <prop group="1" frame="frm_contents_maquinaria" name="MAP_LBMAQUINARIACONTENTS" visible="1" type="TL" class="label2" width="50%" title="Maquinaria" tmargin="2" />
      <prop group="1" frame="frm_contents_maquinaria" name="Estadisticas_Contents" labelwidth="0" width="100%" height="90%" type="Z" class="z_contents" visible="1" contents="Estadisticas_Contents" />
      <contents name="Estadisticas_Contents" src="Estadisticas_Contents3" filter="t1.IDCLIENTE=##FLD_ID## and t1.GGALBTIP_COD like '%MQ%'" />
      <!-- ## Frame botones edicion cliente## -->
      <frame name="frm_barrabotones" width="100%" height="10%" scroll="false" bgcolor="#fefefe,#bbbcbe" align="center" framebox="true" border-width="3" />
      <prop group="1" frame="frm_barrabotones" name="MAP_BT1" visible="1" type="B" class="botonmenu" icon="bt_back_black.png" onchange="refresh" method="Executenode(exit)" title="" />
      <prop group="1" frame="frm_barrabotones" name="MAP_BT2" visible="1" type="B" class="botonmenu" newline="false" lmargin="2" icon="bt_gps2_black.png" onchange="refresh255" method="Executenode(gps)" title="" />
      <!-- ## Frame Bara Estado## -->
      <frame name="frm_barraestado" width="100%" height="6%" scroll="false" bgcolor="#05264e" align="right" orientation="bottom" />
      <prop group="1" frame="frm_barraestado" name="MAP_DATOSESTADO" visible="0" type="T" />
      <prop group="1" frame="frm_barraestado" name="MAP_LBESTADO" visible="1" type="TL" class="labelestado" title="##FLD_MAP_DATOSESTADO##" tmargin="2" />
      <prop name="IDRAZONSOCIAL" type="N" visible="0" />
      <prop name="ID" type="N" visible="0" />
      <prop name="ITX_ERP" visible="0" type="N" size="8" />
      <prop name="ITX_XONE" visible="0" type="N" size="8" />
      <prop name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <before-edit show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">   
				'Cargamos datos de barra de estado
				this("MAP_DATOSESTADO")=CargarBarraEstado()	
				this("MAP_LABELCABECERA")="INGAPAN Mobile CRM  -  Cliente: "+ cstr(this("NOMBRE"))
				'Caramos iconos de pestaas virtuales
				CargarIconosCliente 1
				CargarGruposCliente 1
				this("MAP_USERWEB")=appdata.CurrentEnterprise.variables("QL_USERNAME")
	            this("MAP_PWDWEB")=appdata.CurrentEnterprise.variables("QL_PASSWD")				

	
          </script>
        </action>
      </before-edit>
      <onchange>
        <field name="MAP_FILTROPEDIDO">
          <action name="runscript">
            <script language="VBScript"> 

          		      select CASE this("MAP_FILTROPEDIDO")
          		        case "Todos"
          		          FiltrarContents "t1.IDCLIENTE=##FLD_ID## and t1.F_PEDIDO BETWEEN datetime('now', '-6 days') AND datetime('now', 'localtime') and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" ,"PedidosCab_Contents"
             		    case "Ultima Semana"
             		      FiltrarContents "t1.IDCLIENTE=##FLD_ID## and t1.F_PEDIDO BETWEEN datetime('now', '-6 days') AND datetime('now', 'localtime') and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" ,"PedidosCab_Contents"
             		    case "Ultimo Mes"
             		      FiltrarContents "t1.IDCLIENTE=##FLD_ID## and t1.F_PEDIDO BETWEEN datetime('now', 'start of month') AND datetime('now', 'localtime') and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" ,"PedidosCab_Contents"
             		    end select
						this("MAP_IDPEDIDOSEL")=0
      		</script>
          </action>
        </field>
      </onchange>
      <onback show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript" />
        </action>
      </onback>
      <vergrupo1 show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		LB_ShowGroup 1
      		</script>
        </action>
      </vergrupo1>
      <mapa show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		LB_ShowForm "Mapas",this("ID")
      		</script>
        </action>
      </mapa>
      <limpiartipoagenda show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          	  this("MAP_IDTIPOMENSAJEAGENDA")=0
          	  this("MAP_CATEGORIA")=""
      		</script>
        </action>
      </limpiartipoagenda>
      <menucliente show-wait-dialog="false">
        <action name="runscript">
          <param name="nmenu" />
          <script language="VBScript">
          			this("MAP_LIKVIEW")=""
                    'Cargamos pestaa virtual
      				this("MAP_BUTTONSELECT")=nmenu
      				CargarIconosCliente nmenu
      				CargarGruposCliente nmenu
                  </script>
        </action>
      </menucliente>
      <gps show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		st_gps=CapturarGPS2()
          		if st_gps&lt;&gt;""  then
          		
          		   if LB_MsgYesNo ("Desea actualizar la posicion GPS "+st_gps+" en el cliente?") then
          		      this("XLATITUD")=left(st_gps,12)
          		      this("XLONGITUD")=right(st_gps,12)
          		      this("MAP_GPS")=st_gps
          		      this.save
          		   end if
          		 else
          		    LB_Msg "No se pudo capturar la posicion GPS. Comprobar si el GPS esta activo y si tiene cobertura"
          		end if
      		</script>
        </action>
      </gps>
      <exit show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
                  if LB_MsgYesNo ("Desea salir de la edicion de cliente?") then
	          			appdata.failwithmessage -11888,"##EXIT##"
	          	  end if
      		</script>
        </action>
      </exit>
      <save show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          			if LB_MsgYesNo ("Desea salir almacenando los cambios?") then
          			   this("FECHA_VISITA")=left(this("FECHA_VISITA"),10) +" "+ this("MAP_HORAVISITA")
          			   this.save
          			   appdata.failwithmessage -11888,"##EXIT##"
          			end if
      		</script>
        </action>
      </save>
      <nuevopedido show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          			if LB_MsgYesNo ("Desea crear un pedido para este cliente?") then
						  set Coll=AppData.GetCollection("Pedidos_Menu")
						  set Item=Coll.CreateObject
					      Coll.AddItem(Item)
						  if not Item is nothing then
						    Item("IDCLIENTE")=this("ID")
		            		Item("IDRAZONSOCIAL")=this("IDRAZONSOCIAL")
		             		Item("MAP_LBCABECERA1")="INGAPAN Mobile CRM -  PEDIDOS ("+this("NOMBRE")+")"	
							Item("MAP_TABPED")=2		             		
							AppData.PushValue Item
						  end if
						  set Item=nothing
						  set Coll=nothing
          			end if
      		</script>
        </action>
      </nuevopedido>
      <limpiartipoalerta show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          	  this("MAP_IDTIPOALERTA")=0
          	  this("MAP_TIPOALERTA")=""
      		</script>
        </action>
      </limpiartipoalerta>
      <cerraralerta show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          	    if this("MAP_CERRADASEL")=0 then
          	          if this("MAP_IDALERTASEL")&gt;0 then
	          	         Msg="Desea cerrar la alerta seleccionada?"
	 					 Res=LB_MsgYesNo(Msg)
	  					 on error resume next
	                     if Res=True then
	                        LB_RunSQLRep "UPDATE GEN_ALERTAS SET COMENTARIO='"+this("MAP_COMENTARIOSEL")+"',CERRADA_SN=1 where ID="+cstr(this("MAP_IDALERTASEL"))
	                     end if
	                  else
	                    LB_msg "Debe seleccionar una alerta"
	                  end if
          	    end if
      		</script>
        </action>
      </cerraralerta>
      <filtraralertas show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		'Alpicamos filtro a menu de alertas
          		if this("MAP_FECHADESDE")&lt;&gt;"" and this("MAP_FECHAHASTA")&lt;&gt;"" then
          		    FiltrarContents "t1.CERRADA_SN="+cstr(this("MAP_CERRADA"))+" and t1.IDCLIENTE=##FLD_ID## and (t1.IDTIPOALERTA=##FLD_MAP_IDTIPOALERTA## or 0=##FLD_MAP_IDTIPOALERTA##) and date(t1.F_DESDE)=date(##FLD_MAP_FECHADESDE##) and date(t1.F_HASTA)=date(##FLD_MAP_FECHAHASTA##) and t1.COMENTARIO like '%"+cstr(this("MAP_COMENTARIO"))+"%' and(t1.ITX_BAJA=0 or t1.ITX_BAJA is null)","Alertas_Contents"
          		else
	          		if this("MAP_FECHAHASTA")&lt;&gt;"" then
	          		    FiltrarContents "t1.CERRADA_SN="+cstr(this("MAP_CERRADA"))+" and t1.IDCLIENTE=##FLD_ID## and (t1.IDTIPOALERTA=##FLD_MAP_IDTIPOALERTA## or 0=##FLD_MAP_IDTIPOALERTA##) and date(t1.F_HASTA)=date(##FLD_MAP_FECHAHASTA##) and t1.COMENTARIO like '%"+cstr(this("MAP_COMENTARIO"))+"%' and(t1.ITX_BAJA=0 or t1.ITX_BAJA is null)","Alertas_Contents"
	          		else
		          		if this("MAP_FECHADESDE")&lt;&gt;"" then
		          		    FiltrarContents "t1.CERRADA_SN="+cstr(this("MAP_CERRADA"))+" and t1.IDCLIENTE=##FLD_ID## and (t1.IDTIPOALERTA=##FLD_MAP_IDTIPOALERTA## or 0=##FLD_MAP_IDTIPOALERTA##) and date(t1.F_DESDE)=date(##FLD_MAP_FECHADESDE##) and t1.COMENTARIO like '%"+cstr(this("MAP_COMENTARIO"))+"%' and(t1.ITX_BAJA=0 or t1.ITX_BAJA is null)","Alertas_Contents"
		          		else
		          		    FiltrarContents "t1.CERRADA_SN="+cstr(this("MAP_CERRADA"))+" and t1.IDCLIENTE=##FLD_ID## and (t1.IDTIPOALERTA=##FLD_MAP_IDTIPOALERTA## or 0=##FLD_MAP_IDTIPOALERTA##) and t1.COMENTARIO like '%"+cstr(this("MAP_COMENTARIO"))+"%' and(t1.ITX_BAJA=0 or t1.ITX_BAJA is null)","Alertas_Contents"
		          		end if
					end if

			    end if
      		</script>
        </action>
      </filtraralertas>
    </coll>
    <coll name="Competencia_Basic" title="Competencia_Basic" sql="SELECT t1.ID,t1.COD,t1.NOMBRE     FROM ##PREF##Competencia t1" objname="Competencia" updateobj="Competencia" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="COD" visible="7" type="T" size="5" width="20%" labelwidth="0" />
      <prop group="1" name="NOMBRE" visible="7" type="T" size="30" width="70%" labelwidth="0" newline="false" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="ConceptosParte_Basic" title="ConceptosParte_Basic" sql="SELECT t1.*     FROM ##PREF##ConceptosParte t1" objname="ConceptosParte" updateobj="ConceptosParte" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="GRUPO" visible="0" type="T" size="20" />
      <prop group="1" name="CONCEPTO" visible="0" type="T" size="40" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="CondicionesCom_Basic" title="CondicionesCom_Basic" sql="SELECT t1.ID     FROM ##PREF##CondicionesCom t1" objname="CondicionesCom" updateobj="CondicionesCom" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDCLIENTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDARTICULO" visible="0" type="N" size="8" />
      <prop group="1" name="F_DESDE" visible="0" type="D" size="8" />
      <prop group="1" name="F_HASTA" visible="0" type="D" size="8" />
      <prop group="1" name="GRUPO" visible="0" type="T" size="20" />
      <prop group="1" name="DTO" visible="0" type="N2" size="8" />
      <prop group="1" name="ESTADO" visible="0" type="T" size="2" />
      <prop group="1" name="GGDTOTIP" visible="0" type="T" size="20" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="Condiciones_Contents" title="CondicionesCom_Basic" sql="SELECT t1.*,a.COD AS MAP_CODARTICULO,a.DESCRIP AS MAP_ARTICULO     FROM ##PREF##CondicionesCom t1      inner join ##PREF##Articulos a ON a.ID=t1.IDARTICULO" objname="CondicionesCom" updateobj="CondicionesCom" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDCLIENTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDARTICULO" visible="0" type="N" size="8" />
      <prop group="1" name="MAP_CODARTICULO" visible="7" type="T" size="5" width="40%" labelwidth="10" title="Articulo:" />
      <prop group="1" name="MAP_ARTICULO" visible="7" type="T" size="30" width="60%" labelwidth="0" newline="false" />
      <prop group="1" name="F_DESDE" visible="7" type="D" size="8" width="12%" labelwidth="10" title="Fch Desde/Hasta:" />
      <prop group="1" name="F_HASTA" visible="7" type="D" size="8" width="12%" labelwidth="0" newline="false" title="Fecha Hasta:" />
      <prop group="1" name="GRUPO" visible="7" type="T" size="20" width="9%" labelwidth="4" title="Grupo:" newline="false" />
      <prop group="1" name="DTO" visible="7" type="N2" size="8" width="8%" labelwidth="3" newline="false" title="Dto:" />
      <prop group="1" name="ESTADO" visible="7" type="T" size="2" width="8%" labelwidth="4" newline="false" title="Estado:" />
      <prop group="1" name="GGDTOTIP" visible="7" type="T" size="20" width="10%" labelwidth="4" newline="false" title="Tipo:" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="ConectarGPS" title="ConectarGPS" sql="SELECT t1.*       FROM ##PREF##empresa t1" objname="ConectarGPS" updateobj="ConectarGPS" progid="ASData.CASBasicDataObj" stringkey="true" idfieldname="ID" connection="transmision" loadall="false" withopen="true" useextdata="true" fontsize="9">
      <connection name="transmision" connstring="Provider=CGSoft Remote Provider;Data Source=127.0.0.1;Port=4242;ProgID=CGSSocketCE.ConnectCE" />
      <prop name="LONGITUD" visible="3" type="T" size="12" />
      <prop name="LATITUD" visible="3" type="T" size="12" />
      <prop name="ALTITUD" visible="3" type="T" size="12" />
      <prop name="RUMBO" visible="3" type="T" size="12" />
      <prop name="FGPS" visible="3" type="D" size="12" />
      <prop name="HGPS" visible="3" type="T" size="12" />
      <prop name="VELOCIDAD" visible="3" type="T" size="12" />
      <prop name="STATUS" visible="3" type="T" size="12" />
      <prop name="SATELITES" visible="3" type="N" size="12" />
    </coll>
    <coll name="Contactos_Basic" title="Contactos_Basic" sql="SELECT t1.*     FROM ##PREF##Contactos t1" objname="Contactos" updateobj="Contactos" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDTIPOCONTACTO" visible="0" type="N" size="8" />
      <prop group="1" name="IDRAZONSOCIAL" visible="0" type="N" size="8" />
      <prop group="1" name="NOMBRE" visible="7" type="T" size="40" width="100%" labelwidth="0" newline="false" />
      <prop group="1" name="TELEFONOS" visible="0" type="T" size="25" />
      <prop group="1" name="TELEFAX" visible="0" type="T" size="25" />
      <prop group="1" name="E_MAIL" visible="0" type="T" size="100" />
      <prop group="1" name="COMENTARIO" visible="0" type="T" size="400" />
      <prop group="1" name="HIST_SN" visible="0" type="N" size="1" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <selecteditem>
        <action name="runscript">
          <script language="VBScript">

            ui.msgbox "  Contacto: "+cstr(this("NOMBRE"))+chr(10)+chr(13)+" Telefonos: "+cstr(this("TELEFONOS"))+chr(10)+chr(13)+" Fax: "+cstr(this("TELEFAX"))+chr(10)+chr(13)+" Email: "+cstr(this("E_MAIL"))+chr(10)+chr(13)+" Comentario: "+cstr(this("COMENTARIO"))+chr(10)+chr(13),"DATOS CONTACTO",0
	   </script>
        </action>
      </selecteditem>
    </coll>
    <coll name="Datos_Mapa" title="mapa" sql="SELECT t1.ID,t1.NOMBRE,t1.XLATITUD,t1.XLONGITUD,'bt-gps-black.png' AS MARKERICON     FROM ##PREF##Clientes t1      " objname="Clientes" updateobj="Clientes" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="XLATITUD" visible="7" type="N6" fieldsize="10" mapview-latitude="true" showmap-latitud="true" />
      <prop group="1" name="XLONGITUD" visible="7" type="N6" fieldsize="10" mapview-longitude="true" showmap-longitud="true" />
      <prop group="1" name="NOMBRE" type="T" size="250" visible="0" mapview-description="true" mapview-address="true" />
    </coll>
    <coll name="Direcciones_Basic" title="Direcciones_Basic" sql="SELECT t1.*     FROM ##PREF##Direcciones t1" objname="Direcciones" updateobj="Direcciones" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDPAIS" visible="0" type="N" size="8" />
      <prop group="1" name="IDPROVINCIA" visible="0" type="N" size="8" />
      <prop group="1" name="IDRAZONSOCIAL" visible="0" type="N" size="8" />
      <prop group="1" name="COD" visible="0" type="T" size="6" />
      <prop group="1" name="NOMBRE" visible="7" type="T" size="40" width="100%" labelwidth="0" newline="false" />
      <prop group="1" name="DIR" visible="0" type="T" size="80" />
      <prop group="1" name="COD_POSTAL" visible="0" type="T" size="10" />
      <prop group="1" name="TELEFONOS" visible="0" type="T" size="25" />
      <prop group="1" name="TELEFAX" visible="0" type="T" size="25" />
      <prop group="1" name="POBLACION" visible="0" type="T" size="40" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <selecteditem>
        <action name="runscript">
          <script language="VBScript">
            ui.msgbox "  Nombre: "+this("NOMBRE")+chr(10)+chr(13)+" Telefonos: "+this("TELEFONOS")+chr(10)+chr(13)+" Fax: "+this("TELEFAX")+chr(10)+chr(13)+" Poblacion: "+this("POBLACION")+" "+this("COD_POSTAL")+chr(10)+chr(13)+" Dir: "+this("DIR")+chr(10)+chr(13),"DATOS DIRECCION",0
	   </script>
        </action>
      </selecteditem>
    </coll>
    <coll name="DocumentosXUsuario_Basic" title="DocumentosXUsuario_Basic" sql="SELECT t1.ID     FROM ##PREF##DocumentosXUsuario t1" objname="DocumentosXUsuario" updateobj="DocumentosXUsuario" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" type="N" visible="0" />
      <prop group="1" name="IDDOCUMENTO" type="N" visible="0" />
      <prop group="1" name="IDUSUARIO" type="N" visible="0" />
    </coll>
    <coll name="Documentos_Basic" title="Documentos_Basic" sql="SELECT t1.ID,t1.PATH    FROM ##PREF##Documentos t1" objname="Documentos" updateobj="Documentos" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="ID_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDTIPODOC" visible="0" type="N" size="8" />
      <prop group="1" name="MARCA" visible="0" type="T" size="20" />
      <prop group="1" name="DESCRIP" visible="0" type="T" size="40" />
      <prop group="1" name="PATH" visible="0" type="T" size="60" />
      <prop group="1" name="ACTIVO" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="Documentos_Contents" title="Documentos_Basic" sql="SELECT t1.*     FROM ##PREF##Documentos t1 INNER JOIN ##PREF##TiposDoc t2 ON t1.IDTIPODOC=t2.ID" objname="Documentos" updateobj="Documentos" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="ID_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDTIPODOC" visible="0" type="N" size="8" />
      <prop group="1" name="MARCA" visible="0" type="T" size="20" />
      <prop group="1" name="DESCRIP" visible="7" type="T" size="30" width="50%" labelwidth="0" />
      <prop group="1" name="PATH" visible="7" type="T" size="30" width="50%" labelwidth="0" newline="false" />
      <prop group="1" name="ACTIVO" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <selecteditem>
        <action name="runscript">
          <script language="VBScript">
			if appdata.CurrentEnterprise.variables("PLATFORM")="IOS" then
            	ui.Openfile replace("http://212.170.61.117:8080/replicadocs/"+this("PATH"),"\","/")
            else
            	ui.Openfile replace("http://212.170.61.117:8080/replicadocs/"+this("PATH"),"\","/"),"cache"
            end if
	   </script>
        </action>
      </selecteditem>
    </coll>
    <coll name="Empresas" title="la empresa" sql="SELECT t1.*        FROM ##PREF##Empresa t1" shadow="false" objname="Empresa" updateobj="Empresa" progid="ASGestion.CASEmpresa" fontsize="9" nomenmask="8" editwidth="101" editheight="97" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="CODIGO" visible="3" type="T" fieldsize="4" autosearch="true" />
      <prop group="1" name="NOMBRE" visible="3" type="T" fieldsize="4" autosearch="true" />
      <include file="general.vbs" language="vbscript" />
      <include file="menu.vbs" language="vbscript" />
      <include file="agenda.vbs" language="vbscript" />
      <include file="pedidos.vbs" language="vbscript" />
      <include file="partes.vbs" language="vbscript" />
      <include file="estadisticas.vbs" language="vbscript" />
      <onlogon>
        <action name="On" type="runscript">
          <script language="VBScript">
						CargaOnLogon
					</script>
        </action>
      </onlogon>
      <replica-ok-gen_alertas>
        <action name="runscript">
          <script language="VBScript">
			ui.ShowNotification 1, "Aviso", "Tiene nuevas alertas"
		</script>
        </action>
      </replica-ok-gen_alertas>
    </coll>
    <coll name="Estadisticas_Basic" title="Estadisticas_Basic" sql="SELECT t1.*     FROM ##PREF##Estadisticas t1" objname="Estadisticas" updateobj="Estadisticas" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDARTICULO" visible="0" type="N" size="8" />
      <prop group="1" name="IDCLIENTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDRAZONSOCIAL" visible="0" type="N" size="8" />
      <prop group="1" name="GGALBTIP_COD" visible="0" type="T" size="8" />
      <prop group="1" name="N_ALBARAN" visible="0" type="N" size="8" />
      <prop group="1" name="N_LIN" visible="0" type="T" size="4" />
      <prop group="1" name="F_ALBARAN" visible="0" type="D" size="8" />
      <prop group="1" name="GAUNITIP_UNI1" visible="0" type="T" size="4" />
      <prop group="1" name="GAUNITIP_UNI2" visible="0" type="T" size="4" />
      <prop group="1" name="C_UNI1" visible="0" type="N2" size="4" />
      <prop group="1" name="C_UNI2" visible="0" type="N2" size="4" />
      <prop group="1" name="I_NETOEMP" visible="0" type="N2" size="5" />
      <prop group="1" name="I_LINEMP" visible="0" type="N2" size="30" />
      <prop group="1" name="PR_PRECIO" visible="0" type="N2" size="8" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="Estadisticas_Contents" fontsize="10" title="Estadisticas_Basic" sql="SELECT t1.*,a.DESCRIP AS MAP_ARTICULO,a.GAUNITIP_UNI1 AS MAP_GAUNITIP_UNI1,a.GAUNITIP_UNI2 AS MAP_GAUNITIP_UNI2     FROM ##PREF##Estadisticas t1 inner join ##PREF##Articulos a ON a.ID=t1.IDARTICULO" objname="Estadisticas" updateobj="Estadisticas" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDARTICULO" visible="0" type="N" size="8" />
      <prop group="1" name="IDCLIENTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDRAZONSOCIAL" visible="0" type="N" size="8" />
      <prop group="1" name="GGALBTIP_COD" visible="0" type="T" size="8" />
      <prop group="1" name="F_ALBARAN" visible="0" type="D" size="8" />
      <prop group="1" name="GAUNITIP_UNI1" visible="0" type="T" size="4" />
      <prop group="1" name="GAUNITIP_UNI2" visible="0" type="T" size="4" />
      <prop group="1" name="C_UNI1" visible="0" type="N2" size="4" />
      <prop group="1" name="I_NETOEMP" visible="0" type="N2" size="5" />
      <prop group="1" name="I_LINEMP" visible="0" type="N2" size="30" />
      <prop group="1" name="PR_PRECIO" visible="0" type="N2" size="8" />
      <prop group="1" name="N_ALBARAN" visible="7" type="T" size="5" width="10%" labelwidth="0" fontsize="10" />
      <prop group="1" name="N_LIN" visible="7" type="T" size="30" width="5%" labelwidth="0" newline="false" fontsize="10" />
      <prop group="1" name="MAP_ARTICULO" visible="7" type="T" size="4" width="55%" labelwidth="0" newline="false" fontsize="10" />
      <prop group="1" name="MAP_GAUNITIP_UNI2" visible="7" type="T" size="4" width="10%" labelwidth="0" newline="false" fontsize="10" />
      <prop group="1" name="C_UNI2" visible="7" type="N2" size="4" width="10%" labelwidth="0" newline="false" fontsize="10" />
      <prop group="1" name="MAP_SEL" visible="7" type="NC" size="30" width="5%" labelwidth="0" newline="false" fontsize="10" onchange="refresh" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <selecteditem show-wait-dialog="false" refresh="false">
        <action name="runscript">
          <script language="VBScript">
		           if this("MAP_SEL")=0 then
		             this("MAP_SEL")=1
		           else
		              this("MAP_SEL")=0
		           end if
		        'Refresca el grid modificado.
		        ui.RefreshContentSelectedRow "Estadisticas_Contents"
		        
		        'refreshcontentrow "nombreprop", nID    'refresca la fila especifica del content que le digas
		   </script>
        </action>
      </selecteditem>
    </coll>
    <coll name="Estadisticas_Contents2" fontsize="10" title="Estadisticas_Basic" sql="SELECT t1.*,a.DESCRIP AS MAP_ARTICULO,a.GAUNITIP_UNI1 AS MAP_GAUNITIP_UNI1,a.GAUNITIP_UNI2 AS MAP_GAUNITIP_UNI2,c.NOMBRE AS MAP_CLIENTE FROM ##PREF##Estadisticas t1 inner join ##PREF##Articulos a ON a.ID=t1.IDARTICULO inner join ##PREF##Clientes c ON c.ID=t1.IDCLIENTE" objname="Estadisticas" updateobj="Estadisticas" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDARTICULO" visible="0" type="N" size="8" />
      <prop group="1" name="IDCLIENTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDRAZONSOCIAL" visible="0" type="N" size="8" />
      <prop group="1" name="GAUNITIP_UNI1" visible="0" type="T" size="4" />
      <prop group="1" name="GAUNITIP_UNI2" visible="0" type="T" size="4" />
      <prop group="1" name="C_UNI1" visible="0" type="N2" size="4" />
      <prop group="1" name="I_NETOEMP" visible="0" type="N2" size="5" />
      <prop group="1" name="I_LINEMP" visible="0" type="N2" size="30" />
      <prop group="1" name="PR_PRECIO" visible="0" type="N2" size="8" />
      <prop group="1" name="MAP_CLIENTE" visible="7" type="T" size="5" width="15%" labelwidth="0" fontsize="10" />
      <prop group="1" name="N_ALBARAN" visible="7" type="T" size="5" width="10%" labelwidth="0" fontsize="10" newline="false" />
      <prop group="1" name="F_ALBARAN" visible="7" type="T" size="5" width="25%" labelwidth="0" fontsize="10" newline="false" />
      <prop group="1" name="GGALBTIP_COD" visible="7" type="T" size="5" width="5%" labelwidth="0" fontsize="10" newline="false" />
      <prop group="1" name="N_LIN" visible="7" type="T" size="30" width="5%" labelwidth="0" newline="false" fontsize="10" />
      <prop group="1" name="MAP_ARTICULO" visible="7" type="T" size="4" width="20%" labelwidth="0" newline="false" fontsize="10" />
      <prop group="1" name="MAP_GAUNITIP_UNI2" visible="7" type="T" size="4" width="10%" labelwidth="0" newline="false" fontsize="10" />
      <prop group="1" name="C_UNI2" visible="7" type="N2" size="4" width="10%" labelwidth="0" newline="false" fontsize="10" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <selecteditem show-wait-dialog="false" refresh="false">
        <action name="runscript">
          <script language="VBScript" />
        </action>
      </selecteditem>
    </coll>
    <coll name="Familias" title="Familias" stringkey="true" idfieldname="FAMILIA" userawsql="true" sql="select distinct(t1.FAMILIA) from gen_articulos t1 " objname="Articulos" updateobj="Articulos" progid="ASData.CASBasicDataObj" filter="t1.FAMILIA is not null" sort="t1.FAMILIA ASC">
      <group name="General" id="1" />
      <prop group="1" name="FAMILIA" visible="7" type="T" size="30" width="100%" labelwidth="0" qualifier="t1.FAMILIA" />
    </coll>
    <coll name="Ficheros0" fontsize="8" title="ReplicaFiles" objname="master_replica_files" updateobj="master_replica_files" progid="ASData.CASBasicDataObj" sql="SELECT *                   FROM ##PREF##master_replica_files" filter="STATUS!=201 AND REPLICATYPE=1" cell-bgcolor="#FFFFFF" cell-height="50" show-selected-item="false" check-owner="false" dependent="false" connection="Info_ReplicaFiles" loadall="false" show-toolbar="true" editmask="8">
      <connection prefix="" name="Info_ReplicaFiles" connstring="Provider=Xone Remote Provider;Data Source=local;ProgID=com.xone.db.impl.replicafiles.RplFilesConnection;Timeout=60" />
      <group name="General" id="1" />
      <prop group="1" name="FILENAME" wrap="true" visible="0" fieldsize="10" type="T" size="20" />
    </coll>
    <coll name="Gamas" title="Gamas" stringkey="true" idfieldname="GAMA" sql="select distinct(t1.GAMA)  from gen_articulos t1 " objname="Articulos" updateobj="Articulos" progid="ASData.CASBasicDataObj" filter="t1.GAMA is not null" sort="t1.GAMA ASC">
      <group name="General" id="1" />
      <prop group="1" name="GAMA" visible="7" type="T" size="30" width="100%" labelwidth="0" qualifier="t1.GAMA" />
    </coll>
    <coll name="LineasParte_Basic" title="LineasParte_Basic" sql="SELECT t1.ID     FROM ##PREF##LineasParte t1" objname="LineasParte" updateobj="LineasParte" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDPARTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDCONCEPTO" visible="0" type="N" size="8" />
      <prop group="1" name="INV_FECHA" visible="0" type="D" size="8" />
      <prop group="1" name="INV_QUIEN" visible="0" type="T" size="50" />
      <prop group="1" name="KM_SALIDA" visible="0" type="N" size="8" />
      <prop group="1" name="KM_LLEGADA" visible="0" type="N" size="8" />
      <prop group="1" name="LOCALIDAD" visible="0" type="T" size="40" />
      <prop group="1" name="TARJETA" visible="0" type="T" size="1" />
      <prop group="1" name="IMPORTE" visible="0" type="N2" size="4" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="Lineas_Parte_Contents" title="LineasParte_Basic" sql="SELECT t1.*,t2.CONCEPTO AS MAP_CONCEPTO     FROM ##PREF##LineasParte t1      INNER JOIN ##PREF##ConceptosParte t2 ON t1.IDCONCEPTO=t2.ID" objname="LineasParte" updateobj="LineasParte" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDPARTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDCONCEPTO" visible="0" type="N" size="8" />
      <prop group="1" name="INV_QUIEN" visible="0" type="T" size="50" />
      <prop group="1" name="KM_SALIDA" visible="0" type="N" size="8" />
      <prop group="1" name="KM_LLEGADA" visible="0" type="N" size="8" />
      <prop group="1" name="TARJETA" visible="0" type="T" size="1" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <prop group="1" name="MAP_CONCEPTO" visible="7" type="T" size="40" width="35%" title="Comentario" labelwidth="0" />
      <prop group="1" name="INV_FECHA" visible="7" type="D" size="40" width="20%" title="Fecha" labelwidth="0" newline="false" />
      <prop group="1" name="LOCALIDAD" visible="7" type="T" size="40" width="30%" title="Localidad" labelwidth="0" newline="false" />
      <prop group="1" name="IMPORTE" visible="7" type="N2" size="40" width="15%" title="Importe" labelwidth="0" newline="false" />
      <selecteditem>
        <action name="runscript">
          <script language="VBScript">
       
		           if not this.ownercollection.ownerobject is nothing then
		             this.ownercollection.ownerobject("MAP_IDLINEAPARTESEL")=this("ID")
		           end if
		   </script>
        </action>
      </selecteditem>
    </coll>
    <coll name="Lineas_Parte_Editar" title="LineasParte_Basic" sql="SELECT t1.*,t2.CONCEPTO AS MAP_CONCEPTO,CASE WHEN t1.TARJETA=1 then 'Tarjeta' else 'Efectivo' end AS MAP_TARJETA     FROM ##PREF##LineasParte t1      INNER JOIN ##PREF##ConceptosParte t2 ON t1.IDCONCEPTO=t2.ID" objname="LineasParte" updateobj="LineasParte" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <frame name="frm_cabecera" width="100%" height="7%" scroll="false" orientation="top" bgcolor="#094c9b,#05264e" />
      <prop group="1" frame="frm_cabecera" name="MAP_ICON1" visible="1" type="B" width="5%" labelwidth="0" icon="icon.png" method="Executenode(menu0)" locked="true" />
      <prop group="1" frame="frm_cabecera" name="MAP_CABECERA" visible="1" type="TL" class="labelcab" title="INGAPAN Mobile CRM - Nueva linea parte" />
      <prop group="1" frame="frm_cabecera" name="MAP_LABELCABECERA" type="T" visible="0" />
      <frame name="frm_datos" height="77%" width="100%" />
      <prop group="1" frame="frm_datos" name="ID" type="N" visible="0" />
      <prop group="1" frame="frm_datos" name="IDPARTE" visible="0" type="N" size="8" />
      <prop group="1" frame="frm_datos" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" frame="frm_datos" name="IDCONCEPTO" visible="0" type="N" size="8" mapcol="ConceptosParte_Basic" mapfld="ID" onchange="refresh" />
      <prop group="1" frame="frm_datos" name="KM_SALIDA" visible="0" type="N" size="8" />
      <prop group="1" frame="frm_datos" name="KM_LLEGADA" visible="0" type="N" size="8" />
      <prop group="1" frame="frm_datos" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" frame="frm_datos" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" frame="frm_datos" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" frame="frm_datos" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" frame="frm_datos" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <prop group="1" frame="frm_datos" name="MAP_LBLINEAPARTE" visible="1" type="TL" class="label2" width="25%" title="Datos Linea " tmargin="2" />
      <prop group="1" frame="frm_datos" name="MAP_CONCEPTO" visible="7" type="T" size="40" width="95%" tmargin="4" onchange="refresh" title="Concepto" labelwidth="8" linkedto="IDCONCEPTO" linkedfield="CONCEPTO" />
      <prop group="1" frame="frm_datos" name="INV_QUIEN" visible="7" type="T" size="40" width="95%" disablevisible="MAP_GRUPO='' or MAP_GRUPO&lt;&gt;'INVITACION'" tmargin="2" title="Invitado" labelwidth="8" />
      <prop group="1" frame="frm_datos" name="MAP_GRUPO" visible="0" type="T" size="40" width="95%" tmargin="4" title="Concepto" labelwidth="8" linkedto="IDCONCEPTO" linkedfield="GRUPO" />
      <prop group="1" frame="frm_datos" name="INV_FECHA" visible="7" type="D" size="40" width="95%" tmargin="2" title="Fecha" labelwidth="8" />
      <prop group="1" frame="frm_datos" name="LOCALIDAD" visible="7" type="T" size="40" width="95%" tmargin="2" title="Localidad" labelwidth="8" />
      <prop group="1" frame="frm_datos" name="MAP_IDTARJETA" visible="0" type="N" size="8" mapcol-values="Efectivo,Tarjeta" mapfld="ID" onchange="refresh255" />
      <prop group="1" frame="frm_datos" name="MAP_TARJETA" visible="1" type="T" linkedto="MAP_IDTARJETA" linkedfield="DATA" size="40" width="45%" title="Tarjeta: " labelwidth="8" tmargin="2" />
      <prop group="1" frame="frm_datos" name="TARJETA" visible="0" type="N" />
      <prop group="1" frame="frm_datos" name="IMPORTE" visible="7" type="N2" size="40" width="45%" tmargin="2" title="Importe" labelwidth="8" newline="false" />
      <!-- ## Frame botones edicion## -->
      <frame name="frm_barrabotones" width="100%" height="10%" scroll="false" bgcolor="#fefefe,#bbbcbe" align="center" framebox="true" border-width="3" />
      <prop group="1" frame="frm_barrabotones" name="MAP_BT1" visible="1" type="B" class="botonmenu" icon="bt_back_black.png" onchange="refresh" method="Executenode(exit)" title="" />
      <prop group="1" frame="frm_barrabotones" name="MAP_BT2" visible="1" type="B" class="botonmenu" newline="false" lmargin="2" icon="bt-okbox-black.png" onchange="refresh255" method="Executenode(salvar)" title="" />
      <!-- ## Frame Bara Estado## -->
      <frame name="frm_barraestado" width="100%" height="6%" scroll="false" bgcolor="#05264e" align="right" orientation="bottom" />
      <prop group="1" frame="frm_barraestado" name="MAP_DATOSESTADO" visible="0" type="T" />
      <prop group="1" frame="frm_barraestado" name="MAP_LBESTADO" visible="1" type="TL" class="labelestado" title="##FLD_MAP_DATOSESTADO##" tmargin="2" />
      <create>
        <action name="setval" field="INV_FECHA" value="##NOW_TIME##" />
        <action name="setval" field="IDEMPRESA" value="##ENTID##" />
        <action name="runscript">
          <script language="VBScript">   
				'Cargamos datos de barra de estado
				this("MAP_DATOSESTADO")=CargarBarraEstado()				
          </script>
        </action>
      </create>
      <exit show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
                  if LB_MsgYesNo ("Desea salir de la edicion de la linea de parte?") then
	          			appdata.failwithmessage -11888,"##EXIT##"
	          	  end if
      		</script>
        </action>
      </exit>
      <onback show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript" />
        </action>
      </onback>
      <salvar show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		  SalvarLineaParte
      		</script>
        </action>
      </salvar>
    </coll>
    <coll name="LogonColl" nomenmask="16" title="Inicio" login-coll="true" fontsize="8" progid="ASData.CASBasicDataObj" sql="SELECT n.*                FROM ##PREF##Usuarios n" objname="Usuarios" updateobj="Usuarios" autorefresh="true" notab="true" disabled-buttonok="true" nostopreplica="true">
      <group name="Login" id="1" xscrollbar="false" />
      <frame name="cabecera" width="100%" height="8%" scroll="false" bgcolor="#094c9b,#05264e" />
      <prop group="1" frame="cabecera" name="MAP_ICON1" visible="1" type="B" width="5%" labelwidth="0" icon="icon.png" method="Executenode(menu0)" locked="true" />
      <prop group="1" frame="cabecera" name="MAP_CABECERA" visible="1" type="TL" class="labelcab" title="INGAPAN Mobile CRM" />
      <frame name="logo" width="100%" height="32%" scroll="false" bgcolor="#FFFFFF" align="center" />
      <prop group="1" frame="logo" name="MAP_PATH1" visible="1" type="IMG" labelwidth="0" height="100%" align="center" path="##FLD_MAP_IMG##" locked="true" locking="true" />
      <prop group="1" name="MAP_IDUSUARIO" type="N" visible="0" mapcol="Usuarios" mapfld="ID" fieldsize="4" size="4" />
      <frame name="datos" width="100%" height="54%" scroll="false" />
      <prop group="1" frame="datos" name="MAP_LOGIN" visible="0" type="T" linkedto="MAP_IDUSUARIO" linkedfield="LOGIN" />
      <prop group="1" frame="datos" name="MAP_LBSESION" visible="1" type="TL" class="label2" width="25%" fontsize="18" title="Inicie Sesin" forecolor="#000000" tmargin="4" />
      <prop group="1" frame="datos" name="MAP_LBUSUARIO" visible="1" type="TL" class="label2" tmargin="2" width="25%" title="Usuario:" forecolor="#000000" lmargin="2" />
      <prop group="1" frame="datos" name="MAP_USUARIO" visible="1" type="T" class="prop2" tmargin="2" fontsize="16" linkedto="MAP_IDUSUARIO" linkedfield="NOMBRE" title="USUARIO" showinline="true" width="60%" labelwidth="0" size="150" newline="false" onchange="Refresh" fieldsize="18" text-border="true" bgcolor="#EBEBEB" />
      <prop group="1" frame="datos" name="MAP_LBPWD" visible="1" type="TL" class="label2" tmargin="2" width="25%" title="Pasword:" forecolor="#000000" lmargin="2" />
      <prop group="1" frame="datos" name="MAP_PWD" visible="1" type="X" class="prop2" tmargin="2" fontsize="16" xhash-type="MD5" width="60%" labelwidth="0" size="150" newline="false" onchange="Refresh" fieldsize="18" text-border="true" bgcolor="#EBEBEB" />
      <prop group="1" frame="datos" name="MAP_OS" type="T" visible="0" fieldsize="8" />
      <prop group="1" frame="datos" type="B" visible="1" tmargin="8" class="boton1" name="Acceder" caption="Acceder" bgcolor="#009933" onchange="Refresh255" lmargin="2" method="ExecuteNode (click-entrar)" />
      <prop group="1" frame="datos" type="B" visible="1" tmargin="8" class="boton1" name="Cancelar" caption="Cancelar" bgcolor="#EBEBEB" onchange="Refresh255" newline="false" lmargin="1" method="ExecuteNode (click-cancelar)" />
      <prop group="1" name="MAP_IMG" type="T" visible="0" />
      <prop group="1" name="MAP_VERSIONAPP" visible="0" type="T" />
      <prop group="1" name="MAP_VERSIONFRAME" visible="0" type="T" />
      <prop group="1" name="MAP_VERSIONXONELIVE" visible="0" type="T" />
      <prop group="1" name="MAP_MID" type="T" visible="0" />
      <prop group="1" name="MAP_IMEI" type="T" visible="0" />
      <prop group="1" name="MAP_PLATFORM" type="T" visible="0" />
      <prop group="1" name="MAP_DISPOSITIVO" type="T" visible="0" />
      <prop group="1" name="MAP_MINIMA_VERSION_BD" type="N" visible="0" />
      <prop group="1" name="MAP_MINIMA_VERSION_FRAMEWORK_AND" type="N" visible="0" />
      <prop group="1" name="MAP_MINIMA_VERSION_FRAMEWORK_IOS" type="N" visible="0" />
      <frame name="barraestado" width="100%" height="6%" scroll="false" bgcolor="#05264e" orientation="botton" />
      <prop group="1" frame="barraestado" name="MAP_LBESTADO" visible="1" type="TL" class="labelestado" title="##FLD_MAP_DATOSESTADO##" lmargin="30%" tmargin="2" width="60%" />
      <prop group="1" name="MAP_DATOSESTADO" visible="0" type="T" />
      <method name="ExecuteNode">
        <param name="P1" type="T" upper="true" value="" />
      </method>
      <create>
        <!---->
        <!---->
        <!---->
        <action name="setval" field="MAP_MINIMA_VERSION_BD" value="2" />
        <action name="setval" field="MAP_MINIMA_VERSION_FRAMEWORK_AND" value="4000" />
        <action name="setval" field="MAP_MINIMA_VERSION_FRAMEWORK_IOS" value="3441" />
        <action name="setval" field="MAP_PWD" value="" />
        <action name="setval" field="MAP_VERSIONAPP" value="##VERSION##" />
        <action name="setval" field="MAP_VERSIONFRAME" value="##FRAME_VERSION##" />
        <action name="setval" field="MAP_MID" value="##MID##" />
        <action name="setval" field="MAP_IMEI" value="##DEVICEID##" />
        <action name="setval" field="MAP_VERSIONXONELIVE" value="##LIVEUPDATE_VERSION##" />
        <action name="setval" field="MAP_DISPOSITIVO" value="##DEVICE_MODEL##" />
        <action name="setval" field="MAP_OS" value="##DEVICE_OSSDKCODE##" />
        <action name="setval" field="MAP_PLATFORM" value="##DEVICE_OS##" />
        <action name="setval" field="MAP_IMG" value="..\icons\ingapan_login.png" />
        <action name="runscript">
          <script language="VBScript">   
          	  this("MAP_DATOSESTADO")="IMEI: "+this("MAP_IMEI")+"    Terminal: "+replace(this("MAP_MID"),"'","")+"    VersionApp: "+this("MAP_VERSIONAPP")+"    Framework: "+this("MAP_VERSIONFRAME")+"    XoneLive: "+this("MAP_VERSIONXONELIVE")+"    BD: "+this("MAP_MINIMA_VERSION_BD") 
          </script>
        </action>
      </create>
      <click-entrar>
        <action name="runscript">
          <script language="VBScript">
				ClickEntrar
		  </script>
        </action>
      </click-entrar>
      <click-cancelar>
        <action name="runscript">
          <script language="VBScript">
						appdata.failwithmessage -11888,"##EXITAPP##"
					</script>
        </action>
      </click-cancelar>
      <login-ok>
        <action name="runscript">
          <script language="VBScript">
						'  Vamos a cargar algunas variables globales

					</script>
        </action>
      </login-ok>
      <login-fail>
        <action name="runscript">
          <script language="VBScript">
						appdata.failwithmessage -8100,"Usuario o clave no validos"
					</script>
        </action>
      </login-fail>
    </coll>
    <coll name="Mapas" title="Mapas" sql="SELECT t1.ID,t1.COD,t1.NOMBRE,t1.F_PAGO,t1.TARIFA     FROM ##PREF##Clientes t1" objname="Clientes" updateobj="Clientes" progid="ASData.CASBasicDataObj" filter="" sort="">
      <!-- ##### GRUPO GENERAL DE DATOS CLIENTE##### -->
      <group name="general" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <!-- ## Frame Cabecera Datos Cliente## -->
      <frame name="frm_cabecera" width="100%" height="7%" scroll="false" orientation="top" bgcolor="#094c9b,#05264e" />
      <prop group="1" frame="frm_cabecera" name="MAP_ICON1" visible="1" type="B" width="5%" labelwidth="0" icon="icon.png" method="Executenode(menu0)" locked="true" />
      <prop group="1" frame="frm_cabecera" name="MAP_CABECERA" visible="1" type="TL" class="labelcab" title="##FLD_MAP_LABELCABECERA##" />
      <prop group="1" frame="frm_cabecera" name="MAP_LABELCABECERA" type="T" visible="0" />
      <frame name="frm_mapa" height="87%" width="100%" />
      <prop group="1" frame="frm_mapa" name="MAP_MAPA" title=" " type="Z" visible="1" width="100%" height="100%" viewmode="mapview" mapview-embedded="true" contents="MAPA" text-border="false" border="false" bgcolor="#00000000" mask="2" img="bt-gps-black.png" imgsel="bt-gps-black.png" />
      <contents name="MAPA" src="Datos_Mapa" filter="t1.ID=##FLD_ID##" />
      <!-- ## Frame Bara Estado## -->
      <frame name="frm_barraestado" width="100%" height="6%" scroll="false" bgcolor="#05264e" align="right" orientation="bottom" />
      <prop group="1" frame="frm_barraestado" name="MAP_DATOSESTADO" visible="0" type="T" />
      <prop group="1" frame="frm_barraestado" name="MAP_LBESTADO" visible="1" type="TL" class="labelestado" title="##FLD_MAP_DATOSESTADO##" tmargin="2" />
      <prop group="1" frame="frm_barraestado" type="B" visible="1" class="boton3" name="exit" img="bt_back_white.png" newline="false" bgcolor="#009933" onchange="Refresh255" lmargin="1" method="ExecuteNode (exit)" width="4%" />
      <before-edit show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">   
				'Cargamos datos de barra de estado
				this("MAP_DATOSESTADO")=CargarBarraEstado()	
				this("MAP_LABELCABECERA")="INGAPAN Mobile CRM  -  Posicionamiento / Mapa"
          </script>
        </action>
      </before-edit>
      <exit show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
                 
	          			appdata.failwithmessage -11888,"##EXIT##"
	          	 
      		</script>
        </action>
      </exit>
    </coll>
    <coll name="Marcas" title="Marcas" stringkey="true" idfieldname="MARCA" userawsql="true" sql="select distinct(t1.MARCA) from gen_articulos t1 " objname="Articulos" updateobj="Articulos" progid="ASData.CASBasicDataObj" filter="t1.MARCA is not null" sort="t1.MARCA ASC">
      <group name="General" id="1" />
      <prop group="1" name="MARCA" visible="7" type="T" size="30" width="100%" labelwidth="0" qualifier="t1.MARCA" />
    </coll>
    <coll name="MenuPrincipal" title="el MenuPrincipal" sql="SELECT t1.ID, from gen_empresa" special="true" progid="ASGestion.CASUser" fixed-group="0">
      <group name="fixed" fixed="true" id="0" width="100%" height="16%" orientation="bottom" />
      <!-- ## Frame barra de botones de menu ## -->
      <frame name="frm_barrabotones" width="100%" height="63%" scroll="false" bgcolor="#fefefe,#bbbcbe" align="center" framebox="true" border-width="3" xforecolor="#ffda6b" />
      <prop group="0" frame="frm_barrabotones" name="MAP_BT1" visible="1" type="B" class="botonmenu" icon="##FLD_MAP_BTIMG1##" align="center" refresh="false" onchange="refresh" method="Executenode(menu(1))" />
      <prop group="0" frame="frm_barrabotones" name="MAP_BT2" visible="1" type="B" class="botonmenu" newline="false" lmargin="2" icon="##FLD_MAP_BTIMG2##" refresh="false" onchange="refresh" method="Executenode(menu(2))" />
      <prop group="0" frame="frm_barrabotones" name="MAP_BT3" visible="1" type="B" class="botonmenu" newline="false" lmargin="2" icon="##FLD_MAP_BTIMG3##" refresh="false" onchange="refresh" method="Executenode(menu(3))" />
      <prop group="0" frame="frm_barrabotones" name="MAP_BT4" visible="1" type="B" class="botonmenu" newline="false" lmargin="2" icon="##FLD_MAP_BTIMG4##" refresh="false" onchange="refresh" method="Executenode(menu(4))" />
      <prop group="0" frame="frm_barrabotones" name="MAP_BT5" visible="1" type="B" class="botonmenu" newline="false" lmargin="2" icon="##FLD_MAP_BTIMG5##" refresh="false" onchange="refresh" method="Executenode(menu(5))" />
      <prop group="0" frame="frm_barrabotones" name="MAP_BT6" visible="1" type="B" class="botonmenu" newline="false" lmargin="2" icon="##FLD_MAP_BTIMG6##" refresh="false" onchange="refresh" method="Executenode(menu(6))" />
      <prop group="0" frame="frm_barrabotones" name="MAP_BT7" visible="1" type="B" class="botonmenu" newline="false" lmargin="2" icon="##FLD_MAP_BTIMG7##" refresh="false" onchange="refresh" method="Executenode(menu(7))" />
      <prop group="0" frame="frm_barrabotones" name="MAP_BT8" visible="1" type="B" class="botonmenu" newline="false" lmargin="2" icon="##FLD_MAP_BTIMG8##" refresh="false" onchange="refresh" method="Executenode(menu(8))" />
      <prop group="0" frame="frm_barrabotones" name="MAP_LBBT1" visible="1" type="TL" class="labelbotonmenu" title="Agenda" align="center" />
      <prop group="0" frame="frm_barrabotones" name="MAP_LBBT2" visible="1" type="TL" class="labelbotonmenu" title="Clientes" align="center" lmargin="2" newline="false" />
      <prop group="0" frame="frm_barrabotones" name="MAP_LBBT3" visible="1" type="TL" class="labelbotonmenu" title="Estadist." align="center" lmargin="2" newline="false" />
      <prop group="0" frame="frm_barrabotones" name="MAP_LBBT4" visible="1" type="TL" class="labelbotonmenu" title="Pedidos" align="center" lmargin="2" newline="false" />
      <prop group="0" frame="frm_barrabotones" name="MAP_LBBT5" visible="1" type="TL" class="labelbotonmenu" title="Partes" align="center" lmargin="2" newline="false" />
      <prop group="0" frame="frm_barrabotones" name="MAP_LBBT6" visible="1" type="TL" class="labelbotonmenu" title="Docs." align="center" lmargin="2" newline="false" />
      <prop group="0" frame="frm_barrabotones" name="MAP_LBBT7" visible="1" type="TL" class="labelbotonmenu" title="Alertas" align="center" lmargin="2" newline="false" />
      <prop group="0" frame="frm_barrabotones" name="MAP_LBBT8" visible="1" type="TL" class="labelbotonmenu" title="Conect." align="center" lmargin="2" newline="false" />
      <prop group="0" frame="frm_barrabotones" name="MAP_BTIMG1" visible="0" type="T" />
      <prop group="0" frame="frm_barrabotones" name="MAP_BTIMG2" visible="0" type="T" />
      <prop group="0" frame="frm_barrabotones" name="MAP_BTIMG3" visible="0" type="T" />
      <prop group="0" frame="frm_barrabotones" name="MAP_BTIMG4" visible="0" type="T" />
      <prop group="0" frame="frm_barrabotones" name="MAP_BTIMG5" visible="0" type="T" />
      <prop group="0" frame="frm_barrabotones" name="MAP_BTIMG6" visible="0" type="T" />
      <prop group="0" frame="frm_barrabotones" name="MAP_BTIMG7" visible="0" type="T" />
      <prop group="0" frame="frm_barrabotones" name="MAP_BTIMG8" visible="0" type="T" />
      <prop group="0" frame="frm_barrabotones" name="MAP_BUTTONSELECT" visible="0" type="N" />
      <!-- ## Frame Barra de esatdo ## -->
      <frame name="frm_barraestado" width="100%" height="38%" scroll="false" bgcolor="#05264e" align="right" orientation="bottom" />
      <prop group="0" frame="frm_barraestado" name="MAP_DATOSESTADO" visible="0" type="T" />
      <prop group="0" frame="frm_barraestado" name="MAP_LBESTADO" visible="1" type="TL" class="labelestado" title="##FLD_MAP_DATOSESTADO##" tmargin="2" />
      <prop group="0" frame="frm_barraestado" type="B" visible="1" class="boton3" name="exit" img="bt-exit-white.png" newline="false" bgcolor="#009933" onchange="Refresh255" lmargin="1" method="ExecuteNode (exit)" width="4%" />
      <prop name="MAP_TAB" type="N" visible="0" />
      <!-- ##### GRUPO SIN MENU ##### -->
      <group name="menu99" id="99" disablevisible="MAP_TAB&lt;&gt;99" />
      <!-- ## Frame Cabecera ## -->
      <frame name="frm_cabecera99" width="100%" height="8%" scroll="false" orientation="top" bgcolor="#094c9b,#05264e" />
      <prop group="99" frame="frm_cabecera99" name="MAP_ICON99" visible="1" type="B" width="5%" labelwidth="0" icon="icon.png" method="Executenode(menu0)" />
      <prop group="99" frame="frm_cabecera99" name="MAP_CABECERA99" visible="1" type="TL" class="labelcab" title="INGAPAN Mobile CRM" />
      <!-- ## Frame de datos vacio con fondo ## -->
      <frame name="frm_datos" width="100%" height="92%" scroll="false" imgbk="fondo.jpg" />
      <prop group="99" frame="frm_datos" name="MAP_BOTONFALSO" visible="1" type="B" width="1%" height="1%" bgcolor="#00000000" forecolor="#00000000" />
      <!-- ##### GRUPO BOTON 1. AGENDA ##### -->
      <group name="frm_menu1" id="1" disablevisible="MAP_TAB&lt;&gt;1" />
      <!-- ## Frame Cabecera ## -->
      <frame name="cabecera1" width="100%" height="8%" scroll="false" orientation="top" bgcolor="#094c9b,#05264e" />
      <prop group="1" frame="cabecera1" name="MAP_ICON1" visible="1" type="B" width="5%" labelwidth="0" icon="icon.png" method="Executenode(menu0)" />
      <prop group="1" frame="cabecera1" name="MAP_CABECERA1" visible="1" type="TL" class="labelcab" title="INGAPAN Mobile CRM -  AGENDA" />
      <!-- ## Frame con botones e informacion de calendario ## -->
      <frame name="frm_LabelCalendario" height="10%" width="100%" align="center" framebox="true" />
      <prop group="1" frame="frm_LabelCalendario" type="B" name="MAP_CAMBIARCALENDARMODE" method="ExecuteNode(Calendar_Mode)" title=" " visible="1" class="boton3" img="bt-calendar-black.png" imgsel="bt-calendar-grey.png" onchange="refresh255" />
      <prop group="1" frame="frm_LabelCalendario" type="B" name="MAP_NUEVOEVENTOAGENDA" method="ExecuteNode(Calendar_Nuevo)" lmargin="2" title=" " newline="false" visible="1" class="boton3" img="bt-mas-black.png" imgsel="bt-mas-grey.png" postonchange="refresh" />
      <prop group="1" frame="frm_LabelCalendario" type="B" name="MAP_BT_PREVIOUS_DATE" method="ExecuteNode(Calendar_MesAnterior)" title=" " newline="false" lmargin="14" visible="1" class="boton3" img="bt-left-grey.png" imgsel="bt-left-white.png" />
      <prop group="1" frame="frm_LabelCalendario" type="T" name="MAP_TITLE_NAMES_MES" newline="false" locked="true" text-border="false" align="center" visible="1" width="20%" labelwidth="0" fontbold="true" bgcolor="#00000000" text-bgcolor="#00000000" text-bgcolor-disabled="#00000000" text-forecolor="#FF232E5C" fontsize="12" />
      <prop group="1" frame="frm_LabelCalendario" type="T" name="MAP_TITLE_NAMES_ANO" newline="false" locked="true" text-border="false" align="center" visible="1" width="20%" labelwidth="0" fontbold="true" bgcolor="#00000000" text-bgcolor="#00000000" text-bgcolor-disabled="#00000000" text-forecolor="#FF232E5C" fontsize="12" />
      <prop group="1" frame="frm_LabelCalendario" type="B" name="MAP_BT_NEXT_DATE" method="ExecuteNode(Calendar_MesSiguiente)" title=" " newline="false" visible="1" class="boton3" img="bt-right-grey.png" imgsel="bt-right-white.png" />
      <prop group="1" name="MAP_FECHACALENDAR" type="D" visible="0" />
      <prop group="1" name="MAP_CALENDARMODE" type="N" visible="0" />
      <!-- ## Frame Calendario Calendar MES ## -->
      <frame name="frm_Calendario_Calendar_Mes" height="82%" width="60%" align="center|top" disablevisible="MAP_CALENDARMODE=2" />
      <prop group="1" frame="frm_Calendario_Calendar_Mes" name="Agenda_Menu_Calendario_Mes" labelwidth="0" width="100%" height="100%" type="Z" class="z_calendario" visible="1" contents="Agenda_Menu_Calendario_Mes" viewmode="calendarview" />
      <contents name="Agenda_Menu_Calendario_Mes" src="Agenda_Menu_Calendario" filter="(t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <!-- ## Frame Calendario Lista MES ## -->
      <frame name="frm_Calendario_Lista_Mes" height="82%" width="40%" align="center|top" newline="false" disablevisible="MAP_CALENDARMODE=2" />
      <prop group="1" frame="frm_Calendario_Lista_Mes" name="Agenda_Menu_Lista_Mes" labelwidth="0" width="100%" height="100%" type="Z" class="z_contents" newline="false" visible="1" contents="Agenda_Menu_Lista_Mes" postonchange="refresh" />
      <contents name="Agenda_Menu_Lista_Mes" src="Agenda_Menu_Lista" filter="date(t1.FECHA_VISITA)=date(##FLD_MAP_FECHACALENDAR##) and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <!-- ## Frame Calendario Calendar SEMANA ## -->
      <frame name="frm_Calendario_Calendar_Semana" height="82%" width="60%" align="center|top" disablevisible="MAP_CALENDARMODE=1" newline="true" />
      <prop group="1" frame="frm_Calendario_Calendar_Semana" name="Agenda_Menu_Calendario_Semana" labelwidth="0" width="100%" height="100%" type="Z" class="z_calendario_week" visible="1" contents="Agenda_Menu_Calendario_Semana" viewmode="calendarview" calendar-viewmode="week" />
      <contents name="Agenda_Menu_Calendario_Semana" src="Agenda_Menu_Calendario" filter="(t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <!-- ## Frame Calendario Lista SEMANA ## -->
      <frame name="frm_Calendario_Lista_Semana" height="82%" width="40%" align="center|top" newline="false" disablevisible="MAP_CALENDARMODE=1" />
      <prop group="1" frame="frm_Calendario_Lista_Semana" name="Agenda_Menu_Lista_Semana" labelwidth="0" width="100%" height="100%" type="Z" class="z_contents" newline="false" visible="1" contents="Agenda_Menu_Lista_Semana" postonchange="refresh" />
      <contents name="Agenda_Menu_Lista_Semana" src="Agenda_Menu_Lista" filter="date(t1.FECHA_VISITA)=date(##FLD_MAP_FECHACALENDAR##) and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <!-- ##### GRUPO BOTON 2. CLIENTES ##### -->
      <group name="SeleccionCliente" id="2" disablevisible="MAP_TAB&lt;&gt;2" />
      <!-- ## Frame Cabecera ## -->
      <frame name="cabecera2" width="100%" height="8%" scroll="false" orientation="top" bgcolor="#094c9b,#05264e" />
      <prop group="2" frame="cabecera2" name="MAP_ICON2" visible="1" type="B" width="5%" labelwidth="0" icon="icon.png" method="Executenode(menu0)" />
      <prop group="2" frame="cabecera2" name="MAP_CABECERA2" visible="1" type="TL" class="labelcab" title="INGAPAN Mobile CRM -  CLIENTES" />
      <!-- ## Frame Filtro de clientes ## -->
      <frame name="frm_datos_filtro_cliente" width="100%" height="20%" scroll="false" />
      <prop group="2" frame="frm_datos_filtro_cliente" name="MAP_LBCLIENTESFILTRAR" visible="1" type="TL" class="label2" width="25%" title="Datos Filtro" tmargin="1" />
      <prop group="2" frame="frm_datos_filtro_cliente" name="MAP_NOMBRECLIENTE" visible="1" type="T" size="40" width="35%" tooltip="Nombre" labelwidth="0" tmargin="2" lmargin="1" />
      <prop group="2" frame="frm_datos_filtro_cliente" name="MAP_CODIGOCLIENTE" visible="1" type="T" newline="false" size="40" width="20%" tooltip="Codigo" labelwidth="0" tmargin="2" lmargin="1" />
      <prop group="2" frame="frm_datos_filtro_cliente" name="MAP_POBLACIONCLIENTE" visible="1" type="T" newline="false" size="40" width="33%" tooltip="Poblacion" labelwidth="0" tmargin="2" lmargin="1" />
      <prop group="2" frame="frm_datos_filtro_cliente" name="MAP_FILTRARCLIENTES" visible="1" type="B" class="botonmenu" newline="false" lmargin="1" tmargin="1" icon="bt-find-black.png" onchange="refresh" method="Executenode(filtrarclientes)" title="" />
      <!-- ## Frame Contents de Clientes ## -->
      <frame name="frm_listadoClienes" height="72%" width="100%" />
      <prop group="2" frame="frm_listadoClienes" name="MAP_LBCLIENTESCONTENTS" visible="1" type="TL" class="label2" width="25%" title="Clientes" tmargin="2" />
      <prop group="2" frame="frm_listadoClienes" name="Clientes_Contents" labelwidth="0" width="100%" height="90%" type="Z" class="z_contents" visible="1" contents="Clientes_Contents" />
      <contents name="Clientes_Contents" src="Clientes_Contents2" filter="(t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <!-- ##### GRUPO BOTON 3. ESTADISTICAS ##### -->
      <group name="SeleccEstadisticas" id="3" disablevisible="MAP_TAB&lt;&gt;3" />
      <!-- ## Frame Cabecera ## -->
      <frame name="cabecera3" width="100%" height="8%" scroll="false" orientation="top" bgcolor="#094c9b,#05264e" />
      <prop group="3" frame="cabecera3" name="MAP_ICON3" visible="1" type="B" width="5%" labelwidth="0" icon="icon.png" method="Executenode(menu0)" />
      <prop group="3" frame="cabecera3" name="MAP_CABECERA3" visible="1" type="TL" class="labelcab" title="INGAPAN Mobile CRM -  ESTADISTICAS" width="94%" />
      <prop group="3" name="MAP_TABESTADISTICAS" type="N" visible="0" />
      <!-- ## Frame Datos de estadisticas## -->
      <frame name="frm_pestanas_estadisticas" width="100%" height="9%" scroll="false" bgcolor="#ffda6b" framebox="true" border-width="3" align="center" />
      <prop group="3" frame="frm_pestanas_estadisticas" name="MAP_BTGROUPEST1" visible="1" type="B" class="botongrupo" bgcolor="##FLD_MAP_BTIMGEST1##" caption="Estadisticas" onchange="refresh" method="Executenode(menuestadisticas(1))" title="" />
      <prop group="3" frame="frm_pestanas_estadisticas" name="MAP_BTGROUPEST2" visible="1" type="B" class="botongrupo" newline="false" lmargin="1" bgcolor="##FLD_MAP_BTIMGEST2##" caption="Maquinaria" onchange="refresh" method="Executenode(menuestadisticas(2))" title="" />
      <prop group="3" frame="frm_pestanas_estadisticas" name="MAP_BTGROUPEST3" visible="1" type="B" class="botongrupo" newline="false" lmargin="1" bgcolor="##FLD_MAP_BTIMGEST3##" caption="QLikView" onchange="refresh" method="Executenode(menuestadisticas(3))" title="" />
      <prop group="3" frame="frm_pestanas_estadisticas" name="MAP_BTIMGEST1" visible="0" type="T" />
      <prop group="3" frame="frm_pestanas_estadisticas" name="MAP_BTIMGEST2" visible="0" type="T" />
      <prop group="3" frame="frm_pestanas_estadisticas" name="MAP_BTIMGEST3" visible="0" type="T" />
      <!-- ## Frame Listado Estadisticas# -->
      <frame name="frm_contents_estadisticas" height="82%" width="100%" disablevisible="MAP_TABESTADISTICAS&lt;&gt;1" />
      <prop group="3" frame="frm_contents_estadisticas" name="Estadisticas_Contents" labelwidth="0" width="100%" height="100%" type="Z" class="z_contents" visible="1" contents="Estadisticas_Contents" />
      <contents name="Estadisticas_Contents" src="Estadisticas_Contents2" filter="t1.GGALBTIP_COD &lt;&gt; 'MQ' and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <!-- ## Frame Listado Estadisticas# -->
      <frame name="frm_contents_estadisticas2" height="82%" width="100%" disablevisible="MAP_TABESTADISTICAS&lt;&gt;2" />
      <prop group="3" frame="frm_contents_estadisticas2" name="Estadisticas_Contents2" labelwidth="0" width="100%" height="100%" type="Z" class="z_contents" visible="1" contents="Estadisticas_Contents2" />
      <contents name="Estadisticas_Contents2" src="Estadisticas_Contents2" filter="t1.GGALBTIP_COD = 'MQ' and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <!-- ## Frame QLikView Estadisticas## -->
      <frame name="frm_qlikview_estadisticas" height="82%" width="100%" disablevisible="MAP_TABESTADISTICAS&lt;&gt;3" />
      <prop group="3" frame="frm_qlikview_estadisticas" name="MAP_LIKVIEWESTADISTICAS" visible="1" class="html" type="WEB" webview-username="##FLD_MAP_USERWEB##" webview-password="##FLD_MAP_PWDWEB##" width="100%" height="100%" scroll="false" />
      <prop group="3" frame="frm_qlikview_estadisticas" name="MAP_USERWEB" visible="0" type="T" />
      <prop group="3" frame="frm_qlikview_estadisticas" name="MAP_PWDWEB" visible="0" type="T" />
      <!-- ##### GRUPO BOTON 4. PEDIDOS ##### -->
      <group name="Pedidos" id="4" disablevisible="MAP_TAB&lt;&gt;4" />
      <!-- ## Se abre una nueva coleccion Pedidos_Menu## -->
      <!-- ##### GRUPO BOTON 5. PARTES ##### -->
      <group name="Partes" id="5" disablevisible="MAP_TAB&lt;&gt;5" />
      <!-- ## Se abre una nueva coleccion Partes_Menu## -->
      <!-- ##### GRUPO BOTON 6. DOCUMENTOS ##### -->
      <group name="SeleccDocumentos" id="6" disablevisible="MAP_TAB&lt;&gt;6" />
      <!-- ## Frame Cabecera ## -->
      <frame name="cabecera6" width="100%" height="8%" scroll="false" orientation="top" bgcolor="#094c9b,#05264e" />
      <prop group="6" frame="cabecera6" name="MAP_ICON6" visible="1" type="B" width="5%" labelwidth="0" icon="icon.png" method="Executenode(menu0)" />
      <prop group="6" frame="cabecera6" name="MAP_CABECERA6" visible="1" type="TL" class="labelcab" title="INGAPAN Mobile CRM -  DOCUMENTOS" />
      <!-- ## Frame Datos de documentops## -->
      <frame name="frm_pestanas_documentos" width="100%" height="9%" scroll="false" bgcolor="#ffda6b" framebox="true" border-width="3" align="center" />
      <prop group="6" frame="frm_pestanas_documentos" name="MAP_TABDOCUMENTOS" type="N" visible="0" />
      <prop group="6" frame="frm_pestanas_documentos" name="MAP_BTGROUPDOC1" visible="1" type="B" class="botongrupo" bgcolor="##FLD_MAP_BTIMGDOC1##" caption="Presentaciones" onchange="refresh" method="Executenode(menudocumentos(1))" title="" />
      <prop group="6" frame="frm_pestanas_documentos" name="MAP_BTGROUPDOC2" visible="1" type="B" class="botongrupo" newline="false" lmargin="1" bgcolor="##FLD_MAP_BTIMGDOC2##" caption="Catalogos" onchange="refresh" method="Executenode(menudocumentos(2))" title="" />
      <prop group="6" frame="frm_pestanas_documentos" name="MAP_BTGROUPDOC3" visible="1" type="B" class="botongrupo" newline="false" lmargin="1" bgcolor="##FLD_MAP_BTIMGDOC3##" caption="Kits" onchange="refresh" method="Executenode(menudocumentos(3))" title="" />
      <prop group="6" frame="frm_pestanas_documentos" name="MAP_BTGROUPDOC4" visible="1" type="B" class="botongrupo" newline="false" lmargin="1" bgcolor="##FLD_MAP_BTIMGDOC4##" caption="Tarifas" onchange="refresh" method="Executenode(menudocumentos(4))" title="" />
      <prop group="6" frame="frm_pestanas_documentos" name="MAP_BTIMGDOC1" visible="0" type="T" />
      <prop group="6" frame="frm_pestanas_documentos" name="MAP_BTIMGDOC2" visible="0" type="T" />
      <prop group="6" frame="frm_pestanas_documentos" name="MAP_BTIMGDOC3" visible="0" type="T" />
      <prop group="6" frame="frm_pestanas_documentos" name="MAP_BTIMGDOC4" visible="0" type="T" />
      <!-- ## Frame Listado Documentos 1# -->
      <frame name="frm_contents_documentos1" height="83%" width="100%" disablevisible="MAP_TABDOCUMENTOS&lt;&gt;1" />
      <prop group="6" frame="frm_contents_documentos1" name="Documentos_Contents1" labelwidth="0" width="100%" height="100%" type="Z" class="z_contents" visible="1" contents="Documentos_Contents1" />
      <contents name="Documentos_Contents1" src="Documentos_Contents" filter="t2.COD='PRE' and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <!-- ## Frame Listado Documentos 2# -->
      <frame name="frm_contents_documentos2" height="83%" width="100%" disablevisible="MAP_TABDOCUMENTOS&lt;&gt;2" />
      <prop group="6" frame="frm_contents_documentos2" name="Documentos_Contents2" labelwidth="0" width="100%" height="100%" type="Z" class="z_contents" visible="1" contents="Documentos_Contents2" />
      <contents name="Documentos_Contents2" src="Documentos_Contents" filter="t2.COD='CAT' and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <!-- ## Frame Listado Documentos 3# -->
      <frame name="frm_contents_documentos3" height="83%" width="100%" disablevisible="MAP_TABDOCUMENTOS&lt;&gt;3" />
      <prop group="6" frame="frm_contents_documentos3" name="Documentos_Contents3" labelwidth="0" width="100%" height="100%" type="Z" class="z_contents" visible="1" contents="Documentos_Contents3" />
      <contents name="Documentos_Contents3" src="Documentos_Contents" filter="t2.COD='KIT' and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <!-- ## Frame Listado Documentos 4# -->
      <frame name="frm_contents_documentos4" height="83%" width="100%" disablevisible="MAP_TABDOCUMENTOS&lt;&gt;4" />
      <prop group="6" frame="frm_contents_documentos4" name="Documentos_Contents4" labelwidth="0" width="100%" height="100%" type="Z" class="z_contents" visible="1" contents="Documentos_Contents4" />
      <contents name="Documentos_Contents4" src="Documentos_Contents" filter="t2.COD='TAR' and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <!-- ##### GRUPO BOTON 7. ALERTAS ##### -->
      <group name="SeleccionAlerta" id="7" disablevisible="MAP_TAB&lt;&gt;7" />
      <!-- ## Frame Cabecera ## -->
      <frame name="cabecera7" width="100%" height="8%" scroll="false" orientation="top" bgcolor="#094c9b,#05264e" />
      <prop group="7" frame="cabecera7" name="MAP_ICON7" visible="1" type="B" width="5%" labelwidth="0" icon="icon.png" method="Executenode(menu0)" />
      <prop group="7" frame="cabecera7" name="MAP_CABECERA7" visible="1" type="TL" class="labelcab" title="INGAPAN Mobile CRM -  ALERTAS" />
      <!-- ## Frame Filtro de clientes ## -->
      <frame name="frm_datos_filtro_Alertas" width="100%" height="30%" scroll="false" />
      <prop group="7" frame="frm_datos_filtro_Alertas" name="MAP_LBALERTASFILTRAR" visible="1" type="TL" class="label2" width="30%" title="Datos Filtro" tmargin="1" />
      <prop group="7" frame="frm_datos_filtro_Alertas" name="MAP_IDTIPOALERTA" visible="0" type="N" size="8" mapcol="TiposAlerta_Basic" mapfld="ID" onchange="refresh255" />
      <prop group="7" frame="frm_datos_filtro_Alertas" name="MAP_TIPOALERTA" visible="1" type="T" linkedto="MAP_IDTIPOALERTA" linkedfield="DESCRIP" size="40" width="25%" title="Tipo: " labelwidth="3" tmargin="2" />
      <prop group="7" frame="frm_datos_filtro_Alertas" name="MAP_BT_LIMPIAR" visible="1" type="B" newline="false" class="boton2" icon="bt-x-black.png" onchange="refresh" method="Executenode(limpiartipoalerta)" title="" tmargin="2" lmargin="0" />
      <prop group="7" frame="frm_datos_filtro_Alertas" name="MAP_FECHADESDE" visible="1" type="D" newline="false" size="40" width="15%" tooltip="Desde" labelwidth="0" tmargin="2" lmargin="1" />
      <prop group="7" frame="frm_datos_filtro_Alertas" name="MAP_FECHAHASTA" visible="1" type="D" newline="false" size="40" width="15%" tooltip="Hasta" labelwidth="0" tmargin="2" lmargin="1" />
      <prop group="7" frame="frm_datos_filtro_Alertas" name="MAP_COMENTARIO" visible="1" type="T" newline="false" size="40" width="20%" tooltip="Comentario" labelwidth="0" tmargin="2" lmargin="0" />
      <prop group="7" frame="frm_datos_filtro_Alertas" name="MAP_LBCERRADAS" visible="1" type="TL" class="label2" width="8%" title="Cerradas" tmargin="2" newline="false" />
      <prop group="7" frame="frm_datos_filtro_Alertas" name="MAP_CERRADA" visible="1" type="NC" newline="false" size="40" title=" " labelwidth="0" tmargin="1" lmargin="0" />
      <prop group="7" frame="frm_datos_filtro_Alertas" name="MAP_FILTRARALERTAS" visible="1" type="B" class="botonmenu" newline="false" lmargin="1" tmargin="1" icon="bt-find-black.png" onchange="refresh" method="Executenode(filtraralertas)" title="" />
      <prop group="7" frame="frm_datos_filtro_Alertas" name="MAP_LBALERTASEL" visible="1" type="TL" class="label2" width="25%" title="Alerta Seleccionada" tmargin="1" />
      <prop group="7" frame="frm_datos_filtro_Alertas" name="MAP_COMENTARIOSEL" visible="1" type="T" size="40" width="80%" tooltip="Comentario Alerta Seleccionada" labelwidth="0" tmargin="2" lmargin="1" />
      <prop group="7" frame="frm_datos_filtro_Alertas" name="MAP_BT_CERRARSEL" visible="1" type="B" newline="false" class="boton2" icon="bt-okbox-black.png" onchange="refresh" method="Executenode(cerraralerta)" title="" tmargin="1" lmargin="1" />
      <prop group="7" frame="frm_datos_filtro_Alertas" name="MAP_CERRADASEL" visible="0" type="N" />
      <prop group="7" frame="frm_datos_filtro_Alertas" name="MAP_IDALERTASEL" visible="0" type="N" />
      <!-- ## Frame Contents de Clientes ## -->
      <frame name="frm_listadoAlertas" height="62%" width="100%" />
      <prop group="7" frame="frm_listadoAlertas" name="MAP_LBALERTASCONTENTS1" visible="1" type="TL" class="label2" width="20%" title=" Tipo Alerta" tmargin="2" />
      <prop group="7" frame="frm_listadoAlertas" name="MAP_LBALERTASCONTENTS2" visible="1" type="TL" newline="false" class="label2" width="35%" title="  Cliente" tmargin="2" />
      <prop group="7" frame="frm_listadoAlertas" name="MAP_LBALERTASCONTENTS3" visible="1" type="TL" newline="false" class="label2" width="20%" title="  F. Desde" tmargin="2" />
      <prop group="7" frame="frm_listadoAlertas" name="MAP_LBALERTASCONTENTS4" visible="1" type="TL" newline="false" class="label2" width="20%" title="  F. Hasta" tmargin="2" />
      <prop group="7" frame="frm_listadoAlertas" name="MAP_LBALERTASCONTENTS5" visible="1" type="TL" newline="false" class="label2" width="5%" title="    C" tmargin="2" />
      <prop group="7" frame="frm_listadoAlertas" name="Alertas_Contents" labelwidth="0" width="100%" height="90%" type="Z" class="z_contents" visible="1" contents="Alertas_Contents" />
      <contents name="Alertas_Contents" src="Alertas_Contents" filter="t1.CERRADA_SN=0" />
      <!-- ##### GRUPO BOTON 8. COMUNICACIONES ##### -->
      <group name="Comunicaciones" id="8" disablevisible="MAP_TAB&lt;&gt;8" />
      <!-- ## Frame Cabecera ## -->
      <frame name="cabecera8" width="100%" height="8%" scroll="false" orientation="top" bgcolor="#094c9b,#05264e" />
      <prop group="8" frame="cabecera8" name="MAP_ICON8" visible="1" type="B" width="5%" labelwidth="0" icon="icon.png" method="Executenode(menu0)" />
      <prop group="8" frame="cabecera8" name="MAP_CABECERA8" visible="1" type="TL" class="labelcab" title="INGAPAN Mobile CRM -  COMUNICACIONES" />
      <!-- ## Frame comunicaciones_datos ## -->
      <frame name="frm_datos_comunicaciones_datos" width="50%" height="92%" scroll="false" framebox="true" border-width="2" />
      <prop group="8" frame="frm_datos_comunicaciones_datos" name="MAP_LBINFORMACIONREPLICA" visible="1" type="TL" class="label2" align="left" width="100%" title="Gestion Replica Datos" tmargin="1" />
      <prop group="8" frame="frm_datos_comunicaciones_datos" name="MAP_BTSINCRONIZAR" visible="1" type="B" class="botonmenureplica" tmargin="3" lmargin="4" icon="bt-replica-black.png" onchange="refresh" method="Executenode(sincronizar)" title="" />
      <prop group="8" frame="frm_datos_comunicaciones_datos" name="MAP_BTENVIOLOGS" visible="1" type="B" class="botonmenureplica" newline="false" tmargin="1" lmargin="6" icon="bt-subir-black.png" onchange="refresh" method="Executenode(enviologs)" title="" />
      <prop group="8" frame="frm_datos_comunicaciones_datos" name="MAP_BTREFRESCAR" visible="1" type="B" class="botonmenureplica" newline="false" tmargin="1" lmargin="6" icon="bt-sinc-black.png" onchange="refresh" method="Executenode(refreshreplica)" title="" />
      <prop group="8" frame="frm_datos_comunicaciones_datos" name="MAP_LBSINCRONIZAR" visible="1" type="TL" class="labelbotonmenureplica" title="Sincronizar" align="center" lmargin="4" />
      <prop group="8" frame="frm_datos_comunicaciones_datos" name="MAP_LBENVIOLOGS" visible="1" type="TL" class="labelbotonmenureplica" title="Enviar Logs" align="center" lmargin="6" newline="false" />
      <prop group="8" frame="frm_datos_comunicaciones_datos" name="MAP_LBREFRESCAR" visible="1" type="TL" class="labelbotonmenureplica" title="Refresh Info." align="center" lmargin="6" newline="false" />
      <prop group="8" frame="frm_datos_comunicaciones_datos" name="MAP_RECORDSRX" title="Operaciones Recibidas" fontsize="12" tmargin="2" type="T" labelwidth="15" visible="15" locked="true" width="95%" />
      <prop group="8" frame="frm_datos_comunicaciones_datos" name="MAP_RECORDSTX" title="Operaciones Enviadas" fontsize="12" tmargin="1" type="T" labelwidth="15" visible="15" locked="true" width="95%" />
      <prop group="8" frame="frm_datos_comunicaciones_datos" name="MAP_RECORDSPEND" title="Operaciones Pendientes" fontsize="12" tmargin="1" type="T" labelwidth="15" visible="15" locked="true" width="95%" />
      <prop group="8" frame="frm_datos_comunicaciones_datos" name="MAP_LBINFORMACIONREPLICALOG" visible="1" type="TL" class="label2" fontsize="12" align="left" width="80%" title="Log Comunicaciones" tmargin="2" />
      <prop group="8" frame="frm_datos_comunicaciones_datos" name="MAP_LOG" title="Log" type="T" fontsize="8" labelwidth="0" visible="1" locked="true" lines="5" fixed-lines="true" width="95%" />
      <!-- ## Frame comunicaciones_ficheros ## -->
      <frame name="frm_datos_comunicaciones_ficheros" width="50%" height="92%" scroll="false" framebox="true" border-width="2" newline="false" />
      <prop group="8" frame="frm_datos_comunicaciones_ficheros" name="MAP_LBINFORMACIONREPLICAFICH" visible="1" type="TL" class="label2" align="left" width="100%" title="Gestion Replica Ficheros" tmargin="1" />
      <prop group="8" frame="frm_datos_comunicaciones_ficheros" name="MAP_BTDESCARGAIMAGENES" visible="1" type="B" class="botonmenureplica" tmargin="3" lmargin="4" icon="bt-descargaimg-black.png" onchange="refresh" method="Executenode(descarga_imagenes)" title="" />
      <prop group="8" frame="frm_datos_comunicaciones_ficheros" name="MAP_BTDESCARGADOCS" visible="1" type="B" class="botonmenureplica" newline="false" tmargin="1" lmargin="6" icon="bt-descarga2-black.png" onchange="refresh" method="Executenode(descarga_docs)" title="" />
      <prop group="8" frame="frm_datos_comunicaciones_ficheros" name="MAP_BTDESCARGAADJUNTOS" visible="1" type="B" class="botonmenureplica" newline="false" tmargin="1" lmargin="6" icon="bt-descargaadjuntos-black.png" onchange="refresh" method="Executenode(descarga_adjuntos)" title="" />
      <prop group="8" frame="frm_datos_comunicaciones_ficheros" name="MAP_LBDESCARGAIMAGENES" visible="1" type="TL" class="labelbotonmenureplica" title="Dsc.Imgs." align="center" lmargin="4" />
      <prop group="8" frame="frm_datos_comunicaciones_ficheros" name="MAP_LBDESCARGADOCS" visible="1" type="TL" class="labelbotonmenureplica" title="Dsc.Docs" align="center" lmargin="6" newline="false" />
      <prop group="8" frame="frm_datos_comunicaciones_ficheros" name="MAP_LBDESCARGAADJUNTOS" visible="1" type="TL" class="labelbotonmenureplica" title="Dsc.Adjuntos" align="center" lmargin="6" newline="false" />
      <prop group="8" frame="frm_datos_comunicaciones_ficheros" name="MAP_FICHEROSXENVIAR" title="Ficheros Pendientes Envio" fontsize="12" tmargin="5" type="T" labelwidth="15" visible="15" locked="true" width="95%" />
      <create>
        <action name="runscript">
          <script language="VBScript">   
				CreateMenuPrincipal
				this("MAP_USERWEB")=appdata.CurrentEnterprise.variables("QL_USERNAME")
	            this("MAP_PWDWEB")=appdata.CurrentEnterprise.variables("QL_PASSWD")
	            this("MAP_LIKVIEWESTADISTICAS")=""
          </script>
        </action>
      </create>
      <menu0>
        <action name="runscript">
          <param name="nmenu" />
          <script language="VBScript">
          			this("MAP_LIKVIEWESTADISTICAS")=""
                    LB_ShowGroup 99
                  </script>
        </action>
      </menu0>
      <menu show-wait-dialog="false">
        <action name="runscript">
          <param name="nmenu" />
          <script language="VBScript">
         
                    'Cargamos menu seleccionado
                    this("MAP_LIKVIEWESTADISTICAS")=""
      				this("MAP_BUTTONSELECT")=nmenu
      				CargarIconosMenu nmenu
      				CargarMenu nmenu
                  </script>
        </action>
      </menu>
      <menuestadisticas show-wait-dialog="false">
        <action name="runscript">
          <param name="nmenu" />
          <script language="VBScript">
          			this("MAP_LIKVIEWESTADISTICAS")=""
                   'Seleccion de pestaa virtual de menu estadisticas
      				CargarIconosEstadisticas nmenu
      				CargarGruposEstadisticas nmenu
                  </script>
        </action>
      </menuestadisticas>
      <menudocumentos show-wait-dialog="false">
        <action name="runscript">
          <param name="nmenu" />
          <script language="VBScript">
          			this("MAP_LIKVIEWESTADISTICAS")=""
                   'Seleccion de pestaa virtual de menu documentos
      				CargarIconosDocumentos nmenu
      				CargarGruposDocumentos nmenu
                  </script>
        </action>
      </menudocumentos>
      <onback show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		this("MAP_LIKVIEWESTADISTICAS")=""
      		</script>
        </action>
      </onback>
      <exit show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		    if LB_MsgYesNo ("Desea cerrar la aplicacin?") then
	          			appdata.failwithmessage -11888,"##EXITAPP##"
	          	    end if
      		</script>
        </action>
      </exit>
      <Calendar_MesAnterior show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          				'Retrasamos calendarios de agenda
          				this.Contents("Agenda_Menu_Calendario_Mes").variables("moveto")="prev"
          				this.Contents("Agenda_Menu_Calendario_Semana").variables("moveto")="prev"
		  </script>
        </action>
      </Calendar_MesAnterior>
      <Calendar_MesSiguiente show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          				'Adelantamos calendarios de agenda
          				this.Contents("Agenda_Menu_Calendario_Mes").variables("moveto")="next"
						this.Contents("Agenda_Menu_Calendario_Semana").variables("moveto")="next"
		  </script>
        </action>
      </Calendar_MesSiguiente>
      <Calendar_Mode show-wait-dialog="false" refresh-props="Agenda_Menu_Calendario_Mes,Agenda_Menu_Calendario_Semana">
        <action name="runscript">
          <script language="VBScript">    
					' Cambiamos el modo del calendario (mostrando un contents y otro)          
					  CambiarModoCalendario
		  </script>
        </action>
      </Calendar_Mode>
      <Calendar_Nuevo show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          			'Creamos nuevo registro de agenda
					NuevaAgenda
		  </script>
        </action>
      </Calendar_Nuevo>
      <filtrarclientes show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		'Aplicamos filtro a menu de clientes
          		FiltrarContents "t1.COD like '%"+cstr(this("MAP_CODIGOCLIENTE"))+"%' and t1.NOMBRE like '%"+cstr(this("MAP_NOMBRECLIENTE"))+"%' and (select count(d.ID) from gen_direcciones d where d.IDRAZONSOCIAL=t1.IDRAZONSOCIAL AND d.POBLACION like '%"+cstr(this("MAP_POBLACIONCLIENTE"))+"%')&gt;0","Clientes_Contents"
      		</script>
        </action>
      </filtrarclientes>
      <limpiartipoalerta show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          	  this("MAP_IDTIPOALERTA")=0
          	  this("MAP_TIPOALERTA")=""
      		</script>
        </action>
      </limpiartipoalerta>
      <cerraralerta show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          	    if this("MAP_CERRADASEL")=0 then
          	          if this("MAP_IDALERTASEL")&gt;0 then
	          	         Msg="Desea cerrar la alerta seleccionada?"
	 					 Res=LB_MsgYesNo(Msg)
	  					 on error resume next
	                     if Res=True then
	                        LB_RunSQLRep "UPDATE GEN_ALERTAS SET COMENTARIO='"+this("MAP_COMENTARIOSEL")+"',CERRADA_SN=1 where ID="+cstr(this("MAP_IDALERTASEL"))
	                     end if
	                  else
	                    LB_msg "Debe seleccionar una alerta"
	                  end if
          	    end if
      		</script>
        </action>
      </cerraralerta>
      <filtraralertas show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		'Alpicamos filtro a menu de alertas
          		if this("MAP_FECHADESDE")&lt;&gt;"" and this("MAP_FECHAHASTA")&lt;&gt;"" then
          		    FiltrarContents "t1.CERRADA_SN="+cstr(this("MAP_CERRADA"))+" and (t1.IDTIPOALERTA=##FLD_MAP_IDTIPOALERTA## or 0=##FLD_MAP_IDTIPOALERTA##) and date(t1.F_DESDE)=date(##FLD_MAP_FECHADESDE##) and date(t1.F_HASTA)=date(##FLD_MAP_FECHAHASTA##) and t1.COMENTARIO like '%"+cstr(this("MAP_COMENTARIO"))+"%' and(t1.ITX_BAJA=0 or t1.ITX_BAJA is null)","Alertas_Contents"
          		else
	          		if this("MAP_FECHAHASTA")&lt;&gt;"" then
	          		    FiltrarContents "t1.CERRADA_SN="+cstr(this("MAP_CERRADA"))+" and (t1.IDTIPOALERTA=##FLD_MAP_IDTIPOALERTA## or 0=##FLD_MAP_IDTIPOALERTA##) and date(t1.F_HASTA)=date(##FLD_MAP_FECHAHASTA##) and t1.COMENTARIO like '%"+cstr(this("MAP_COMENTARIO"))+"%' and(t1.ITX_BAJA=0 or t1.ITX_BAJA is null)","Alertas_Contents"
	          		else
		          		if this("MAP_FECHADESDE")&lt;&gt;"" then
		          		    FiltrarContents "t1.CERRADA_SN="+cstr(this("MAP_CERRADA"))+" and (t1.IDTIPOALERTA=##FLD_MAP_IDTIPOALERTA## or 0=##FLD_MAP_IDTIPOALERTA##) and date(t1.F_DESDE)=date(##FLD_MAP_FECHADESDE##) and t1.COMENTARIO like '%"+cstr(this("MAP_COMENTARIO"))+"%' and(t1.ITX_BAJA=0 or t1.ITX_BAJA is null)","Alertas_Contents"
		          		else
		          		    FiltrarContents "t1.CERRADA_SN="+cstr(this("MAP_CERRADA"))+" and (t1.IDTIPOALERTA=##FLD_MAP_IDTIPOALERTA## or 0=##FLD_MAP_IDTIPOALERTA##) and t1.COMENTARIO like '%"+cstr(this("MAP_COMENTARIO"))+"%' and(t1.ITX_BAJA=0 or t1.ITX_BAJA is null)","Alertas_Contents"
		          		end if
					end if

			    end if
      		</script>
        </action>
      </filtraralertas>
      <refreshreplica show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
           
				RefreshReplica
		 </script>
        </action>
      </refreshreplica>
      <sincronizar show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
				SincronizarReplica      
		  </script>
        </action>
      </sincronizar>
      <enviologs show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
               EnviarLogs
		  </script>
        </action>
      </enviologs>
      <descarga_imagenes show-progress-dialog="true">
        <action name="runscript">
          <script language="VBScript">
                DescargarImagenes
		  </script>
        </action>
      </descarga_imagenes>
      <descarga_docs show-progress-dialog="true">
        <action name="runscript">
          <script language="VBScript">
                DescargarDocumentos
		  </script>
        </action>
      </descarga_docs>
      <descarga_adjuntos show-progress-dialog="true">
        <action name="runscript">
          <script language="VBScript">
                DescargarAdjuntos
		  </script>
        </action>
      </descarga_adjuntos>
    </coll>
    <coll name="Paises_Basic" title="Paises_Basic" sql="SELECT t1.ID     FROM ##PREF##Paises t1" objname="Paises" updateobj="Paises" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="COD" visible="0" type="T" size="4" />
      <prop group="1" name="NOMBRE" visible="0" type="T" size="25" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="Paises_Basic_copy" title="Paises_Basic" sql="SELECT t1.ID     FROM ##PREF##Paises t1" objname="Paises" updateobj="Paises" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="COD" visible="0" type="T" size="4" />
      <prop group="1" name="NOMBRE" visible="0" type="T" size="25" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="Partes_Basic" title="Partes_Basic" sql="SELECT t1.*    FROM ##PREF##Partes t1" objname="Partes" updateobj="Partes" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDUSUARIO" visible="0" type="N" size="8" />
      <prop group="1" name="IDCLIENTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDRAZONSOCIAL" visible="0" type="N" size="8" />
      <prop group="1" name="FECHA" visible="0" type="D" size="8" />
      <prop group="1" name="FECHA_CIERRE" visible="0" type="D" size="8" />
      <prop group="1" name="LOCALIDADES" visible="0" type="T" size="100" />
      <prop group="1" name="KM_SALIDA" visible="0" type="N" size="8" />
      <prop group="1" name="KM_LLEGADA" visible="0" type="N" size="8" />
      <prop group="1" name="NOTAS" visible="0" type="T" size="100" />
      <prop group="1" name="CERRADO" visible="0" type="T" size="1" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="Partes_Cerrados_Contents" title="Partes_Basic" sql="SELECT t1.*, (select sum(l.IMPORTE) from gen_lineasparte l where l.IDPARTE=t1.ID and l.TARJETA=1) AS MAP_TARJETA, (select sum(l.IMPORTE) from gen_lineasparte l where l.IDPARTE=t1.ID and (l.TARJETA=0 or l.TARJETA is null)) AS MAP_EFECTIVO FROM ##PREF##Partes t1" objname="Partes" updateobj="Partes" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDUSUARIO" visible="0" type="N" size="8" />
      <prop group="1" name="IDCLIENTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDRAZONSOCIAL" visible="0" type="N" size="8" />
      <prop group="1" name="FECHA" visible="0" type="D" size="8" />
      <prop group="1" name="NOTAS" visible="0" type="T" size="100" />
      <prop group="1" name="CERRADO" visible="0" type="T" size="1" />
      <prop group="1" name="KM_SALIDA" visible="0" type="N" size="40" width="12%" title="KM" labelwidth="0" newline="false" />
      <prop group="1" name="KM_LLEGADA" visible="0" type="N" size="40" width="12%" title="KM" labelwidth="0" newline="false" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <prop group="1" name="FECHA_CIERRE" visible="7" type="T" size="40" width="20%" title="Fecha" labelwidth="0" newline="false" />
      <prop group="1" name="LOCALIDADES" visible="7" type="T" size="40" width="40%" title="Localidad" labelwidth="0" newline="false" />
      <prop group="1" name="MAP_EFECTIVO" visible="7" type="N2" size="40" width="12%" title="" labelwidth="0" newline="false" />
      <prop group="1" name="MAP_TARJETA" visible="7" type="N2" size="40" width="12%" title="" labelwidth="0" newline="false" />
      <prop group="1" name="MAP_IMPORTE" formula="ext.[IMPORTE]" visible="7" type="N2" size="40" width="16%" title="Importe" labelwidth="0" newline="false" />
      <ext-formula>
        <param name="IMPORTE" sql="select sum(IMPORTE) as N from gen_lineasparte t1 where t1.IDPARTE=##FLD_ID## and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" field="N" type="N2" />
      </ext-formula>
      <selecteditem>
        <action name="runscript">
          <script language="VBScript" />
        </action>
      </selecteditem>
    </coll>
    <coll name="Partes_Menu" title="el Parte_Menu" sql="SELECT t1.* from ##PREF##Partes t1" objname="Partes" updateobj="Partes" progid="ASData.CASBasicDataObj" filter="" sort="">
      <!-- ##### GRUPO  1. PARTES ##### -->
      <group name="Partes" id="1" />
      <!-- ## Frame Cabecera ## -->
      <frame name="cabecera1" width="100%" height="7%" scroll="false" orientation="top" bgcolor="#094c9b,#05264e" />
      <prop group="1" frame="cabecera1" name="MAP_ICON1" visible="1" type="B" width="5%" labelwidth="0" icon="icon.png" method="Executenode(menu0)" locked="true" />
      <prop group="1" frame="cabecera1" name="MAP_CABECERA1" visible="1" type="TL" class="labelcab" title="INGAPAN Mobile CRM -  PARTES" />
      <!-- ## Frame Pestaas Parte## -->
      <frame name="frm_pestanas_Parte" width="100%" height="7%" scroll="false" bgcolor="#ffda6b" framebox="true" border-width="3" align="center" />
      <prop group="1" frame="frm_pestanas_Parte" name="MAP_TABPARTE" type="N" visible="0" />
      <prop group="1" frame="frm_pestanas_Parte" name="MAP_BTGROUPPARTE1" visible="1" type="B" class="botongrupo" bgcolor="##FLD_MAP_BTIMGPARTE1##" caption="En Curso" onchange="refresh" method="Executenode(menuparte(1))" title="" />
      <prop group="1" frame="frm_pestanas_Parte" name="MAP_BTGROUPPARTE2" visible="1" type="B" class="botongrupo" newline="false" lmargin="1" bgcolor="##FLD_MAP_BTIMGPARTE2##" caption="Cerrados" onchange="refresh" method="Executenode(menuparte(2))" title="" />
      <prop group="1" frame="frm_pestanas_Parte" name="MAP_BTIMGPARTE1" visible="0" type="T" />
      <prop group="1" frame="frm_pestanas_Parte" name="MAP_BTIMGPARTE2" visible="0" type="T" />
      <!-- ## Frame Parte 1 ## -->
      <frame name="frm_Parte_1" height="70%" width="40%" disablevisible="MAP_TABPARTE&lt;&gt;1" framebox="true" />
      <prop group="1" frame="frm_Parte_1" name="MAP_LBDATOSPARTE" visible="1" type="TL" class="label2" width="25%" title="Datos Parte" tmargin="1" />
      <prop group="1" frame="frm_Parte_1" name="FECHA" visible="1" type="D" size="40" width="90%" caption="Fecha" labelwidth="8" tmargin="5" lmargin="1" />
      <prop group="1" frame="frm_Parte_1" name="LOCALIDADES" visible="1" type="T" size="40" width="90%" caption="Localidad" labelwidth="8" tmargin="2" lmargin="1" />
      <prop group="1" frame="frm_Parte_1" name="KM_SALIDA" visible="1" type="N" size="40" width="90%" caption="KM. Salida" labelwidth="8" tmargin="2" lmargin="1" />
      <prop group="1" frame="frm_Parte_1" name="KM_LLEGADA" visible="1" type="N" size="40" width="90%" caption="KM. Llegada" labelwidth="8" tmargin="2" lmargin="1" />
      <prop group="1" frame="frm_Parte_1" name="NOTAS" visible="1" type="T" size="40" width="90%" caption="Notas" labelwidth="8" tmargin="2" lmargin="1" lines="5" fixed-lines="true" />
      <prop group="1" frame="frm_Parte_1" name="FECHA_CIERRE" visible="0" type="N" size="40" />
      <prop group="1" frame="frm_Parte_1" name="CERRADO" visible="0" type="T" size="40" />
      <prop group="1" frame="frm_Parte_1" name="IDUSUARIO" visible="0" type="N" size="40" />
      <prop group="1" frame="frm_Parte_1" name="IDEMPRESA" visible="0" type="N" size="40" />
      <prop group="1" frame="frm_Parte_1" name="IDCLIENTE" visible="0" type="N" size="40" />
      <prop group="1" frame="frm_Parte_1" name="IDRAZONSOCIAL" visible="0" type="N" size="40" />
      <!-- ## Frame Parte 2 ## -->
      <frame name="frm_Parte_2" height="70%" width="60%" disablevisible="MAP_TABPARTE&lt;&gt;1" newline="false" framebox="true" />
      <prop group="1" frame="frm_Parte_2" name="MAP_IDLINEAPARTESEL" visible="0" type="N" size="8" />
      <prop group="1" frame="frm_Parte_2" name="MAP_LBLINEASPARTE" visible="1" type="TL" class="label2" width="25%" title="Lineas" tmargin="2" lmargin="1" />
      <prop group="1" frame="frm_Parte_2" name="MAP_BTNUEVALINEA" visible="1" type="B" class="botonmenu" icon="bt-mas-black.png" newline="false" postonchange="refresh255" method="Executenode(nuevalineaparte)" title="" tmargin="2" lmargin="3" />
      <prop group="1" frame="frm_Parte_2" name="MAP_BTBORRARLINEA" visible="1" type="B" class="botonmenu" icon="bt-menos-black.png" onchange="refresh255" method="Executenode(borrarlineaparte)" title="" newline="false" tmargin="2" lmargin="3" />
      <prop group="1" frame="frm_Parte_2" name="Lineas_Parte_Contents" labelwidth="0" width="100%" height="80%" type="Z" class="z_contents" visible="1" contents="Lineas_Parte_Contents" />
      <contents name="Lineas_Parte_Contents" src="Lineas_Parte_Contents" filter="t1.IDPARTE=##FLD_ID## and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <!-- ## Frame Filtro de clientes pedido## -->
      <frame name="frm_datos_filtro_Parte" width="100%" height="15%" scroll="false" disablevisible="MAP_TABPARTE&lt;&gt;2" />
      <prop group="1" frame="frm_datos_filtro_Parte" name="MAP_LBCLIENTESPEDIDOFILTRAR" visible="1" type="TL" class="label2" width="25%" title="Datos Filtro" tmargin="1" />
      <prop group="1" frame="frm_datos_filtro_Parte" name="MAP_FECHAPARTE_FILTRO" visible="1" type="D" size="40" width="35%" tooltip="Fecha" labelwidth="0" tmargin="2" lmargin="1" />
      <prop group="1" frame="frm_datos_filtro_Parte" name="MAP_LOCALIDAD_FILTRO" visible="1" type="T" newline="false" size="40" width="40%" tooltip="Localidad" labelwidth="0" tmargin="2" lmargin="1" />
      <prop group="1" frame="frm_datos_filtro_Parte" name="MAP_FILTRARPARTES" visible="1" type="B" class="botonmenu" newline="false" lmargin="1" tmargin="1" icon="bt-find-black.png" onchange="refresh" method="Executenode(filtrarpartescerrados)" title="" />
      <!-- ## Frame Contents de Clientes pedido ## -->
      <frame name="frm_listadoClienesPedido" height="55%" width="100%" disablevisible="MAP_TABPARTE&lt;&gt;2" />
      <prop group="1" frame="frm_listadoClienesPedido" name="MAP_LBCLIENTESCONTENTSPARTES1" visible="1" type="TL" class="label2" width="20%" title=" Fecha" tmargin="2" />
      <prop group="1" frame="frm_listadoClienesPedido" name="MAP_LBCLIENTESCONTENTSPARTES2" visible="1" type="TL" class="label2" width="40%" newline="false" title=" Localidades" tmargin="2" />
      <prop group="1" frame="frm_listadoClienesPedido" name="MAP_LBCLIENTESCONTENTSPARTES3" visible="1" type="TL" class="label2" width="12%" newline="false" title="  Efectivo" tmargin="2" />
      <prop group="1" frame="frm_listadoClienesPedido" name="MAP_LBCLIENTESCONTENTSPARTES4" visible="1" type="TL" class="label2" width="12%" newline="false" title="  Tarjeta" tmargin="2" />
      <prop group="1" frame="frm_listadoClienesPedido" name="MAP_LBCLIENTESCONTENTSPARTES5" visible="1" type="TL" class="label2" width="16%" newline="false" title="   Total" tmargin="2" />
      <prop group="1" frame="frm_listadoClienesPedido" name="Partes_Cerrados_Contents" labelwidth="0" width="100%" height="90%" type="Z" class="z_contents" visible="1" contents="Partes_Cerrados_Contents" />
      <contents name="Partes_Cerrados_Contents" src="Partes_Cerrados_Contents" filter="t1.CERRADO='S'" sort="t1.ID DESC" />
      <!-- ## Frame botones edicion pedido## -->
      <frame name="frm_barrabotones" width="100%" height="10%" scroll="false" bgcolor="#fefefe,#bbbcbe" align="center" framebox="true" border-width="3" />
      <prop group="1" frame="frm_barrabotones" name="MAP_BT1" visible="1" type="B" class="botonmenu" icon="bt_back_black.png" onchange="refresh" method="Executenode(exit)" title="" />
      <prop group="1" frame="frm_barrabotones" name="MAP_BT3" visible="1" type="B" class="botonmenu" newline="false" lmargin="2" icon="bt_save_black.png" onchange="refresh255" method="Executenode(salvarparte)" title="" disablevisible="MAP_TABPARTE&lt;&gt;1" />
      <prop group="1" frame="frm_barrabotones" name="MAP_BT2" visible="1" type="B" class="botonmenu" newline="false" lmargin="2" icon="bt-okbox-black.png" onchange="refresh255" method="Executenode(cerrarparte)" title="" disablevisible="MAP_TABPARTE&lt;&gt;1" />
      <prop group="1" frame="frm_barrabotones" name="MAP_BUTTONSELECT" visible="0" type="N" />
      <!-- ## Frame Bara Estado## -->
      <frame name="frm_barraestado" width="100%" height="6%" scroll="false" bgcolor="#05264e" align="right" orientation="bottom" />
      <prop group="1" frame="frm_barraestado" name="MAP_DATOSESTADO" visible="0" type="T" />
      <prop group="1" frame="frm_barraestado" name="MAP_LBESTADO" visible="1" type="TL" class="labelestado" title="##FLD_MAP_DATOSESTADO##" tmargin="2" />
      <prop name="MAP_IMPORTE" formula="ext.[IMPORTE]" type="N2" size="7" fieldsize="5" visible="0" />
      <ext-formula>
        <param name="IMPORTE" sql="select sum(IMPORTE) as N from gen_lineasparte t1 where t1.IDPARTE=##FLD_ID## and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" field="N" type="N2" />
      </ext-formula>
      <create>
        <action name="setval" field="FECHA" value="##NOW_TIME##" />
        <action name="setval" field="IDUSUARIO" value="##USERID##" />
        <action name="setval" field="IDEMPRESA" value="##ENTID##" />
        <action name="runscript">
          <script language="VBScript">   
				'Cargamos datos de barra de estado
				this("MAP_DATOSESTADO")=CargarBarraEstado()		
				this("CERRADO")="N"
				CargarIconosParte 1
				CargarGruposParte 1
				this.save
          </script>
        </action>
      </create>
      <before-edit>
        <action name="runscript">
          <script language="VBScript">   
				'Cargamos datos de barra de estado
				this("MAP_DATOSESTADO")=CargarBarraEstado()		
				CargarIconosParte 1
				CargarGruposParte 1
          </script>
        </action>
      </before-edit>
      <menuparte show-wait-dialog="false">
        <action name="runscript">
          <param name="nmenu" />
          <script language="VBScript">
                    'Cargamos pestaa virtual
      			
      				CargarIconosParte nmenu
      				CargarGruposParte nmenu
                  </script>
        </action>
      </menuparte>
      <onback show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript" />
        </action>
      </onback>
      <exit show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript"> 
          		    if LB_MsgYesNo ("Desea salir del parte?") then
	          			appdata.failwithmessage -11888,"##EXIT##"
	          	    end if
      		</script>
        </action>
      </exit>
      <salvarparte show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		    if LB_MsgYesNo ("Desea guardar el  parte actual sin cerrarlo?") then

          		        this.save
	          			appdata.failwithmessage -11888,"##EXIT##"
	          	    end if        
          	
      		</script>
        </action>
      </salvarparte>
      <cerrarparte show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		    if LB_MsgYesNo ("Desea cerrar el  parte?") then
          		        this("FECHA_CIERRE")=now
          		        this("CERRADO")="S"
          		       ' this("IMPORTE")=this("MAP_IMPORTE")
          		        this.save
          		        LB_RemarcarRegistro "gen_partes",this("ID")	
	          			appdata.failwithmessage -11888,"##EXIT##"

	          	    end if          		
      		</script>
        </action>
      </cerrarparte>
      <nuevalineaparte show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
       			'Vamos a crear una nueva linea de parte
 					NuevaLineaParte
				          			
      		</script>
        </action>
      </nuevalineaparte>
      <borrarlineaparte show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
                if this("MAP_IDLINEAPARTESEL")&gt;0 then
      			     BorrarLineaParte cstr(this("MAP_IDLINEAPARTESEL"))     	
      			end if
      		</script>
        </action>
      </borrarlineaparte>
      <filtrarpartescerrados show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript" />
        </action>
      </filtrarpartescerrados>
    </coll>
    <coll name="PedidosCab_Basic" title="PedidosCab_Basic" sql="SELECT t1.ID     FROM ##PREF##PedidosCab t1" objname="PedidosCab" updateobj="PedidosCab" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDUSUARIO" visible="0" type="N" size="8" />
      <prop group="1" name="IDCLIENTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDRAZONSOCIAL" visible="0" type="N" size="8" />
      <prop group="1" name="F_PEDIDO" visible="0" type="D" size="8" />
      <prop group="1" name="N_PEDIDO" visible="0" type="N" size="8" />
      <prop group="1" name="TYPE" visible="0" type="T" size="8" />
      <prop group="1" name="SU_REF_PED" visible="0" type="T" size="100" />
      <prop group="1" name="OBSERVACION" visible="0" type="T" size="400" />
      <prop group="1" name="TRAILES_SN" visible="0" type="N" size="1" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="PedidosCab_Contents" title="PedidosCab_Basic" sql="SELECT t1.*     FROM ##PREF##PedidosCab t1" objname="PedidosCab" updateobj="PedidosCab" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDUSUARIO" visible="0" type="N" size="8" />
      <prop group="1" name="IDCLIENTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDRAZONSOCIAL" visible="0" type="N" size="8" />
      <prop group="1" name="N_PEDIDO" visible="7" type="N" size="8" width="35%" title="N Pedido" labelwidth="6" />
      <prop group="1" name="F_PEDIDO" visible="7" type="D" size="8" width="35%" title="Fecha" labelwidth="6" newline="false" />
      <prop group="1" name="TYPE" visible="0" type="T" size="8" />
      <prop group="1" name="SU_REF_PED" visible="0" type="T" size="100" />
      <prop group="1" name="OBSERVACION" visible="0" type="T" size="400" />
      <prop group="1" name="TRAILES_SN" visible="0" type="N" size="1" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <selecteditem show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
       
		           if not this.ownercollection.ownerobject is nothing then
		               this.ownercollection.ownerobject("MAP_IDPEDIDOSEL")=this("ID")
		           end if
		   </script>
        </action>
      </selecteditem>
    </coll>
    <coll name="PedidosLin_Basic" title="PedidosLin_Basic" sql="SELECT t1.*    FROM ##PREF##PedidosLin t1" objname="PedidosLin" updateobj="PedidosLin" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDPEDIDO" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDARTICULO" visible="0" type="N" size="8" />
      <prop group="1" name="N_LIN" visible="0" type="D" size="8" />
      <prop group="1" name="N_PEDIDO" visible="0" type="N" size="8" />
      <prop group="1" name="TYPE" visible="0" type="T" size="8" />
      <prop group="1" name="DESCRIP" visible="0" type="T" size="4000" />
      <prop group="1" name="GAUNITIP_UNI1" visible="0" type="T" size="4" />
      <prop group="1" name="GAUNITIP_UNI2" visible="0" type="T" size="4" />
      <prop group="1" name="C_UNI1" visible="0" type="N4" size="4" />
      <prop group="1" name="C_UNI2" visible="0" type="N4" size="4" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <create>
        <action name="setval" field="IDEMPRESA" value="##ENTID##" />
      </create>
    </coll>
    <coll name="PedidosLin_Contents" title="PedidosLin_Basic" editmask="8" sql="SELECT t1.*,a.DESCRIP AS MAP_ARTICULO,a.GAUNITIP_UNI1 AS MAP_GAUNITIP_UNI1,a.GAUNITIP_UNI2 AS MAP_GAUNITIP_UNI2       FROM ##PREF##PedidosLin t1      inner join ##PREF##Articulos a ON a.ID=t1.IDARTICULO" objname="PedidosLin" updateobj="PedidosLin" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDPEDIDO" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDARTICULO" visible="0" type="N" size="8" />
      <prop group="1" name="N_LIN" visible="0" type="N" size="8" width="10%" labelwidth="0" />
      <prop group="1" name="MAP_ARTICULO" visible="7" type="T" size="4" width="70%" labelwidth="0" />
      <prop group="1" name="MAP_GAUNITIP_UNI2" visible="7" type="T" size="4" width="15%" labelwidth="0" newline="false" />
      <prop group="1" name="C_UNI2" visible="7" type="N2" size="4" width="15%" labelwidth="0" newline="false" />
      <prop group="1" name="MAP_GAUNITIP_UNI1" visible="0" type="T" size="4" width="10%" />
      <prop group="1" name="C_UNI1" visible="0" type="N2" size="4" width="10%" />
      <prop group="1" name="N_PEDIDO" visible="0" type="N" size="8" />
      <prop group="1" name="TYPE" visible="0" type="T" size="8" />
      <prop group="1" name="DESCRIP" visible="0" type="T" size="4000" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="PedidosLin_Historico_Contents" title="PedidosLin_Basic" sql="SELECT t1.*,a.DESCRIP AS MAP_ARTICULO,a.GAUNITIP_UNI1 AS MAP_GAUNITIP_UNI1,a.GAUNITIP_UNI2 AS MAP_GAUNITIP_UNI2   ,t2.N_PEDIDO AS MAP_NPEDIDO  ,t2.F_PEDIDO AS MAP_FPEDIDO    FROM ##PREF##PedidosLin t1   inner join ##PREF##Articulos a ON a.ID=t1.IDARTICULO   inner join ##PREF##PedidosCab t2 ON t2.ID=t1.IDPEDIDO" objname="PedidosLin" updateobj="PedidosLin" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDPEDIDO" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDARTICULO" visible="0" type="N" size="8" />
      <prop group="1" name="MAP_NPEDIDO" visible="7" type="N" size="4" width="50%" labelwidth="0" />
      <prop group="1" name="MAP_FPEDIDO" visible="7" type="N" size="4" width="50%" labelwidth="0" newline="false" />
      <prop group="1" name="N_LIN" visible="0" type="N" size="8" width="10%" labelwidth="0" />
      <prop group="1" name="MAP_ARTICULO" visible="7" type="T" size="4" width="70%" labelwidth="0" />
      <prop group="1" name="MAP_GAUNITIP_UNI2" visible="7" type="T" size="4" width="15%" labelwidth="0" newline="false" />
      <prop group="1" name="C_UNI2" visible="7" type="N2" size="4" width="15%" labelwidth="0" newline="false" />
      <prop group="1" name="MAP_GAUNITIP_UNI1" visible="0" type="T" size="4" width="10%" />
      <prop group="1" name="C_UNI1" visible="0" type="N2" size="4" width="10%" />
      <prop group="1" name="N_PEDIDO" visible="0" type="N" size="8" />
      <prop group="1" name="TYPE" visible="0" type="T" size="8" />
      <prop group="1" name="DESCRIP" visible="0" type="T" size="4000" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="PedidosLin_Pedido_Contents" title="PedidosLin_Basic" sql="SELECT t1.*,a.DESCRIP AS MAP_ARTICULO,a.GAUNITIP_UNI1 AS MAP_GAUNITIP_UNI1,a.GAUNITIP_UNI2 AS MAP_GAUNITIP_UNI2     FROM ##PREF##PedidosLin t1   inner join ##PREF##Articulos a ON a.ID=t1.IDARTICULO" objname="PedidosLin" updateobj="PedidosLin" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDPEDIDO" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDARTICULO" visible="0" type="N" size="8" />
      <prop group="1" name="N_LIN" visible="0" type="N" size="8" width="10%" labelwidth="0" />
      <prop group="1" name="MAP_ARTICULO" visible="7" type="T" size="4" width="70%" labelwidth="0" />
      <prop group="1" name="MAP_GAUNITIP_UNI2" visible="7" type="T" size="4" width="15%" labelwidth="0" newline="false" />
      <prop group="1" name="C_UNI2" visible="7" type="N2" size="4" width="15%" labelwidth="0" newline="false" />
      <prop group="1" name="MAP_GAUNITIP_UNI1" visible="0" type="T" size="4" width="10%" />
      <prop group="1" name="C_UNI1" visible="0" type="N2" size="4" width="10%" />
      <prop group="1" name="N_PEDIDO" visible="0" type="N" size="8" />
      <prop group="1" name="TYPE" visible="0" type="T" size="8" />
      <prop group="1" name="DESCRIP" visible="0" type="T" size="4000" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <create>
        <action name="setval" field="IDEMPRESA" value="##ENTID##" />
      </create>
      <selecteditem show-wait-dialog="false" refresh="false">
        <action name="runscript">
          <script language="VBScript">  
		           if not this.ownercollection.ownerobject is nothing then
					             this.ownercollection.ownerobject("MAP_IDPEDIDOLIN")=this("ID")
					             ui.RefreshContentSelectedRow "PedidosLin_Pedido_Contents"
		           end if  
		   </script>
        </action>
      </selecteditem>
    </coll>
    <coll name="Pedidos_Menu" title="el Pedido_Menu" sql="SELECT t1.* from ##PREF##PedidosCab t1" objname="PedidosCab" updateobj="PedidosCab" progid="ASData.CASBasicDataObj">
      <!-- ##### GRUPO  1. PEDIDOS ##### -->
      <group name="Pedidos" id="1" />
      <prop group="1" name="IDUSUARIO" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDRAZONSOCIAL" visible="0" type="N" size="8" />
      <prop group="1" name="F_PEDIDO" visible="0" type="D" size="8" />
      <prop group="1" name="N_PEDIDO" visible="0" type="N" size="8" />
      <prop group="1" name="TYPE" visible="0" type="T" size="8" />
      <prop group="1" name="SU_REF_PED" visible="0" type="T" size="100" />
      <prop group="1" name="OBSERVACION" visible="0" type="T" size="400" />
      <prop group="1" name="TRAILES_SN" visible="0" type="N" size="1" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <!-- ## Frame Cabecera ## -->
      <frame name="cabecera1" width="100%" height="7%" scroll="false" orientation="top" bgcolor="#094c9b,#05264e" />
      <prop group="1" frame="cabecera1" name="MAP_ICON1" visible="1" type="B" width="5%" labelwidth="0" icon="icon.png" method="Executenode(menu0)" locked="true" />
      <prop group="1" frame="cabecera1" name="MAP_CABECERA1" visible="1" type="TL" class="labelcab" title="##FLD_MAP_LBCABECERA1##" />
      <prop group="1" frame="cabecera1" name="MAP_LBCABECERA1" visible="0" type="T" />
      <!-- ## Frame Pestas Pedido## -->
      <frame name="frm_pestanas_Pedido" width="100%" height="7%" scroll="false" bgcolor="#ffda6b" framebox="true" border-width="3" align="center" />
      <prop group="1" frame="frm_pestanas_Pedido" name="MAP_TABPED" type="N" visible="0" />
      <prop group="1" frame="frm_pestanas_Pedido" name="MAP_BTGROUPPED1" visible="1" type="B" class="botongrupo" bgcolor="##FLD_MAP_BTIMGPED1##" caption="Cliente" onchange="refresh" method="Executenode(menupedido(1))" title="" />
      <prop group="1" frame="frm_pestanas_Pedido" name="MAP_BTGROUPPED2" visible="1" type="B" class="botongrupo" newline="false" lmargin="1" bgcolor="##FLD_MAP_BTIMGPED2##" caption="Pedido" onchange="refresh" method="Executenode(menupedido(2))" title="" />
      <prop group="1" frame="frm_pestanas_Pedido" name="MAP_BTGROUPPED3" visible="1" type="B" class="botongrupo" newline="false" lmargin="1" bgcolor="##FLD_MAP_BTIMGPED3##" caption="Catalogo" onchange="refresh" method="Executenode(menupedido(3))" title="" />
      <prop group="1" frame="frm_pestanas_Pedido" name="MAP_BTIMGPED1" visible="0" type="T" />
      <prop group="1" frame="frm_pestanas_Pedido" name="MAP_BTIMGPED2" visible="0" type="T" />
      <prop group="1" frame="frm_pestanas_Pedido" name="MAP_BTIMGPED3" visible="0" type="T" />
      <!-- ## Frame Filtro de clientes pedido## -->
      <frame name="frm_datos_filtro_cliente_Pedido" width="100%" height="17%" scroll="false" disablevisible="MAP_TABPED&lt;&gt;1" />
      <prop group="1" frame="frm_datos_filtro_cliente_Pedido" name="MAP_LBCLIENTESPEDIDOFILTRAR" visible="1" type="TL" class="label2" width="25%" title="Datos Filtro" tmargin="1" />
      <prop group="1" frame="frm_datos_filtro_cliente_Pedido" name="MAP_NOMBRECLIENTEPEDIDO" visible="1" type="T" size="40" width="35%" tooltip="Nombre" labelwidth="0" tmargin="2" lmargin="1" />
      <prop group="1" frame="frm_datos_filtro_cliente_Pedido" name="MAP_CODIGOCLIENTEPEDIDO" visible="1" type="T" newline="false" size="40" width="20%" tooltip="Codigo" labelwidth="0" tmargin="2" lmargin="1" />
      <prop group="1" frame="frm_datos_filtro_cliente_Pedido" name="MAP_POBLACIONCLIENTEPEDIDO" visible="1" type="T" newline="false" size="40" width="33%" tooltip="Poblacion" labelwidth="0" tmargin="2" lmargin="1" />
      <prop group="1" frame="frm_datos_filtro_cliente_Pedido" name="MAP_FILTRARCLIENTESPEDIDO" visible="1" type="B" class="botonmenu" newline="false" lmargin="1" tmargin="1" icon="bt-find-black.png" onchange="refresh" method="Executenode(filtrarclientespedido)" title="" />
      <!-- ## Frame Contents de Clientes pedido ## -->
      <frame name="frm_listadoClienesPedido" height="53%" width="100%" disablevisible="MAP_TABPED&lt;&gt;1" />
      <prop group="1" frame="frm_listadoClienesPedido" name="MAP_LBCLIENTESCONTENTSPEDIDO" visible="1" type="TL" class="label2" width="10%" title="Clientes" tmargin="2" />
      <prop group="1" frame="frm_listadoClienesPedido" name="MAP_EDITARCLIENTESPEDIDO" visible="1" type="B" class="botonmenu" newline="false" lmargin="1" tmargin="1" icon="bt-pedido-black.png" onchange="refresh" method="Executenode(editarclientespedido)" title="" />
      <prop group="1" frame="frm_listadoClienesPedido" name="IDCLIENTE" visible="0" type="N" size="8" />
      <prop group="1" frame="frm_listadoClienesPedido" name="MAP_NOMBRE_CLIENTE" visible="0" type="T" size="8" />
      <prop group="1" frame="frm_listadoClienesPedido" name="MAP_USUARIO" visible="0" type="T" size="8" />
      <prop group="1" frame="frm_listadoClienesPedido" name="Clientes_Contents_Pedido" labelwidth="0" width="100%" height="87%" type="Z" class="z_contents" visible="1" contents="Clientes_Contents_Pedido" />
      <contents name="Clientes_Contents_Pedido" src="Clientes_Contents_Pedido" filter="t1.ITX_BAJA=0 or t1.ITX_BAJA is null" sort="t1.ID" />
      <!-- ## Frame Articulos Pedido 1 ## -->
      <frame name="frm_Articulos_Pedido_1" height="70%" width="50%" disablevisible="MAP_TABPED&lt;&gt;2" framebox="true" />
      <prop group="1" frame="frm_Articulos_Pedido_1" name="MAP_LBNUECOARTICULOSPEDIDO1" visible="1" type="TL" class="label2" width="26%" title="Nueva Linea" tmargin="3" lmargin="1" />
      <prop group="1" frame="frm_Articulos_Pedido_1" name="MAP_BTNUEVALINEA" visible="1" type="B" class="botonmenu" icon="bt-mas-black.png" onchange="refresh255" newline="false" method="Executenode(nuevalinea2)" title="" tmargin="2" />
      <prop group="1" frame="frm_Articulos_Pedido_1" name="MAP_BTBORRARLINEA" visible="1" type="B" class="botonmenu" icon="bt-menos-black.png" onchange="refresh255" newline="false" method="Executenode(borrarlinea)" title="" tmargin="2" />
      <prop group="1" frame="frm_Articulos_Pedido_1" name="MAP_IDPEDIDOLIN" visible="0" type="N" />
      <prop group="1" frame="frm_Articulos_Pedido_1" name="MAP_LBARTICULOSPEDIDO1" visible="1" type="TL" class="label2" width="100%" title="Lineas" tmargin="3" lmargin="1" />
      <prop group="1" frame="frm_Articulos_Pedido_1" name="PedidosLin_Pedido_Contents" autofocus="true" labelwidth="0" width="100%" height="78%" type="Z" class="z_contents" visible="1" contents="PedidosLin_Pedido_Contents" />
      <contents name="PedidosLin_Pedido_Contents" src="PedidosLin_Pedido_Contents" filter="t1.IDPEDIDO=##FLD_ID## and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" />
      <!-- ## Frame Articulos Pedido 2 ## -->
      <frame name="frm_Articulos_Pedido_2" height="70%" width="50%" disablevisible="MAP_TABPED&lt;&gt;2" newline="false" framebox="true" />
      <prop group="1" frame="frm_Articulos_Pedido_2" name="MAP_BTNUEVAHISTORICO1" visible="1" type="B" class="botonmenu" icon="bt_flecha_2_black.png" onchange="refresh255" method="Executenode(anadirlineashistoricotodos)" title="" tmargin="2" />
      <prop group="1" frame="frm_Articulos_Pedido_2" name="MAP_BTNUEVAHISTORICO2" visible="1" type="B" class="botonmenu" icon="bt_flecha_1_black.png" onchange="refresh255" method="Executenode(anadirlineashistoricosel)" title="" newline="false" tmargin="2" />
      <prop group="1" frame="frm_Articulos_Pedido_2" name="MAP_IDFILTROESTADISTICA" visible="0" type="N" size="8" mapcol-values="Ultimo,Ultima Semana,Ultimo Mes" mapfld="ID" />
      <prop group="1" frame="frm_Articulos_Pedido_2" name="MAP_FILTROESTADISTICA" visible="1" type="T" newline="false" refresh="false" linkedto="MAP_IDFILTROESTADISTICA" linkedfield="DATA" size="40" width="37%" title="Filtro: " labelwidth="0" tmargin="3" />
      <prop group="1" frame="frm_Articulos_Pedido_2" name="MAP_FECHAFILTROESTADISTICA" visible="1" type="D" size="8" width="28%" title="Ini. Visita" refresh="false" newline="false" labelwidth="0" tmargin="4" />
      <prop group="1" frame="frm_Articulos_Pedido_2" name="MAP_FILTRARPEDIDOS" visible="1" type="B" class="botonmenu" newline="false" lmargin="1" tmargin="2" icon="bt-find-black.png" onchange="refresh" method="Executenode(filtrarpedidoshist)" title="" />
      <prop group="1" frame="frm_Articulos_Pedido_2" name="MAP_LBARTICULOSPEDIDO2" visible="1" type="TL" class="label2" width="100%" title="Historico Pedidos" tmargin="2" lmargin="1" />
      <prop group="1" frame="frm_Articulos_Pedido_2" name="Estadisticas_Contents" labelwidth="0" width="100%" height="75%" type="Z" xclass="z_contents" visible="1" contents="Estadisticas_Contents" />
      <contents name="Estadisticas_Contents" src="Estadisticas_Contents" filter="t1.IDCLIENTE=##FLD_IDCLIENTE##" />
      <!-- ## Frame Filtro de catalogo 3## -->
      <frame name="frm_datos_filtro_catalogo" width="100%" height="15%" scroll="false" disablevisible="MAP_TABPED&lt;&gt;3" />
      <prop group="1" frame="frm_datos_filtro_catalogo" name="MAP_LBCATALOGOPEDIDOFILTRAR" visible="1" type="TL" class="label2" width="25%" title="Datos Filtro Catalogo" tmargin="1" />
      <prop group="1" frame="frm_datos_filtro_catalogo" name="MAP_CODARTICULO" visible="1" type="T" size="40" width="10%" tooltip="Codigo" labelwidth="0" tmargin="2" lmargin="1" />
      <prop group="1" frame="frm_datos_filtro_catalogo" name="MAP_IDMARCA" visible="0" type="T" size="8" mapcol="Marcas" mapfld="MARCA" />
      <prop group="1" frame="frm_datos_filtro_catalogo" name="MAP_MARCA" visible="1" type="T" newline="false" linkedto="MAP_IDMARCA" linkedfield="MARCA" size="40" width="18%" tooltip="Marca: " title="Marca" labelwidth="0" tmargin="2" lmargin="1" />
      <prop group="1" frame="frm_datos_filtro_catalogo" name="MAP_IDGAMA" visible="0" type="T" size="8" mapcol="Gamas" mapfld="GAMA" filter="MARCA=##FLD_MAP_MARCA##" />
      <prop group="1" frame="frm_datos_filtro_catalogo" name="MAP_GAMA" visible="1" type="T" newline="false" linkedto="MAP_IDGAMA" linkedfield="GAMA" size="40" width="18%" tooltip="Gama: " title="Gama" labelwidth="0" tmargin="2" />
      <prop group="1" frame="frm_datos_filtro_catalogo" name="MAP_IDSUBGAMA" visible="0" type="T" size="8" mapcol="Subgamas" mapfld="SUBGAMA" filter="GAMA=##FLD_MAP_GAMA## and MARCA=##FLD_MAP_MARCA##" />
      <prop group="1" frame="frm_datos_filtro_catalogo" name="MAP_SUBGAMA" visible="1" type="T" newline="false" linkedto="MAP_IDSUBGAMA" linkedfield="SUBGAMA" size="40" width="18%" tooltip="Subgama: " title="Subgama" labelwidth="0" tmargin="2" />
      <prop group="1" frame="frm_datos_filtro_catalogo" name="MAP_IDFAMILIA" visible="0" type="T" size="8" mapcol="Familias" mapfld="FAMILIA" filter="SUBGAMA=##FLD_MAP_SUBGAMA## and MARCA=##FLD_MAP_MARCA## and GAMA=##FLD_MAP_GAMA##" />
      <prop group="1" frame="frm_datos_filtro_catalogo" name="MAP_FAMILIA" visible="1" type="T" newline="false" linkedto="MAP_IDFAMILIA" linkedfield="FAMILIA" size="40" width="18%" tooltip="Familia: " title="Familia" labelwidth="0" tmargin="2" />
      <prop group="1" frame="frm_datos_filtro_catalogo" name="MAP_BT_LIMPIAR_FILTROCATALOGO" visible="1" type="B" newline="false" class="boton2" icon="bt-x-black.png" onchange="refresh" method="Executenode(limpiarfiltrocatalogopedido)" title="" tmargin="2" lmargin="0" />
      <prop group="1" frame="frm_datos_filtro_catalogo" name="MAP_FILTRARCATALOGOPEDIDO" visible="1" type="B" class="botonmenu" newline="false" lmargin="1" tmargin="1" icon="bt-find-black.png" onchange="refresh" method="Executenode(filtrarcatalogopedido)" title="" />
      <prop group="1" frame="frm_datos_filtro_catalogo" name="MAP_IDARTICULOSEL" visible="0" type="N" />
      <!-- ## Frame catalogo 3## -->
      <frame name="frm_Catalogo" height="55%" width="100%" bgcolor="#FFFFFF" disablevisible="MAP_TABPED&lt;&gt;3" />
      <prop group="1" frame="frm_Catalogo" name="MAP_LBCATALOGOPEDIDO" visible="1" type="TL" class="label2" width="25%" title="Catalogo" tmargin="2" />
      <prop group="1" frame="frm_Catalogo" name="Catalogo_Contents_Pedido" autofocus="true" height="100%" width="100%" type="Z" class="z_contents_horizontal" visible="1" contents="Catalogo_Contents_Pedido" />
      <contents name="Catalogo_Contents_Pedido" src="Catalogo_Contents_Pedido" filter="" />
      <!-- ## Frame Edicion de catalogo 4## -->
      <frame name="frm_datos_edicion_catalogo" width="100%" height="70%" scroll="false" disablevisible="MAP_TABPED&lt;&gt;4" />
      <prop group="1" frame="frm_datos_edicion_catalogo" name="MAP_LBCATALOGOEDICION" visible="0" type="TL" class="label2" width="25%" title="Informacion Articulo" tmargin="1" />
      <prop group="1" frame="frm_datos_edicion_catalogo" name="MAP_UNIDADESSELEDIT" visible="1" type="N2" size="40" width="25%" title="Unds: " labelwidth="4" tmargin="3" />
      <prop group="1" frame="frm_datos_edicion_catalogo" name="MAP_ANADIRARTICULOEDIT" visible="1" type="B" class="botonmenu" newline="false" lmargin="1" tmargin="2" icon="bt-mas-black.png" method="Executenode(nuevalineacatalogo)" title="" />
      <prop group="1" frame="frm_datos_edicion_catalogo" name="MAP_ARTICULOSELEDIT" visible="1" type="T" size="40" text-bgcolor="#FFFFF" fontbold="true" width="100%" tmargin="2" title="" labelwidth="0" align="center" locked="true" />
      <prop group="1" frame="frm_datos_edicion_catalogo" name="MAP_FOTOG" cache-timeout="999999" type="IMG" align="center" locked="true" width="50%" bgcolor="" visible="7" labelwidth="0" />
      <prop group="1" frame="frm_datos_edicion_catalogo" name="MAP_DESCRIP_LARGA" type="T" newline="false" width="50%" class="html" fontsize="12" locked="true" visible="7" labelwidth="0" lines="18" fixed-lines="true" text-bgcolor="#FFFFFF" />
      <!-- ## Frame Filtro de articulos 5## -->
      <frame name="frm_datos_filtro_articulos" width="100%" height="24%" scroll="false" disablevisible="MAP_TABPED&lt;&gt;5" />
      <prop group="1" frame="frm_datos_filtro_articulos" name="MAP_LBARTICULOSPEDIDOFILTRAR" visible="1" type="TL" class="label2" width="25%" title="Datos Filtro Articulo" tmargin="1" />
      <prop group="1" frame="frm_datos_filtro_articulos" name="MAP_CODARTICULO2" visible="1" type="T" size="40" width="10%" tooltip="Codigo" labelwidth="0" tmargin="2" lmargin="1" />
      <prop group="1" frame="frm_datos_filtro_articulos" name="MAP_IDMARCA2" visible="0" type="T" size="8" mapcol="Marcas" mapfld="MARCA" />
      <prop group="1" frame="frm_datos_filtro_articulos" name="MAP_MARCA2" visible="1" type="T" newline="false" linkedto="MAP_IDMARCA2" linkedfield="MARCA" size="40" width="18%" tooltip="Marca: " title="Marca" labelwidth="0" tmargin="2" lmargin="1" />
      <prop group="1" frame="frm_datos_filtro_articulos" name="MAP_IDGAMA2" visible="0" type="T" size="8" mapcol="Gamas" mapfld="GAMA" filter="MARCA=##FLD_MAP_MARCA2##" />
      <prop group="1" frame="frm_datos_filtro_articulos" name="MAP_GAMA2" visible="1" type="T" newline="false" linkedto="MAP_IDGAMA2" linkedfield="GAMA" size="40" width="18%" tooltip="Gama: " title="Gama" labelwidth="0" tmargin="2" />
      <prop group="1" frame="frm_datos_filtro_articulos" name="MAP_IDSUBGAMA2" visible="0" type="T" size="8" mapcol="Subgamas" mapfld="SUBGAMA" filter="GAMA=##FLD_MAP_GAMA2## and MARCA=##FLD_MAP_MARCA2##" />
      <prop group="1" frame="frm_datos_filtro_articulos" name="MAP_SUBGAMA2" visible="1" type="T" newline="false" linkedto="MAP_IDSUBGAMA2" linkedfield="SUBGAMA" size="40" width="18%" tooltip="Subgama: " title="Subgama" labelwidth="0" tmargin="2" />
      <prop group="1" frame="frm_datos_filtro_articulos" name="MAP_IDFAMILIA2" visible="0" type="T" size="8" mapcol="Familias" mapfld="FAMILIA" filter="SUBGAMA=##FLD_MAP_SUBGAMA2## and GAMA=##FLD_MAP_GAMA2## and MARCA=##FLD_MAP_MARCA2##" />
      <prop group="1" frame="frm_datos_filtro_articulos" name="MAP_FAMILIA2" visible="1" type="T" newline="false" linkedto="MAP_IDFAMILIA2" linkedfield="FAMILIA" size="40" width="18%" tooltip="Familia: " title="Familia" labelwidth="0" tmargin="2" />
      <prop group="1" frame="frm_datos_filtro_articulos" name="MAP_BT_LIMPIAR_FILTROCARTICULOPEDIDO" visible="1" type="B" newline="false" class="boton2" icon="bt-x-black.png" onchange="refresh" method="Executenode(limpiarfiltroarticulospedido)" title="" tmargin="2" lmargin="0" />
      <prop group="1" frame="frm_datos_filtro_articulos" name="MAP_FILTRARARTICULOPEDIDO" visible="1" type="B" class="botonmenu" newline="false" lmargin="1" tmargin="1" icon="bt-find-black.png" onchange="refresh" method="Executenode(filtrararticulospedido)" title="" />
      <prop group="1" frame="frm_datos_filtro_articulos" name="MAP_IDARTICULOSEL2" visible="0" type="N" />
      <prop group="1" frame="frm_datos_filtro_articulos" name="MAP_ARTICULOSEL2" visible="1" type="T" size="40" width="60%" tooltip="Art. Seleccionado: " labelwidth="0" tmargin="3" locked="true" />
      <prop group="1" frame="frm_datos_filtro_articulos" name="MAP_UNIDADESSEL2" autofocus="true" visible="1" type="N2" size="40" width="15%" title="Unds: " labelwidth="4" tmargin="3" newline="false" />
      <prop group="1" frame="frm_datos_filtro_articulos" name="MAP_ANADIRARTICULOPEDIDO2" visible="1" type="B" class="botonmenu" newline="false" lmargin="1" tmargin="2" icon="bt-mas-black.png" onchange="refresh255" method="Executenode(nuevalinea)" title="" />
      <!-- ## Frame lista articulos 5## -->
      <frame name="frm_articulos" height="46%" width="100%" disablevisible="MAP_TABPED&lt;&gt;5" />
      <prop group="1" frame="frm_articulos" name="MAP_LBARTICULOSPEDIDO" visible="1" type="TL" class="label2" width="25%" title="Articulos" tmargin="2" />
      <prop group="1" frame="frm_articulos" name="Articulos_Contents_Pedido" setfocus="MAP_UNIDADESSEL2" height="100%" width="100%" type="Z" class="z_contents" visible="1" contents="Articulos_Contents_Pedido" />
      <contents name="Articulos_Contents_Pedido" src="Articulos_Contents_Pedido" filter="" />
      <!-- ## Frame botones edicion pedido## -->
      <frame name="frm_barrabotones" width="100%" height="10%" scroll="false" bgcolor="#fefefe,#bbbcbe" align="center" framebox="true" border-width="3" />
      <prop group="1" frame="frm_barrabotones" name="MAP_BT1" visible="1" type="B" class="botonmenu" icon="bt_back_black.png" onchange="refresh" method="Executenode(exit)" title="" disablevisible="MAP_TABPED=4 or MAP_TABPED=5" />
      <prop group="1" frame="frm_barrabotones" name="MAP_BT4" visible="1" type="B" class="botonmenu" newline="false" lmargin="2" icon="bt-x-black.png" method="Executenode(volver)" title="" disablevisible="MAP_TABPED&lt;&gt;4 and MAP_TABPED&lt;&gt;5" />
      <prop group="1" frame="frm_barrabotones" name="MAP_BT3" visible="1" type="B" class="botonmenu" newline="false" lmargin="2" icon="bt-muestras-black.png" onchange="refresh255" method="Executenode(muestra)" title="" disablevisible="MAP_TABPED&lt;&gt;2 or MAP_TABPED=4 or MAP_TABPED=5" />
      <prop group="1" frame="frm_barrabotones" name="MAP_BT2" visible="1" type="B" class="botonmenu" newline="false" lmargin="2" icon="bt-okbox-black.png" onchange="refresh255" method="Executenode(finalizar)" title="" disablevisible="MAP_TABPED=4 or MAP_TABPED=5" />
      <prop group="1" frame="frm_barrabotones" name="MAP_BUTTONSELECT" visible="0" type="N" />
      <!-- ## Frame Bara Estado## -->
      <frame name="frm_barraestado" width="100%" height="6%" scroll="false" bgcolor="#05264e" align="right" orientation="bottom" />
      <prop group="1" frame="frm_barraestado" name="MAP_DATOSESTADO" visible="0" type="T" />
      <prop group="1" frame="frm_barraestado" name="MAP_LBESTADO" visible="1" type="TL" class="labelestado" title="##FLD_MAP_DATOSESTADO##" tmargin="2" />
      <prop name="MAP_LINEAS" formula="ext.[LINEAS]" type="N2" size="7" fieldsize="5" visible="0" />
      <ext-formula>
        <param name="LINEAS" sql="select count(ID) as N from gen_PedidosLin t1 where t1.IDPEDIDO=##FLD_ID## and (t1.ITX_BAJA=0 or t1.ITX_BAJA is null)" field="N" type="N" />
      </ext-formula>
      <create>
        <action name="setval" field="F_PEDIDO" value="##NOW_TIME##" />
        <action name="setval" field="IDUSUARIO" value="##USERID##" />
        <action name="setval" field="IDEMPRESA" value="##ENTID##" />
        <action name="mapval" field="MAP_USUARIO" coll="Usuarios" mapfld="ID" mapvalue="##USERID##" targetfld="NOMBRE" />
        <action name="setval" field="TYPE" value="P" />
        <action name="runscript">
          <script language="VBScript">   
					CreatePedido
          </script>
        </action>
      </create>
      <menupedido show-wait-dialog="false">
        <action name="runscript">
          <param name="nmenu" />
          <script language="VBScript">
                    'Cargamos pestaa virtual
					 CambioPestanaPedido
                  </script>
        </action>
      </menupedido>
      <volver show-wait-dialog="false" refresh="false">
        <action name="runscript">
          <script language="VBScript">
          		 if this("MAP_TABPED")=5 then
          		   this("MAP_TABPED")=2
          		 else
          		   if this("MAP_TABPED")=4 then
          		      this("MAP_TABPED")=3
          		   end if
          		 end if
					 ui.refresh "frm_datos_edicion_catalogo"
					 ui.refresh "frm_barrabotones"  
					 ui.refresh "frm_Catalogo"
					 ui.refresh "frm_datos_filtro_catalogo"
      		</script>
        </action>
      </volver>
      <onback show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript" />
        </action>
      </onback>
      <exit show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
				CancelarPedido
      		</script>
        </action>
      </exit>
      <finalizar show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
					FinalizarPedido
      		</script>
        </action>
      </finalizar>
      <filtrarclientespedido show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		'Aplicamos filtro a menu de clientes
          		FiltrarContents "t1.COD like '%"+cstr(this("MAP_CODIGOCLIENTEPEDIDO"))+"%' and t1.NOMBRE like '%"+cstr(this("MAP_NOMBRECLIENTEPEDIDO"))+"%' and (select count(d.ID) from gen_direcciones d where d.IDRAZONSOCIAL=t1.IDRAZONSOCIAL AND d.POBLACION like '%"+cstr(this("MAP_POBLACIONCLIENTEPEDIDO"))+"%')&gt;0","Clientes_Contents_Pedido"
      		</script>
        </action>
      </filtrarclientespedido>
      <editarclientespedido show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		'editamos el cliente seleccionado
          		if this("IDCLIENTE")&gt;0 then
          		   LB_ShowForm "Clientes_Menu",this("IDCLIENTE")
          		else
          		    LB_Msg "Debe seleccionar un cliente"
          		end if
      		</script>
        </action>
      </editarclientespedido>
      <limpiarfiltrocatalogopedido show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		'Aplicamos filtro a menu de catalogo
          		this("MAP_CODARTICULO")=""
          		this("MAP_MARCA")=""
          		this("MAP_GAMA")=""
          		this("MAP_SUBGAMA")=""
          		this("MAP_FAMILIA")=""
          		this("MAP_IDMARCA")=""
          		this("MAP_IDGAMA")=""
          		this("MAP_IDSUBGAMA")=""
          		this("MAP_IDFAMILIA")=""          		
      		</script>
        </action>
      </limpiarfiltrocatalogopedido>
      <filtrarcatalogopedido show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		'Aplicamos filtro a menu de catalogo
          		FiltrarContentsLock "t1.COD like '%"+cstr(this("MAP_CODARTICULO"))+"%' and t1.MARCA like '%"+cstr(this("MAP_MARCA"))+"%' and t1.GAMA like '%"+cstr(this("MAP_GAMA"))+"%' and t1.FAMILIA like '%"+cstr(this("MAP_FAMILIA"))+"%'  and t1.SUBGAMA like '%"+cstr(this("MAP_SUBGAMA"))+"%'","Catalogo_Contents_Pedido"
      		</script>
        </action>
      </filtrarcatalogopedido>
      <limpiarfiltroarticulospedido show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		'Aplicamos filtro a menu de catalogo
          		this("MAP_CODARTICULO2")=""
          		this("MAP_MARCA2")=""
          		this("MAP_GAMA2")=""
          		this("MAP_SUBGAMA2")=""
          		this("MAP_FAMILIA2")=""
          		this("MAP_IDMARCA2")=""
          		this("MAP_IDGAMA2")=""
          		this("MAP_IDSUBGAMA2")=""
          		this("MAP_IDFAMILIA2")=""          		
          		
      		</script>
        </action>
      </limpiarfiltroarticulospedido>
      <lfiltrararticulospedido show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		'Aplicamos filtro a menu de catalogo
          		FiltrarContents "t1.COD like '%"+cstr(this("MAP_CODARTICULO2"))+"%' and t1.MARCA like '%"+cstr(this("MAP_MARCA2"))+"%' and t1.GAMA like '%"+cstr(this("MAP_GAMA2"))+"%' and t1.FAMILIA like '%"+cstr(this("MAP_FAMILIA2"))+"%'  and t1.SUBGAMA like '%"+cstr(this("MAP_SUBGAMA2"))+"%'","Articulos_Contents_Pedido"
      		</script>
        </action>
      </lfiltrararticulospedido>
      <filtrarpedidoshist show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		'Aplicamos filtro a menu de Estadisticas
				 FiltrarEstadisticas
      		</script>
        </action>
      </filtrarpedidoshist>
      <nuevalinea2 show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
          		   'Mostramos pestaa de seleccion de articulo
          		   this("MAP_TABPED")=5
      		</script>
        </action>
      </nuevalinea2>
      <borrarlinea show-wait-dialog="false">
        <action name="runscript">
          <param name="nmenu" />
          <script language="VBScript">
                    'eliminamos la linea seleccionada
					 EliminarLineaPedido this("MAP_IDPEDIDOLIN")
                  </script>
        </action>
      </borrarlinea>
      <nuevalinea show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
				NuevaLineaPedidoArticulo			
      		</script>
        </action>
      </nuevalinea>
      <nuevalineacatalogo show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
				NuevaLineaPedidoCatalogo
      		</script>
        </action>
      </nuevalineacatalogo>
      <nuevalineacatalogo2 show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript" />
        </action>
      </nuevalineacatalogo2>
      <anadirlineashistoricosel show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
					NuevaLineaPedidoEstadisticaSel					        		    
      		</script>
        </action>
      </anadirlineashistoricosel>
      <anadirlineashistoricotodos show-wait-dialog="false">
        <action name="runscript">
          <script language="VBScript">
					NuevaLineaPedidoEstadisticaTodos					        		    
      		</script>
        </action>
      </anadirlineashistoricotodos>
      <onchange>
        <field name="MAP_FECHAFILTROESTADISTICA">
          <action name="runscript">
            <script language="VBScript"> 
                 this("MAP_IDFILTROESTADISTICA")=0
                 this("MAP_FILTROESTADISTICA")=""
      		</script>
          </action>
        </field>
      </onchange>
    </coll>
    <coll name="Provincias_Basic" title="Provincias_Basic" sql="SELECT t1.ID     FROM ##PREF##Provincias t1" objname="Provincias" updateobj="Provincias" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDPAIS" visible="0" type="N" size="8" />
      <prop group="1" name="COD" visible="0" type="T" size="4" />
      <prop group="1" name="NOMBRE" visible="0" type="T" size="25" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="queue" title="queue" sql="SELECT t1.*               FROM master_Replica_queue t1" autorefresh="true" objname="master_Replica_queue" updateobj="master_Replica_queue" progid="ASData.CASBasicDataObj">
      <group name="GENERAL" id="1" />
      <prop group="1" name="TIMESTAMP" visible="7" labelwidth="0" fieldsize="8" type="D" />
      <prop group="1" name="SQL" visible="7" fieldsize="15" labelwidth="0" type="T" />
      <prop group="1" name="ROWID" visible="7" fieldsize="15" labelwidth="0" type="T" />
    </coll>
    <coll name="RazonSocial_Basic" title="RazonSocial" sql="SELECT t1.ID     FROM ##PREF##RazonSocial t1" objname="RazonSocial" updateobj="RazonSocial" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="COD" visible="7" type="T" size="15" width="20%" labelwidth="0" />
      <prop group="1" name="NOMBRE" visible="7" type="T" size="40" width="70%" labelwidth="0" newline="false" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="Subgamas" title="Subgamas" stringkey="true" idfieldname="SUBGAMA" sql="select distinct(t1.SUBGAMA) from gen_articulos t1 " objname="Articulos" updateobj="Articulos" progid="ASData.CASBasicDataObj" filter="t1.SUBGAMA is not null" sort="t1.SUBGAMA ASC">
      <group name="General" id="1" />
      <prop group="1" name="SUBGAMA" visible="7" type="T" size="30" width="100%" labelwidth="0" qualifier="t1.SUBGAMA" />
    </coll>
    <coll name="TipoContacto_Basic" title="TipoContacto_Basic" sql="SELECT t1.ID     FROM ##PREF##TipoContacto t1" objname="TipoContacto" updateobj="TipoContacto" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="COD" visible="0" type="T" size="5" />
      <prop group="1" name="NOMBRE" visible="0" type="T" size="30" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="TiposAlerta_Basic" title="TiposAlerta_Basic" sql=" SELECT t1.ID,t1.COD,t1.DESCRIP     FROM ##PREF##TiposAlerta t1 " objname="TiposAlerta" updateobj="TiposAlerta" progid="ASData.CASBasicDataObj" filter="" sort="" userawsql="true">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="COD" visible="7" type="T" size="5" width="20%" labelwidth="0" />
      <prop group="1" name="DESCRIP" visible="7" type="T" size="30" width="70%" labelwidth="0" newline="false" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="TiposClasificacion_Basic" title="TiposClasificacion_Basic" sql="SELECT t1.ID     FROM ##PREF##TiposClasificacion t1" objname="TiposClasificacion" updateobj="TiposClasificacion" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="COD" visible="0" type="T" size="4" />
      <prop group="1" name="DESCRIP" visible="0" type="T" size="40" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="TiposDoc_Basic" title="TiposDoc_Basic" sql="SELECT t1.ID     FROM ##PREF##TiposDoc t1" objname="TiposDoc" updateobj="TiposDoc" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="COD" visible="0" type="T" size="4" />
      <prop group="1" name="DESCRIP" visible="0" type="T" size="40" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="TiposMensajeAgenda_Basic" title="TiposMensajeAgenda_Basic" sql="SELECT t1.ID,t1.COD,t1.DESCRIP     FROM ##PREF##TiposMensajeAgenda t1 " objname="TiposMensajeAgenda" updateobj="TiposMensajeAgenda" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="COD" visible="7" type="T" size="5" width="20%" labelwidth="0" />
      <prop group="1" name="DESCRIP" visible="7" type="T" size="30" width="70%" labelwidth="0" newline="false" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="UnidadesEspeciales_Basic" title="UnidadesEspeciales_Basic" sql="SELECT t1.ID     FROM ##PREF##UnidadesEspeciales t1" objname="UnidadesEspeciales" updateobj="UnidadesEspeciales" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="GAUNITIP_UNI1" visible="0" type="T" size="4" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="Usuarios" title="el usuario" sql="SELECT t1.ID,t1.IDEMPRESA,t1.LOGIN,t1.PWD,t1.NOMBRE   FROM ##PREF##Usuarios t1" shadow="false" objname="Usuarios" updateobj="Usuarios" progid="ASGestion.CASUser" dropdown="true" editwidth="101" editheight="97" fontsize="9" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" mapcol="Empresas" mapfld="ID" />
      <prop group="1" name="LOGIN" visible="3" type="T" fieldsize="10" fixed-text="true" size="10" />
      <prop group="1" name="PWD" type="T" fieldsize="10" fixed-text="true" size="10" visible="0" />
      <prop group="1" name="NOMBRE" visible="3" type="T" fieldsize="30" fixed-text="true" size="30" />
      <prop group="1" name="USERTYPE" visible="1" type="T" fieldsize="30" fixed-text="true" size="50" />
      <prop group="1" name="COD" visible="0" type="T" size="8" />
      <prop group="1" name="ADMIN" visible="0" type="N" />
      <prop group="1" name="SERIE_PEDIDOS" visible="0" type="N" />
      <prop group="1" name="SERIE_PARTES" visible="0" type="N" />
      <prop group="1" name="TELEFONO" visible="0" type="T" size="12" />
      <prop group="1" name="IMEI" visible="0" type="T" size="40" />
      <prop group="1" name="MODELO" visible="0" type="T" size="40" />
      <prop group="1" name="QL_USERNAME" visible="0" type="T" size="8" />
      <prop group="1" name="QL_PASSWD" visible="0" type="T" size="8" />
      <prop group="1" name="QL_NOMFIC" visible="0" type="T" size="15" />
      <prop group="1" name="MAIL_USERNAME" visible="0" type="T" size="25" />
      <prop group="1" name="MAIL_PASSWD" visible="0" type="T" size="12" />
      <prop group="1" name="EMAIL_MUESTRAS" visible="0" type="T" size="25" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <create>
        <action name="setval" field="IDEMPRESA" value="##ENTID##" />
      </create>
    </coll>
    <coll name="UsuariosScript" title="el usuario" sql="SELECT t1.*,v.VERSION_BD AS MAP_VERSIONBD,'##DEVICE_OSSDKCODE##' AS MAP_OS,'##DEVICE_OS##' AS MAP_PLATFORM,'##DEVICEID##' AS MAP_IMEI,'##VERSION##' AS MAP_VERSIONAPP,'##FRAME_VERSION##' AS MAP_VERSIONFRAMEWORK,##MID## AS MAP_MID       FROM ##PREF##Usuarios t1       INNER JOIN ##PREF##versiones v ON v.MID=0" shadow="false" objname="Usuarios" updateobj="Usuarios" progid="ASGestion.CASUser" dropdown="true" editwidth="101" editheight="97" fontsize="9" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" mapcol="Empresas" mapfld="ID" />
      <prop group="1" name="LOGIN" visible="3" type="T" fieldsize="10" fixed-text="true" size="10" />
      <prop group="1" name="PWD" type="T" fieldsize="10" fixed-text="true" size="10" visible="0" />
      <prop group="1" name="NOMBRE" visible="3" type="T" fieldsize="30" fixed-text="true" size="30" />
      <prop group="1" name="USERTYPE" visible="1" type="T" fieldsize="30" fixed-text="true" size="50" />
      <prop group="1" name="ROWID" visible="0" type="T" />
      <prop group="1" name="MAP_IMEI" visible="0" type="T" />
      <prop group="1" name="MAP_VERSIONAPP" visible="0" type="T" />
      <prop group="1" name="MAP_PLATFORM" visible="0" type="T" />
      <prop group="1" name="MAP_VERSIONFRAMEWORK" visible="0" type="T" />
      <prop group="1" name="MAP_MID" visible="0" type="T" />
      <prop group="1" name="MAP_VERSIONBD" visible="0" type="T" />
      <prop group="1" name="SERIE_PEDIDOS" visible="0" type="N" />
      <prop group="1" name="SERIE_PARTES" visible="0" type="N" />
      <prop group="1" name="COD" visible="0" type="T" size="8" />
      <prop group="1" name="ADMIN" visible="0" type="N" />
      <prop group="1" name="TELEFONO" visible="0" type="T" size="12" />
      <prop group="1" name="IMEI" visible="0" type="T" size="40" />
      <prop group="1" name="MODELO" visible="0" type="T" size="40" />
      <prop group="1" name="MAP_OS" visible="0" type="T" size="40" />
      <prop group="1" name="QL_USERNAME" visible="0" type="T" size="8" />
      <prop group="1" name="QL_PASSWD" visible="0" type="T" size="8" />
      <prop group="1" name="QL_NOMFIC" visible="0" type="T" size="15" />
      <prop group="1" name="MAIL_USERNAME" visible="0" type="T" size="25" />
      <prop group="1" name="MAIL_PASSWD" visible="0" type="T" size="12" />
      <prop group="1" name="EMAIL_MUESTRAS" visible="0" type="T" size="25" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="Versiones" title="Versiones" sql="SELECT *,'##FRAME_VERSION##' AS MAP_VERSIONFRAME,'##VERSION##' AS MAP_VERSIONAPP,         '##DEVICEID##' AS MAP_IMEI,##MID## AS MAP_MID               FROM ##PREF##versiones t1" autorefresh="true" objname="Versiones" updateobj="Versiones" progid="ASData.CASBasicDataObj">
      <group name="GENERAL" id="1" />
      <prop group="1" name="MID" visible="7" fieldsize="3" type="N" />
      <prop group="1" name="VERSION_BD" visible="1" fieldsize="25" type="T" />
      <prop group="1" name="VERSION_APP" visible="1" fieldsize="25" type="T" />
      <prop group="1" name="IMEI" visible="1" fieldsize="25" type="T" />
      <prop group="1" name="VERSION_FRAMEWORK" visible="1" fieldsize="25" type="T" />
      <prop group="1" name="FECHA_LOGIN" visible="1" fieldsize="25" type="D" />
      <prop group="1" name="USER" visible="1" fieldsize="80" type="T" />
      <prop group="1" name="TEXT1" visible="1" fieldsize="25" type="T" />
      <prop group="1" name="TEXT2" visible="1" fieldsize="25" type="T" />
      <prop group="1" name="FECHA1" visible="1" fieldsize="25" type="D" />
      <prop group="1" name="FECHA2" visible="1" fieldsize="25" type="D" />
      <prop group="1" name="MAP_VERSIONAPP" type="T" visible="0" labelwidth="6" fieldsize="7" title="Aplicacion" newline="false" />
      <prop group="1" name="MAP_VERSIONFRAME" type="T" visible="0" labelwidth="8" fieldsize="11" title="FrameXOne" newline="false" />
      <prop group="1" name="MAP_MID" type="T" visible="0" labelwidth="6" fieldsize="7" newline="false" title="MID" />
      <prop group="1" name="MAP_IMEI" type="T" visible="0" labelwidth="6" fieldsize="7" newline="false" title="MID" />
    </coll>
    <coll name="Alertas_Notify" title="Alertas_Basic" sql="SELECT t1.ID   FROM ##PREF##Alertas t1" objname="Alertas" xnotify="true" xnotify_coll="MenuPrincipal" xnotify_mode="1" xnotify_mask="0" xnotify_counter="true" xnotify_always="true" xnotify_title="Alerta Recibida" updateobj="Alertas" progid="ASData.CASBasicDataObj" filter="" sort="t1.IDUSUARIO=##USERID##">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDUSUARIO" visible="0" type="N" size="8" />
      <prop group="1" name="IDCLIENTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDTIPOALERTA" visible="0" type="N" size="8" />
      <prop group="1" name="FECHA_CIERRE" visible="0" type="D" size="8" />
      <prop group="1" name="TYPE" visible="0" type="N" size="8" />
      <prop group="1" name="F_DESDE" visible="7" type="D" size="8" width="50%" labelwidth="6" title="Fecha Desde:" />
      <prop group="1" name="F_HASTA" visible="7" type="D" size="8" width="50%" labelwidth="6" newline="false" title="Fecha Hasta:" />
      <prop group="1" name="CERRADA_SN" visible="7" type="NC" size="8" width="10%" labelwidth="6" title="Cerrada" />
      <prop group="1" name="COMENTARIO" visible="7" type="T" size="400" width="90%" title="Comentacion" labelwidth="0" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
    </coll>
    <coll name="Estadisticas_Contents3" fontsize="10" title="Estadisticas_Basic" sql="SELECT t1.*,a.DESCRIP AS MAP_ARTICULO,a.GAUNITIP_UNI1 AS MAP_GAUNITIP_UNI1,a.GAUNITIP_UNI2 AS MAP_GAUNITIP_UNI2     FROM ##PREF##Estadisticas t1 inner join ##PREF##Articulos a ON a.ID=t1.IDARTICULO" objname="Estadisticas" updateobj="Estadisticas" progid="ASData.CASBasicDataObj" filter="" sort="">
      <group name="General" id="1" />
      <prop group="1" name="ID" type="N" visible="0" />
      <prop group="1" name="IDEMPRESA" visible="0" type="N" size="8" />
      <prop group="1" name="IDARTICULO" visible="0" type="N" size="8" />
      <prop group="1" name="IDCLIENTE" visible="0" type="N" size="8" />
      <prop group="1" name="IDRAZONSOCIAL" visible="0" type="N" size="8" />
      <prop group="1" name="F_ALBARAN" visible="0" type="D" size="8" />
      <prop group="1" name="GAUNITIP_UNI1" visible="0" type="T" size="4" />
      <prop group="1" name="GAUNITIP_UNI2" visible="0" type="T" size="4" />
      <prop group="1" name="C_UNI1" visible="0" type="N2" size="4" />
      <prop group="1" name="I_NETOEMP" visible="0" type="N2" size="5" />
      <prop group="1" name="I_LINEMP" visible="0" type="N2" size="30" />
      <prop group="1" name="PR_PRECIO" visible="0" type="N2" size="8" />
      <prop group="1" name="N_ALBARAN" visible="7" type="T" size="5" width="10%" labelwidth="0" fontsize="10" />
      <prop group="1" name="GGALBTIP_COD" visible="7" type="T" size="5" width="5%" labelwidth="0" fontsize="10" newline="false" />
      <prop group="1" name="N_LIN" visible="7" type="T" size="30" width="5%" labelwidth="0" newline="false" fontsize="10" />
      <prop group="1" name="MAP_ARTICULO" visible="7" type="T" size="4" width="60%" labelwidth="0" newline="false" fontsize="10" />
      <prop group="1" name="MAP_GAUNITIP_UNI2" visible="7" type="T" size="4" width="10%" labelwidth="0" newline="false" fontsize="10" />
      <prop group="1" name="C_UNI2" visible="7" type="N2" size="4" width="10%" labelwidth="0" newline="false" fontsize="10" />
      <prop group="1" name="ITX_ERP" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_XONE" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FERPACT" visible="0" type="D" size="8" />
      <prop group="1" name="ITX_BAJA" visible="0" type="N" size="8" />
      <prop group="1" name="ITX_FXONEACT" visible="0" type="D" size="8" />
      <selecteditem show-wait-dialog="false" refresh="false">
        <action name="runscript">
          <script language="VBScript">
		           if this("MAP_SEL")=0 then
		             this("MAP_SEL")=1
		           else
		              this("MAP_SEL")=0
		           end if
		        'Refresca el grid modificado.
		        ui.RefreshContentSelectedRow "Estadisticas_Contents"
		        
		        'refreshcontentrow "nombreprop", nID    'refresca la fila especifica del content que le digas
		   </script>
        </action>
      </selecteditem>
    </coll>
  </collprops>
</xml>